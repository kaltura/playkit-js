!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("core",[],t):"object"==typeof exports?exports.core=t():(e.playkit=e.playkit||{},e.playkit.core=t())}(window,(function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=9)}([function(e,t,n){var i;!function(r,a){"use strict";var o="model",s="name",c="type",u="vendor",l="version",d="mobile",h="tablet",_="smarttv",A=function(e){for(var t={},n=0;n<e.length;n++)t[e[n].toUpperCase()]=e[n];return t},f=function(e,t){return"string"==typeof e&&-1!==g(t).indexOf(g(e))},g=function(e){return e.toLowerCase()},p=function(e,t){if("string"==typeof e)return e=e.replace(/^\s\s*/,"").replace(/\s\s*$/,""),void 0===t?e:e.substring(0,255)},v=function(e,t){for(var n,i,r,a,o,s,c=0;c<t.length&&!o;){var u=t[c],l=t[c+1];for(n=i=0;n<u.length&&!o;)if(o=u[n++].exec(e))for(r=0;r<l.length;r++)s=o[++i],"object"==typeof(a=l[r])&&a.length>0?2===a.length?"function"==typeof a[1]?this[a[0]]=a[1].call(this,s):this[a[0]]=a[1]:3===a.length?"function"!=typeof a[1]||a[1].exec&&a[1].test?this[a[0]]=s?s.replace(a[1],a[2]):void 0:this[a[0]]=s?a[1].call(this,s,a[2]):void 0:4===a.length&&(this[a[0]]=s?a[3].call(this,s.replace(a[1],a[2])):void 0):this[a]=s||void 0;c+=2}},E=function(e,t){for(var n in t)if("object"==typeof t[n]&&t[n].length>0){for(var i=0;i<t[n].length;i++)if(f(t[n][i],e))return"?"===n?void 0:n}else if(f(t[n],e))return"?"===n?void 0:n;return e},m={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},T={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[l,[s,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[l,[s,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[s,l],[/opios[\/ ]+([\w\.]+)/i],[l,[s,"Opera Mini"]],[/\bopr\/([\w\.]+)/i],[l,[s,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[s,l],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[l,[s,"UCBrowser"]],[/\bqbcore\/([\w\.]+)/i],[l,[s,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[l,[s,"WeChat"]],[/konqueror\/([\w\.]+)/i],[l,[s,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[l,[s,"IE"]],[/yabrowser\/([\w\.]+)/i],[l,[s,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[s,/(.+)/,"$1 Secure Browser"],l],[/\bfocus\/([\w\.]+)/i],[l,[s,"Firefox Focus"]],[/\bopt\/([\w\.]+)/i],[l,[s,"Opera Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[l,[s,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[l,[s,"Dolphin"]],[/coast\/([\w\.]+)/i],[l,[s,"Opera Coast"]],[/miuibrowser\/([\w\.]+)/i],[l,[s,"MIUI Browser"]],[/fxios\/([-\w\.]+)/i],[l,[s,"Firefox"]],[/\bqihu|(qi?ho?o?|360)browser/i],[[s,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[s,/(.+)/,"$1 Browser"],l],[/(comodo_dragon)\/([\w\.]+)/i],[[s,/_/g," "],l],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[s,l],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[s],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[s,"Facebook"],l],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[s,l],[/\bgsa\/([\w\.]+) .*safari\//i],[l,[s,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[l,[s,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[s,"Chrome WebView"],l],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[l,[s,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[s,l],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[l,[s,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[l,s],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[s,[l,E,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[s,l],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[s,"Netscape"],l],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[l,[s,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[s,l]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",g]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[["architecture","arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[["architecture","armhf"]],[/windows (ce|mobile); ppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[["architecture",/ower/,"",g]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[["architecture",g]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[o,[u,"Samsung"],[c,h]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[o,[u,"Samsung"],[c,d]],[/\((ip(?:hone|od)[\w ]*);/i],[o,[u,"Apple"],[c,d]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[o,[u,"Apple"],[c,h]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[o,[u,"Huawei"],[c,h]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[o,[u,"Huawei"],[c,d]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[o,/_/g," "],[u,"Xiaomi"],[c,d]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[o,/_/g," "],[u,"Xiaomi"],[c,h]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[o,[u,"OPPO"],[c,d]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[o,[u,"Vivo"],[c,d]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[o,[u,"Realme"],[c,d]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[o,[u,"Motorola"],[c,d]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[o,[u,"Motorola"],[c,h]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[o,[u,"LG"],[c,h]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[o,[u,"LG"],[c,d]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[o,[u,"Lenovo"],[c,h]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[o,/_/g," "],[u,"Nokia"],[c,d]],[/(pixel c)\b/i],[o,[u,"Google"],[c,h]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[o,[u,"Google"],[c,d]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[o,[u,"Sony"],[c,d]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[o,"Xperia Tablet"],[u,"Sony"],[c,h]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[o,[u,"OnePlus"],[c,d]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[o,[u,"Amazon"],[c,h]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[o,/(.+)/g,"Fire Phone $1"],[u,"Amazon"],[c,d]],[/(playbook);[-\w\),; ]+(rim)/i],[o,u,[c,h]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[o,[u,"BlackBerry"],[c,d]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[o,[u,"ASUS"],[c,h]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[o,[u,"ASUS"],[c,d]],[/(nexus 9)/i],[o,[u,"HTC"],[c,h]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[u,[o,/_/g," "],[c,d]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[o,[u,"Acer"],[c,h]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[o,[u,"Meizu"],[c,d]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[o,[u,"Sharp"],[c,d]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[u,o,[c,d]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[u,o,[c,h]],[/(surface duo)/i],[o,[u,"Microsoft"],[c,h]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[o,[u,"Fairphone"],[c,d]],[/(u304aa)/i],[o,[u,"AT&T"],[c,d]],[/\bsie-(\w*)/i],[o,[u,"Siemens"],[c,d]],[/\b(rct\w+) b/i],[o,[u,"RCA"],[c,h]],[/\b(venue[\d ]{2,7}) b/i],[o,[u,"Dell"],[c,h]],[/\b(q(?:mv|ta)\w+) b/i],[o,[u,"Verizon"],[c,h]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[o,[u,"Barnes & Noble"],[c,h]],[/\b(tm\d{3}\w+) b/i],[o,[u,"NuVision"],[c,h]],[/\b(k88) b/i],[o,[u,"ZTE"],[c,h]],[/\b(nx\d{3}j) b/i],[o,[u,"ZTE"],[c,d]],[/\b(gen\d{3}) b.+49h/i],[o,[u,"Swiss"],[c,d]],[/\b(zur\d{3}) b/i],[o,[u,"Swiss"],[c,h]],[/\b((zeki)?tb.*\b) b/i],[o,[u,"Zeki"],[c,h]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[u,"Dragon Touch"],o,[c,h]],[/\b(ns-?\w{0,9}) b/i],[o,[u,"Insignia"],[c,h]],[/\b((nxa|next)-?\w{0,9}) b/i],[o,[u,"NextBook"],[c,h]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[u,"Voice"],o,[c,d]],[/\b(lvtel\-)?(v1[12]) b/i],[[u,"LvTel"],o,[c,d]],[/\b(ph-1) /i],[o,[u,"Essential"],[c,d]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[o,[u,"Envizen"],[c,h]],[/\b(trio[-\w\. ]+) b/i],[o,[u,"MachSpeed"],[c,h]],[/\btu_(1491) b/i],[o,[u,"Rotor"],[c,h]],[/(shield[\w ]+) b/i],[o,[u,"Nvidia"],[c,h]],[/(sprint) (\w+)/i],[u,o,[c,d]],[/(kin\.[onetw]{3})/i],[[o,/\./g," "],[u,"Microsoft"],[c,d]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[o,[u,"Zebra"],[c,h]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[o,[u,"Zebra"],[c,d]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[u,o,[c,"console"]],[/droid.+; (shield) bui/i],[o,[u,"Nvidia"],[c,"console"]],[/(playstation [345portablevi]+)/i],[o,[u,"Sony"],[c,"console"]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[o,[u,"Microsoft"],[c,"console"]],[/smart-tv.+(samsung)/i],[u,[c,_]],[/hbbtv.+maple;(\d+)/i],[[o,/^/,"SmartTV"],[u,"Samsung"],[c,_]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[u,"LG"],[c,_]],[/(apple) ?tv/i],[u,[o,"Apple TV"],[c,_]],[/crkey/i],[[o,"Chromecast"],[u,"Google"],[c,_]],[/droid.+aft(\w)( bui|\))/i],[o,[u,"Amazon"],[c,_]],[/\(dtv[\);].+(aquos)/i],[o,[u,"Sharp"],[c,_]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[u,p],[o,p],[c,_]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[c,_]],[/((pebble))app/i],[u,o,[c,"wearable"]],[/droid.+; (glass) \d/i],[o,[u,"Google"],[c,"wearable"]],[/droid.+; (wt63?0{2,3})\)/i],[o,[u,"Zebra"],[c,"wearable"]],[/(quest( 2)?)/i],[o,[u,"Facebook"],[c,"wearable"]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[u,[c,"embedded"]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[o,[c,d]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[o,[c,h]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[c,h]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[c,d]],[/(android[-\w\. ]{0,9});.+buil/i],[o,[u,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[l,[s,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[l,[s,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[s,l],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[l,s]],os:[[/microsoft (windows) (vista|xp)/i],[s,l],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[s,[l,E,m]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[s,"Windows"],[l,E,m]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[l,/_/g,"."],[s,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[s,"Mac OS"],[l,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[l,s],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[s,l],[/\(bb(10);/i],[l,[s,"BlackBerry"]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[l,[s,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[l,[s,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[l,[s,"webOS"]],[/crkey\/([\d\.]+)/i],[l,[s,"Chromecast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[s,"Chromium OS"],l],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[s,l],[/(sunos) ?([\w\.\d]*)/i],[[s,"Solaris"],l],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[s,l]]},y=function(e,t){if("object"==typeof e&&(t=e,e=void 0),!(this instanceof y))return new y(e,t).getResult();var n=e||(void 0!==r&&r.navigator&&r.navigator.userAgent?r.navigator.userAgent:""),i=t?function(e,t){var n={};for(var i in e)t[i]&&t[i].length%2==0?n[i]=t[i].concat(e[i]):n[i]=e[i];return n}(T,t):T;return this.getBrowser=function(){var e,t={};return t[s]=void 0,t[l]=void 0,v.call(t,n,i.browser),t.major="string"==typeof(e=t.version)?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0,t},this.getCPU=function(){var e={architecture:void 0};return v.call(e,n,i.cpu),e},this.getDevice=function(){var e={vendor:void 0,model:void 0,type:void 0};return v.call(e,n,i.device),e},this.getEngine=function(){var e={name:void 0,version:void 0};return v.call(e,n,i.engine),e},this.getOS=function(){var e={name:void 0,version:void 0};return v.call(e,n,i.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n="string"==typeof e&&e.length>255?p(e,255):e,this},this.setUA(n),this};y.VERSION="1.0.2",y.BROWSER=A([s,l,"major"]),y.CPU=A(["architecture"]),y.DEVICE=A([o,u,c,"console",d,_,h,"wearable","embedded"]),y.ENGINE=y.OS=A([s,l]),void 0!==t?(void 0!==e&&e.exports&&(t=e.exports=y),t.UAParser=y):n(4)?void 0===(i=function(){return y}.call(t,n,t,e))||(e.exports=i):void 0!==r&&(r.UAParser=y);var b=void 0!==r&&(r.jQuery||r.Zepto);if(b&&!b.ua){var S=new y;b.ua=S.getResult(),b.ua.get=function(){return S.getUA()},b.ua.set=function(e){S.setUA(e);var t=S.getResult();for(var n in t)b.ua[n]=t[n]}}}("object"==typeof window?window:this)},function(e,t,n){var i,r;
/*!
 * js-logger - http://github.com/jonnyreeves/js-logger
 * Jonny Reeves, http://jonnyreeves.co.uk/
 * js-logger may be freely distributed under the MIT license.
 */!function(a){"use strict";var o,s={};s.VERSION="1.6.0";var c={},u=function(e,t){return function(){return t.apply(e,arguments)}},l=function(){var e,t,n=arguments,i=n[0];for(t=1;t<n.length;t++)for(e in n[t])!(e in i)&&n[t].hasOwnProperty(e)&&(i[e]=n[t][e]);return i},d=function(e,t){return{value:e,name:t}};s.TRACE=d(1,"TRACE"),s.DEBUG=d(2,"DEBUG"),s.INFO=d(3,"INFO"),s.TIME=d(4,"TIME"),s.WARN=d(5,"WARN"),s.ERROR=d(8,"ERROR"),s.OFF=d(99,"OFF");var h=function(e){this.context=e,this.setLevel(e.filterLevel),this.log=this.info};h.prototype={setLevel:function(e){e&&"value"in e&&(this.context.filterLevel=e)},getLevel:function(){return this.context.filterLevel},enabledFor:function(e){var t=this.context.filterLevel;return e.value>=t.value},trace:function(){this.invoke(s.TRACE,arguments)},debug:function(){this.invoke(s.DEBUG,arguments)},info:function(){this.invoke(s.INFO,arguments)},warn:function(){this.invoke(s.WARN,arguments)},error:function(){this.invoke(s.ERROR,arguments)},time:function(e){"string"==typeof e&&e.length>0&&this.invoke(s.TIME,[e,"start"])},timeEnd:function(e){"string"==typeof e&&e.length>0&&this.invoke(s.TIME,[e,"end"])},invoke:function(e,t){o&&this.enabledFor(e)&&o(t,l({level:e},this.context))}};var _,A=new h({filterLevel:s.OFF});(_=s).enabledFor=u(A,A.enabledFor),_.trace=u(A,A.trace),_.debug=u(A,A.debug),_.time=u(A,A.time),_.timeEnd=u(A,A.timeEnd),_.info=u(A,A.info),_.warn=u(A,A.warn),_.error=u(A,A.error),_.log=_.info,s.setHandler=function(e){o=e},s.setLevel=function(e){for(var t in A.setLevel(e),c)c.hasOwnProperty(t)&&c[t].setLevel(e)},s.getLevel=function(){return A.getLevel()},s.get=function(e){return c[e]||(c[e]=new h(l({name:e},A.context)))},s.createDefaultHandler=function(e){(e=e||{}).formatter=e.formatter||function(e,t){t.name&&e.unshift("["+t.name+"]")};var t={},n=function(e,t){Function.prototype.apply.call(e,console,t)};return"undefined"==typeof console?function(){}:function(i,r){i=Array.prototype.slice.call(i);var a,o=console.log;r.level===s.TIME?(a=(r.name?"["+r.name+"] ":"")+i[0],"start"===i[1]?console.time?console.time(a):t[a]=(new Date).getTime():console.timeEnd?console.timeEnd(a):n(o,[a+": "+((new Date).getTime()-t[a])+"ms"])):(r.level===s.WARN&&console.warn?o=console.warn:r.level===s.ERROR&&console.error?o=console.error:r.level===s.INFO&&console.info?o=console.info:r.level===s.DEBUG&&console.debug?o=console.debug:r.level===s.TRACE&&console.trace&&(o=console.trace),e.formatter(i,r),n(o,i))}},s.useDefaults=function(e){s.setLevel(e&&e.defaultLevel||s.DEBUG),s.setHandler(s.createDefaultHandler(e))},void 0===(r="function"==typeof(i=s)?i.call(t,n,t,e):i)||(e.exports=r)}()},function(e){e.exports=JSON.parse('{"heartbeatTimeout":30000,"isStartOverType":false}')},function(e){e.exports=JSON.parse('{"a":"data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAC721kYXQhEAUgpBv/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA3pwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcCEQBSCkG//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADengAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAsJtb292AAAAbG12aGQAAAAAAAAAAAAAAAAAAAPoAAAALwABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAB7HRyYWsAAABcdGtoZAAAAAMAAAAAAAAAAAAAAAIAAAAAAAAALwAAAAAAAAAAAAAAAQEAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAAC8AAAAAAAEAAAAAAWRtZGlhAAAAIG1kaGQAAAAAAAAAAAAAAAAAAKxEAAAIAFXEAAAAAAAtaGRscgAAAAAAAAAAc291bgAAAAAAAAAAAAAAAFNvdW5kSGFuZGxlcgAAAAEPbWluZgAAABBzbWhkAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAADTc3RibAAAAGdzdHNkAAAAAAAAAAEAAABXbXA0YQAAAAAAAAABAAAAAAAAAAAAAgAQAAAAAKxEAAAAAAAzZXNkcwAAAAADgICAIgACAASAgIAUQBUAAAAAAfQAAAHz+QWAgIACEhAGgICAAQIAAAAYc3R0cwAAAAAAAAABAAAAAgAABAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAIAAAABAAAAHHN0c3oAAAAAAAAAAAAAAAIAAAFzAAABdAAAABRzdGNvAAAAAAAAAAEAAAAsAAAAYnVkdGEAAABabWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAtaWxzdAAAACWpdG9vAAAAHWRhdGEAAAABAAAAAExhdmY1Ni40MC4xMDE="}')},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t,n){var i=n(6),r=n(7);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var a={insert:"head",singleton:!1};i(r,a);e.exports=r.locals||{}},function(e,t,n){"use strict";var i,r=function(){return void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i},a=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),o=[];function s(e){for(var t=-1,n=0;n<o.length;n++)if(o[n].identifier===e){t=n;break}return t}function c(e,t){for(var n={},i=[],r=0;r<e.length;r++){var a=e[r],c=t.base?a[0]+t.base:a[0],u=n[c]||0,l="".concat(c," ").concat(u);n[c]=u+1;var d=s(l),h={css:a[1],media:a[2],sourceMap:a[3]};-1!==d?(o[d].references++,o[d].updater(h)):o.push({identifier:l,updater:g(h,t),references:1}),i.push(l)}return i}function u(e){var t=document.createElement("style"),i=e.attributes||{};if(void 0===i.nonce){var r=n.nc;r&&(i.nonce=r)}if(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),"function"==typeof e.insert)e.insert(t);else{var o=a(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var l,d=(l=[],function(e,t){return l[e]=t,l.filter(Boolean).join("\n")});function h(e,t,n,i){var r=n?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(e.styleSheet)e.styleSheet.cssText=d(t,r);else{var a=document.createTextNode(r),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(a,o[t]):e.appendChild(a)}}function _(e,t,n){var i=n.css,r=n.media,a=n.sourceMap;if(r?e.setAttribute("media",r):e.removeAttribute("media"),a&&btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}var A=null,f=0;function g(e,t){var n,i,r;if(t.singleton){var a=f++;n=A||(A=u(t)),i=h.bind(null,n,a,!1),r=h.bind(null,n,a,!0)}else n=u(t),i=_.bind(null,n,t),r=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else r()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=r());var n=c(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var i=0;i<n.length;i++){var r=s(n[i]);o[r].references--}for(var a=c(e,t),u=0;u<n.length;u++){var l=s(n[u]);0===o[l].references&&(o[l].updater(),o.splice(l,1))}n=a}}}},function(e,t,n){(t=n(8)(!1)).push([e.i,".playkit-container {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  color: #fff;\n  outline: none;\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n}\n\n.playkit-engine {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  object-fit: contain;\n}\n\n.playkit-engine video::-webkit-media-controls-panel,\n.playkit-engine video::-webkit-media-controls-panel-container,\n.playkit-engine video::-webkit-media-controls-start-playback-button,\n.playkit-engine video::-webkit-media-controls-play-button {\n  display: none;\n  -webkit-appearance: none;\n}\n\n.playkit-poster {\n  position: absolute;\n  display: block;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background-size: contain;\n  background-position: center center;\n  background-repeat: no-repeat;\n  background-color: #000;\n  pointer-events: none;\n}\n\n.playkit-subtitles {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  left: 0;\n  pointer-events: none;\n  margin-bottom: 5px;\n}\n\n.playkit-black-cover {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  background-color: black;\n  pointer-events: none;\n}\n\n.playkit-size-iframe {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  border: 0;\n  z-index: -100;\n}\n\n.playkit-in-browser-fullscreen-mode {\n  width: 100% !important;\n  height: 100% !important;\n  position: fixed !important;\n  top: 0 !important;\n  left: 0 !important;\n  /*added for blocking element with fixed position which could be on the top of the player */\n  z-index: 999999 !important;\n}\n",""]),e.exports=t},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",i=e[3];if(!i)return n;if(t&&"function"==typeof btoa){var r=(o=i,s=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(c," */")),a=i.sources.map((function(e){return"/*# sourceURL=".concat(i.sourceRoot||"").concat(e," */")}));return[n].concat(a).concat([r]).join("\n")}var o,s,c;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,i){"string"==typeof e&&(e=[[null,e,""]]);var r={};if(i)for(var a=0;a<this.length;a++){var o=this[a][0];null!=o&&(r[o]=!0)}for(var s=0;s<e.length;s++){var c=[].concat(e[s]);i&&r[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),t.push(c))}},t}},function(e,t,n){"use strict";n.r(t),n.d(t,"loadPlayer",(function(){return Jn})),n.d(t,"registerMediaSourceAdapter",(function(){return Ht})),n.d(t,"BaseMediaSourceAdapter",(function(){return Tt})),n.d(t,"BaseMiddleware",(function(){return ct})),n.d(t,"Track",(function(){return oe})),n.d(t,"VideoTrack",(function(){return ce})),n.d(t,"AudioTrack",(function(){return ue})),n.d(t,"TextTrack",(function(){return tt})),n.d(t,"ImageTrack",(function(){return gt})),n.d(t,"TextStyle",(function(){return Ee})),n.d(t,"Cue",(function(){return je})),n.d(t,"TimedMetadata",(function(){return Vt})),n.d(t,"createTextTrackCue",(function(){return Gt})),n.d(t,"createTimedMetadata",(function(){return jt})),n.d(t,"Utils",(function(){return i})),n.d(t,"utils",(function(){return i})),n.d(t,"Error",(function(){return M})),n.d(t,"FakeEvent",(function(){return E})),n.d(t,"FakeEventTarget",(function(){return R})),n.d(t,"EventManager",(function(){return x})),n.d(t,"VERSION",(function(){return Zn})),n.d(t,"NAME",(function(){return $n})),n.d(t,"Env",(function(){return f})),n.d(t,"State",(function(){return te})),n.d(t,"getCapabilities",(function(){return ei})),n.d(t,"setCapabilities",(function(){return ti})),n.d(t,"EngineDecoratorProvider",(function(){return qn})),n.d(t,"registerEngine",(function(){return an})),n.d(t,"unRegisterEngine",(function(){return on})),n.d(t,"AdBreakType",(function(){return fn})),n.d(t,"AdTagType",(function(){return gn})),n.d(t,"AdEventType",(function(){return X})),n.d(t,"filterTracksByRestriction",(function(){return St})),n.d(t,"Html5EventType",(function(){return q})),n.d(t,"CustomEventType",(function(){return Q})),n.d(t,"EventType",(function(){return Z})),n.d(t,"StateType",(function(){return ne})),n.d(t,"TrackType",(function(){return nt})),n.d(t,"EngineType",(function(){return rt})),n.d(t,"MediaType",(function(){return at})),n.d(t,"StreamType",(function(){return it})),n.d(t,"AbrMode",(function(){return ot})),n.d(t,"LogLevelType",(function(){return y})),n.d(t,"CorsType",(function(){return st})),n.d(t,"DrmScheme",(function(){return kt})),n.d(t,"MimeType",(function(){return Qn})),n.d(t,"RequestType",(function(){return At})),n.d(t,"ScreenOrientationType",(function(){return dt})),n.d(t,"AutoPlayType",(function(){return In})),n.d(t,"ThumbnailInfo",(function(){return vt})),n.d(t,"getLogger",(function(){return C})),n.d(t,"LogLevel",(function(){return T})),n.d(t,"getLogLevel",(function(){return k})),n.d(t,"setLogLevel",(function(){return w})),n.d(t,"setLogHandler",(function(){return b}));var i={};n.r(i),n.d(i,"Number",(function(){return B})),n.d(i,"String",(function(){return H})),n.d(i,"Object",(function(){return V})),n.d(i,"Generator",(function(){return G})),n.d(i,"Dom",(function(){return j})),n.d(i,"Http",(function(){return Y})),n.d(i,"VERSION",(function(){return W})),n.d(i,"ResizeWatcher",(function(){return pn})),n.d(i,"MultiMap",(function(){return v})),n.d(i,"binarySearch",(function(){return En}));var r=n(0),a=n.n(r),o=/^.*(web0s).*(smarttv).*$/i,s=/^.*(smart-tv).*(tizen).*$/i,c=/^.*(vidaa).*(smarttv).*$/i,u=[[s],[[a.a.BROWSER.NAME,"SAMSUNG_TV_BROWSER"],[a.a.BROWSER.MAJOR,""],[a.a.BROWSER.VERSION,""]]],l=[[o],[a.a.OS.NAME],[c],[a.a.OS.NAME]],d=[[o],[[a.a.DEVICE.VENDOR,"LG"],[a.a.DEVICE.TYPE,a.a.DEVICE.SMARTTV]],[s],[[a.a.DEVICE.VENDOR,"SAMSUNG"],[a.a.DEVICE.TYPE,a.a.DEVICE.SMARTTV]],[c],[[a.a.DEVICE.VENDOR,"HISENSE"],[a.a.DEVICE.TYPE,a.a.DEVICE.SMARTTV]],[/^.*(smart-tv|smarttv).*$/i],[[a.a.DEVICE.TYPE,a.a.DEVICE.SMARTTV]]],h=[[/(edg)\/((\d+)?[\w.]+)/i],[[a.a.BROWSER.NAME,"Edge"],a.a.BROWSER.VERSION,a.a.BROWSER.MAJOR]],_=[].concat(h,u),A=new a.a(void 0,{browser:_,device:d,os:l}).getResult();A.isConsole=A.device.type===a.a.DEVICE.CONSOLE,A.isSmartTV=A.device.type===a.a.DEVICE.SMARTTV,A.isMobile=A.device.type===a.a.DEVICE.MOBILE,A.isTablet=A.device.type===a.a.DEVICE.TABLET,A.isWearable=A.device.type===a.a.DEVICE.WEARABLE,A.isEmbedded=A.device.type===a.a.DEVICE.EMBEDDED,A.isIPadOS="Mac OS"===A.os.name&&"ontouchend"in document,A.isSafari=A.browser.name.includes("Safari"),A.isIOS="iOS"===A.os.name,A.isMacOS="Mac OS"===A.os.name;var f=A;function g(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var v=function(){function e(){this._map=new Map}var t=e.prototype;return t.push=function(e,t){if(this._map.has(e)){var n=this._map.get(e);Array.isArray(n)&&(n.push(t),this._map.set(e,n))}else this._map.set(e,[t])},t.set=function(e,t){this._map.set(e,t)},t.has=function(e){return this._map.has(e)},t.get=function(e){var t=this._map.get(e);return t?t.slice():[]},t.getAll=function(){for(var e,t=[],n=g(this._map.values());!(e=n()).done;){var i=e.value;t=t.concat(i)}return t},t.remove=function(e,t){if(this._map.has(e)){var n=this._map.get(e);if(Array.isArray(n)){for(var i=0;i<n.length;++i)n[i]==t&&(n.splice(i,1),--i);0===n.length&&this._map.delete(e)}}},t.keys=function(){return this._map.keys()},t.clear=function(){this._map.clear()},e}(),E=function(){function e(e,t){this.bubbles=!1,this.cancelable=!1,this.defaultPrevented=!1,this.timeStamp=window.performance?window.performance.now():Date.now(),this.type=e,this.isTrusted=!1,this.currentTarget=null,this.target=null,this.stopped=!1,this.payload=t}var t=e.prototype;return t.preventDefault=function(){},t.stopImmediatePropagation=function(){this.stopped=!0},t.stopPropagation=function(){},e}(),m=n(1),T={DEBUG:m.DEBUG,INFO:m.INFO,TIME:m.TIME,WARN:m.WARN,ERROR:m.ERROR,OFF:m.OFF},y={};function b(e){m.setHandler((function(t,n){return e(t,n)}))}function S(e){return e?m.get(e):m}function k(e){return S(e).getLevel()}function w(e,t){S(t).setLevel(e)}Object.keys(T).forEach((function(e){y[e]=e})),m.useDefaults({defaultLevel:m.ERROR});var C=S,R=function(){function e(){this._listeners=new v,this.dispatchTarget=this,this.__logger=C("FakeEventTarget")}var t=e.prototype;return t.addEventListener=function(e,t){this._listeners.push(e,t)},t.removeEventListener=function(e,t){this._listeners.remove(e,t)},t.dispatchEvent=function(e){for(var t=this._listeners.get(e.type)||[],n=0;n<t.length;++n){e.target=this.dispatchTarget,e.currentTarget=this.dispatchTarget;var i=t[n];try{i.handleEvent?i.handleEvent(e):i.call(this,e)}catch(t){this.__logger.error("Error occurred when handling event: "+e.type+".",t)}if(e.stopped)break}return e.defaultPrevented},e}();function D(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var O=function(){function e(){this._bindingMap=new v}var t=e.prototype;return t.destroy=function(){return this.removeAll(),this._bindingMap=null,Promise.resolve()},t.listenOnce=function(e,t,n,i){var r=this;this.listen(e,t,(function i(a){r.unlisten(e,t,i),n.call(r,a)}),i)},t.listen=function(e,t,n,i){var r=new N(e,t,n,i);this._bindingMap&&this._bindingMap.push(t,r)},t.unlisten=function(e,t,n){if(this._bindingMap)for(var i=this._bindingMap.get(t),r=0;r<i.length;++r){var a=i[r];a.target!==e||a.listener!==n&&n||(a.unlisten(),this._bindingMap&&this._bindingMap.remove(t,a))}},t.removeAll=function(){if(this._bindingMap){for(var e,t=D(this._bindingMap.getAll());!(e=t()).done;){e.value.unlisten()}this._bindingMap&&this._bindingMap.clear()}},e}(),N=function(){function e(e,t,n,i){this.target=e,this.type=t,this.listener=n,this.options=i,this.target.addEventListener(t,n,!1)}return e.prototype.unlisten=function(){this.target&&(this.target.removeEventListener(this.type,this.listener,this.options),this.target=null,this.listener=null,this.options=null)},e}(),x=O,P={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,UNKNOWN_DATA_URI_ENCODING:1005,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,LIVE_MANIFEST_REFRESH_ERROR:1008,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_CREATE_TEXT_CUE:2009,DASH_ADAPTER_ERROR_PARSE_ISSUE:2010,UNKNOWN_FILE_TYPE:2011,UNKNOWN_LANGUAGE:2012,INVALID_VTT_THUMBNAILS_FILE:2013,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,HLS_FATAL_MEDIA_ERROR:3018,HLS_FRAG_PARSING_ERROR:3019,HLS_BUFFER_APPEND_ISSUE:3020,HLS_BUFFER_APPENDING_ISSUE:3021,NATIVE_ADAPTER_LOAD_FAILED:3022,HLS_BUFFER_STALLED_ERROR:3023,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,RESTRICTIONS_CANNOT_BE_MET:4012,NO_PERIODS:4014,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_COULD_NOT_GUESS_MIME_TYPE:4021,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_LIVE_CONTENT_NOT_SUPPORTED:4029,HLSJS_CANNOT_PARSE:4030,INVALID_STREAMS_CHOSEN:5005,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,BAD_FAIRPLAY_RESPONSE:6015,COULD_NOT_CREATE_MEDIA_KEYS:6016,COULD_NOT_CREATE_KEY_SESSION:6017,LOAD_INTERRUPTED:7e3,BITRATE_SWITCH_ISSUE:7001,LOAD_FAILED:7002,RUNTIME_ERROR_NOT_REGISTERED_PLUGIN:7003,RUNTIME_ERROR_METHOD_NOT_IMPLEMENTED:7004,RUNTIME_ERROR_NOT_VALID_HANDLER:7005,NO_SOURCE_PROVIDED:7006,NO_ENGINE_FOUND_TO_PLAY_THE_SOURCE:7007,ENTER_PICTURE_IN_PICTURE_FAILED:7008,EXIT_PICTURE_IN_PICTURE_FAILED:7009,PLUGIN_LOAD_FAILED:7010,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,STORE_ALREADY_IN_PROGRESS:9006,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,CONTENT_UNSUPPORTED_BY_BROWSER:9009,CANNOT_ADD_ITEM:9010,DOWNLOAD_FAILED:9011,COULD_NOT_GET_INFO_FROM_MEDIA_PROVIDER:9012,ENTRY_DOES_NOT_EXIST:9013,PAUSE_FAILED:9014,RESUME_FAILED:9015,RENEW_LICENSE_FAILED:9016,ENTRY_ALREADY_EXISTS:9017,REMOVE_FAILED:9018,CAST_LOAD_MEDIA_FAILED:10001,CAST_CUSTOM_MESSAGE_PARSING_ERROR:10002,CAST_EDIT_TRACKS_INFO_ERROR:10003,VR_NOT_SUPPORTED:11e3};Object.assign(P,{XML_PARSING_ERROR:8100,VAST_SCHEMA_VALIDATION_ERROR:8101,VAST_RESPONSE_VERSION_NOT_SUPPORTED:8102,TRAFFICKING_ERROR:8200,VAST_UNEXPECTED_LINEARITY:8201,VAST_UNEXPECTED_DURATION_ERROR:8202,VAST_UNEXPECTED_SIZE_ERROR:8203,VAST_WRAPPER_ERROR:8300,VAST_URI_ERROR:8301,VAST_TOO_MANY_REDIRECTS:8302,NO_ADS_VAST_RESPONSE:8303,GENERAL_LINEAR_ERROR:8400,FILE_NOT_FOUND:8401,VAST_MEDIA_LOAD_TIMEOUT:8402,MEDIA_FILE_NOT_FOUND:8403,MEDIA_FILE_DISPLAY_ERROR:8405,MEZZANINE_FILE_NOT_PROVIDED:8406,MEZZANINE_DOWNLOADED_FOR_THE_FIRST_TIME:8407,VAST_RESPONSE_AD_REJECTED:8408,CREATIVE_WAS_NOT_EXECUTED:8409,CODE_REFERENCED_NOT_EXECUTED:8410,GENERAL_NON_LINEAR_AD_ERROR:8500,NON_LINEAR_CREATIVE_DIMENSIONS_NOT_ALIGN_ERROR:8501,NON_LINEAR_FETCH_ERROR:8502,NON_LINEAR_RESOURCE_NOT_FOUND:8503,GENERAL_COMPANION_ADS_ERROR:8600,COMPANION_DIMENSIONS_NOT_FIT:8601,COMPANION_CANNOT_BE_DISPLAY:8602,COMPANION_CANNOT_BE_FETCHED:8603,COMPANION_TYPE_NOT_FOUND:8604,AD_UNDEFINED_ERROR:8900,GENERAL_VPAID_ERROR:8901});function L(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var M=function e(t,n,i,r){void 0===r&&(r={}),this.severity=t,this.category=n,this.code=i,this.data=r,k("Error")!==T.OFF&&e._logger.error("Category:"+n+" | Code:"+i+" |",r)};L(M,"Severity",{RECOVERABLE:1,CRITICAL:2}),L(M,"Category",{NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,ADS:8,STORAGE:9,CAST:10,VR:11}),L(M,"Code",P),L(M,"_logger",C("Error"));function U(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return F(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var B={isNumber:function(e){return Number(e)===e},isInt:function(e){return this.isNumber(e)&&e%1==0},isFloat:function(e){return this.isNumber(e)&&e%1!=0}},H={capitlize:function(e){return"string"!=typeof e?e:e.charAt(0).toUpperCase()+e.slice(1)},endsWith:function(e,t){return"string"==typeof e&&"string"==typeof t&&-1!=e.indexOf(t,e.length-t.length)}},V={merge:function(e){for(var t,n={},i=U(e);!(t=i()).done;){var r=t.value;Object.assign(n,r)}return n},isObject:function(e){return e&&"object"==typeof e&&!Array.isArray(e)},isClassInstance:function(e){return e&&e.constructor&&e.constructor.name&&"Object"!==e.constructor.name},mergeDeep:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(!n.length)return e;var r=n.shift();if(this.isObject(e)&&this.isObject(r))for(var a in r){var o,s;if(this.isObject(r[a])&&!this.isClassInstance(r[a]))e[a]||Object.assign(e,((o={})[a]={},o)),this.mergeDeep(e[a],r[a]);else Object.assign(e,((s={})[a]=r[a],s))}return this.mergeDeep.apply(this,[e].concat(n))},copyDeep:function(e){var t,n=this;return Array.isArray(e)?(t=e.length>0?e.slice(0):[]).forEach((function(e,i){("object"==typeof e&&e!=={}||Array.isArray(e)&&e.length>0)&&(t[i]=n.copyDeep(e))})):null!==e&&"object"==typeof e?e.clone&&"function"==typeof e.clone?t=e.clone():(t=Object.assign({__proto__:e.__proto__},e),Object.keys(t).forEach((function(e){("object"==typeof t[e]&&t[e]!=={}||Array.isArray(t[e])&&t[e].length>0)&&(t[e]=n.copyDeep(t[e]))}))):t=e,t},isEmptyObject:function(e){for(var t in e)if(window.Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},getPropertyPath:function(e,t){return t.split(".").reduce((function(e,t){return null==e?e:e[t]}),e)},hasPropertyPath:function(e,t){if(!t)return!1;for(var n=t.split("."),i=0;i<n.length;i++){var r=n[i];if(!e||!window.Object.prototype.hasOwnProperty.call(e,r))return!1;e=e[r]}return!0},createPropertyPath:function(e,t,n){void 0===n&&(n=null);for(var i=t.split("."),r=e;i.length>1;){var a=i,o=a[0];i=a.slice(1),void 0===r[o]&&(r[o]={}),r=r[o]}return r[i[0]]=n,e},deletePropertyPath:function(e,t){if(e&&t){for(var n=t.split("."),i=0;i<n.length-1;i++)if(void 0===(e=e[n[i]]))return;delete e[n.pop()]}},defer:function(){var e,t,n=new Promise((function(n,i){e=n,t=i}));return n.resolve=e,n.reject=t,n},bind:function(e,t){return function(){t.apply(e,arguments)}}},G={uniqueId:function(e){var t=2+(!e||e<0?0:e-2);return"_"+Math.random().toString(36).substr(2,t)},guid:function(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},j={addClassName:function(e,t){e&&(e.classList?e.classList.add(t):j.hasClassName(e,t)||(e.className+=t))},removeClassName:function(e,t){e&&(e.classList?e.classList.remove(t):j.hasClassName(e,t)&&(e.className=e.className.replace(new RegExp("(\\s|^)"+t+"(\\s|$)")," ").replace(/^\s+|\s+$/g,"")))},hasClassName:function(e,t){return e&&e.className&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(e.className)},setAttribute:function(e,t,n){e.setAttribute(t,n)},removeAttribute:function(e,t){e.removeAttribute(t)},setStyle:function(e,t,n){void 0!==e.style.getPropertyValue(t)&&e.style.setProperty(t,n)},appendChild:function(e,t){e&&t&&e.appendChild&&e.appendChild(t)},removeChild:function(e,t){e&&t&&e.removeChild&&e.removeChild(t)},prependTo:function(e,t){t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)},getElementById:function(e){return document.getElementById(e)},getElementsByTagName:function(e){return document.getElementsByTagName(e)},createElement:function(e){return document.createElement(e)},loadStyleSheetAsync:function(e){var t=this;return new Promise((function(n,i){var r=!1,a=t.createElement("link");a.type="text/css",a.rel="stylesheet",a.href=e,a.async=!0,a.onload=a.onreadystatechange=function(){r||this.readyState&&"complete"!==this.readyState||(r=!0,n(this))},a.onerror=a.onabort=i,j.appendChild(document.head,a)}))},loadScriptAsync:function(e){var t=this;return new Promise((function(n,i){var r=!1,a=document.getElementsByTagName("script")[0],o=t.createElement("script");o.type="text/javascript",o.src=e,o.async=!0,o.onload=o.onreadystatechange=function(){r||this.readyState&&"complete"!==this.readyState||(r=!0,n(this))},o.onerror=o.onabort=i,a&&a.parentNode&&a.parentNode.insertBefore(o,a)}))},getElementBySelector:function(e){try{return document.querySelector(e)}catch(e){return}},insertBefore:function(e,t,n){try{return e.insertBefore(t,n)}catch(e){return null}}},Y={protocol:/^(https?:)/i.test(document.location.protocol)?document.location.protocol:"https:",execute:function(e,t,n,i,r,a){void 0===n&&(n="POST");var o=new XMLHttpRequest;return new Promise((function(s,c){o.onreadystatechange=function(){if(4===o.readyState)if(200===o.status)try{var e=JSON.parse(o.responseText);s(e)}catch(e){s(o.responseText)}else c(o.responseText)},o.open(n,e),i&&i.forEach((function(e,t){o.setRequestHeader(t,e)})),r&&(o.timeout=r),a&&(o.ontimeout=function(e){a(),c(e)}),o.send(t)}))},jsonp:function(e,t,n){var i,r=(n=n||{}).timeout?n.timeout:5e3,a=document.createElement("script"),o="jsonpcallback"+Math.round(Date.now()+1000001*Math.random()),s=e,c=function(){a&&a.parentNode&&a.parentNode.removeChild(a),window[o]=function(){},i&&clearTimeout(i)};return new Promise((function(n,u){r&&(i=setTimeout((function(){c(),u(new M(M.Severity.CRITICAL,M.Category.NETWORK,M.Code.TIMEOUT,e))}),r)),window[o]=function(i){var r=t(i,e);c(),n(r)},s.match(/\?/)?s+="&responseFormat=jsonp&callback="+o:s+="?responseFormat=jsonp&callback="+o,a.type="text/javascript",a.src=s,document.getElementsByTagName("head")[0].appendChild(a)}))},convertHeadersToDictionary:function(e){var t={};try{e.trim().split(/[\r\n]+/).forEach((function(e){var n=e.split(": "),i=n.shift().toLowerCase(),r=n.join(": ");t[i]=r}))}catch(e){}return t}},W={compare:function(e,t,n){void 0===n&&(n={});var i=(n=V.merge([{lexicographical:!1,zeroExtend:!0},n])).lexicographical,r=n.zeroExtend,a=(e||"0").split("."),o=(t||"0").split("."),s=function(e){return(i?/^\d+[A-Za-zαß]*$/:/^\d+[A-Za-zαß]?$/).test(e)},c=function(e){return e.map((function(e){var t=/[A-Za-zαß]/.exec(e);return Number(t?e.replace(t[0],"."+e.charCodeAt(t.index)):e)}))};if(!a.every(s)||!o.every(s))return NaN;if(r){for(;a.length<o.length;)a.push("0");for(;o.length<a.length;)o.push("0")}i||(a=c(a),o=c(o));for(var u=0;u<a.length;++u){if(o.length===u)return 1;if(a[u]!==o[u])return a[u]>o[u]?1:-1}return a.length!==o.length?-1:0}};function K(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var z=function(){function e(){this._createEl()}var t,n,i,r=e.prototype;return r.setSrc=function(e){e&&(this._posterUrl=e,j.setStyle(this._el,"background-image",'url("'+this._posterUrl+'")'),this.hide())},r.getElement=function(){return this._el},r._createEl=function(){if(!this._el){var e=this._el=j.createElement("div");j.setAttribute(e,"id",G.uniqueId(5)),j.setAttribute(e,"tabindex","-1")}},r._removeEl=function(){this._el&&j.removeChild(this._el.parentNode,this._el)},r.show=function(){j.setStyle(this._el,"display","")},r.hide=function(){j.setStyle(this._el,"display","none")},r.reset=function(){this._posterUrl="",j.setStyle(this._el,"background-image","")},r.destroy=function(){this.reset(),this._removeEl()},t=e,(n=[{key:"src",get:function(){return this._posterUrl}}])&&K(t.prototype,n),i&&K(t,i),e}(),X={AD_CAN_SKIP:"adcanskip",AD_MANIFEST_LOADED:"admanifestloaded",AD_LOADED:"adloaded",AD_STARTED:"adstarted",AD_RESUMED:"adresumed",AD_PAUSED:"adpaused",AD_CLICKED:"adclicked",AD_SKIPPED:"adskipped",AD_COMPLETED:"adcompleted",AD_ERROR:"aderror",ADS_COMPLETED:"adscompleted",ALL_ADS_COMPLETED:"alladscompleted",AD_BREAK_START:"adbreakstart",AD_BREAK_END:"adbreakend",AD_FIRST_QUARTILE:"adfirstquartile",AD_MIDPOINT:"admidpoint",AD_THIRD_QUARTILE:"adthirdquartile",USER_CLOSED_AD:"userclosedad",AD_VOLUME_CHANGED:"advolumechanged",AD_MUTED:"admuted",AD_PROGRESS:"adprogress",AD_BUFFERING:"adbuffering",AD_WATERFALLING:"adwaterfalling",AD_WATERFALLING_FAILED:"adwaterfallingfailed",AD_AUTOPLAY_FAILED:"adautoplayfailed"},q={ABORT:"abort",CAN_PLAY:"canplay",CAN_PLAY_THROUGH:"canplaythrough",DURATION_CHANGE:"durationchange",EMPTIED:"emptied",ENDED:"ended",ERROR:"error",LOADED_DATA:"loadeddata",LOADED_METADATA:"loadedmetadata",LOAD_START:"loadstart",PAUSE:"pause",PLAY:"play",PLAYING:"playing",PROGRESS:"progress",RATE_CHANGE:"ratechange",SEEKED:"seeked",SEEKING:"seeking",STALLED:"stalled",SUSPEND:"suspend",TIME_UPDATE:"timeupdate",VOLUME_CHANGE:"volumechange",WAITING:"waiting",ENTER_PICTURE_IN_PICTURE:"enterpictureinpicture",LEAVE_PICTURE_IN_PICTURE:"leavepictureinpicture",PRESENTATION_MODE_CHANGED:"webkitpresentationmodechanged"},Q={MEDIA_LOADED:"medialoaded",PLAYER_RESET:"playerreset",PLAYER_DESTROY:"playerdestroy",ENTER_FULLSCREEN:"enterfullscreen",EXIT_FULLSCREEN:"exitfullscreen",PLAY_FAILED:"playfailed",AUTOPLAY_FAILED:"autoplayfailed",FALLBACK_TO_MUTED_AUTOPLAY:"fallbacktomutedautoplay",CHANGE_SOURCE_STARTED:"changesourcestarted",CHANGE_SOURCE_ENDED:"changesourceended",MUTE_CHANGE:"mutechange",VIDEO_TRACK_CHANGED:"videotrackchanged",AUDIO_TRACK_CHANGED:"audiotrackchanged",TEXT_TRACK_CHANGED:"texttrackchanged",IMAGE_TRACK_CHANGED:"imagetrackchanged",TEXT_TRACK_ADDED:"texttrackadded",TEXT_CUE_CHANGED:"textcuechanged",TRACKS_CHANGED:"trackschanged",ABR_MODE_CHANGED:"abrmodechanged",PLAYER_STATE_CHANGED:"playerstatechanged",PLAYBACK_START:"playbackstart",FIRST_PLAY:"firstplay",FIRST_PLAYING:"firstplaying",PLAYBACK_ENDED:"playbackended",SOURCE_SELECTED:"sourceselected",TEXT_STYLE_CHANGED:"textstylechanged",MEDIA_RECOVERED:"mediarecovered",VR_STEREO_MODE_CHANGED:"vrstereomodechanged",FPS_DROP:"fpsdrop",BOOKMARK_ERROR:"bookmarkerror",CONCURRENCY_LIMIT:"concurrencylimit",RESIZE:"resize",TIMED_METADATA:"timedmetadata",TIMED_METADATA_CHANGE:"timedmetadatachange",TIMED_METADATA_ADDED:"timedmetadataadded",FRAG_LOADED:"fragloaded",MANIFEST_LOADED:"manifestloaded",USER_GESTURE:"usergesture",DRM_LICENSE_LOADED:"drmlicenseloaded",SOURCE_URL_SWITCHED:"sourceurlswitched"},Z=V.merge([q,Q,X]);function $(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var J=function(){function e(){}var t,n,i;return t=e,i=[{key:"language",get:function(){var e;return(e=navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.userLanguage?navigator.userLanguage:navigator.language)&&e.match("-")&&(e=e.split("-")[0]),e}}],(n=null)&&$(t.prototype,n),i&&$(t,i),e}();function ee(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var te=function(){function e(e){this.type=e,this._duration=0,this._timestamp=Date.now()/1e3}var t,n,i;return t=e,(n=[{key:"duration",get:function(){return this._duration},set:function(e){this._duration=e-this._timestamp}}])&&ee(t.prototype,n),i&&ee(t,i),e}(),ne={IDLE:"idle",LOADING:"loading",PLAYING:"playing",PAUSED:"paused",BUFFERING:"buffering"};function ie(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var re=function(){function e(e){var t,n,i,r,a,o,s,c,u,l=this;s=this,c="_transitions",(o={})[ne.IDLE]=((t={})[q.LOAD_START]=function(){return l._updateState(ne.LOADING)},t[q.PLAY]=function(){return l._updateState(ne.BUFFERING)},t[q.SEEKED]=function(){return l._updateState(ne.PAUSED)},t),o[ne.LOADING]=((n={})[q.LOADED_METADATA]=function(){return l._updateState(ne.PAUSED)},n[q.ERROR]=function(e){return e.payload.severity===M.Severity.CRITICAL&&l._updateState(ne.IDLE)},n[q.SEEKED]=function(){l._prevState&&l._prevState.type===ne.PLAYING&&l._updateState(ne.PLAYING)},n),o[ne.PAUSED]=((i={})[q.PLAY]=function(){return l._updateState(ne.PLAYING)},i[q.PLAYING]=function(){return l._updateState(ne.PLAYING)},i[q.ENDED]=function(){return l._updateState(ne.IDLE)},i),o[ne.PLAYING]=((r={})[q.PAUSE]=function(){return l._updateState(ne.PAUSED)},r[q.WAITING]=function(){l._player.seeking?l._updateState(ne.LOADING):(l._updateState(ne.BUFFERING),l._lastWaitingTime=l._player.currentTime)},r[q.ENDED]=function(){return l._updateState(ne.IDLE)},r[q.ERROR]=function(e){return e.payload.severity===M.Severity.CRITICAL&&l._updateState(ne.IDLE)},r),o[ne.BUFFERING]=((a={})[q.PLAYING]=function(){return l._updateState(ne.PLAYING)},a[q.PAUSE]=function(){return l._updateState(ne.PAUSED)},a[q.TIME_UPDATE]=function(){"IE"===f.browser.name&&l._player.currentTime!==l._lastWaitingTime&&l._prevState&&l._prevState.type===ne.PLAYING&&(l._lastWaitingTime=null,l._updateState(ne.PLAYING))},a),u=o,c in s?Object.defineProperty(s,c,{value:u,enumerable:!0,configurable:!0,writable:!0}):s[c]=u,this._player=e,this._logger=C("StateManager"),this._eventManager=new x,this._history=[],this._prevState=null,this._curState=new te(ne.IDLE),this._attachListeners()}var t,n,i,r=e.prototype;return r._attachListeners=function(){this._eventManager.listen(this._player,q.ERROR,this._doTransition.bind(this)),this._eventManager.listen(this._player,q.ENDED,this._doTransition.bind(this)),this._eventManager.listen(this._player,q.PLAY,this._doTransition.bind(this)),this._eventManager.listen(this._player,q.LOAD_START,this._doTransition.bind(this)),this._eventManager.listen(this._player,q.PLAYING,this._doTransition.bind(this)),this._eventManager.listen(this._player,q.LOADED_METADATA,this._doTransition.bind(this)),this._eventManager.listen(this._player,q.PAUSE,this._doTransition.bind(this)),this._eventManager.listen(this._player,q.WAITING,this._doTransition.bind(this)),this._eventManager.listen(this._player,q.SEEKED,this._doTransition.bind(this)),this._eventManager.listen(this._player,q.TIME_UPDATE,this._doTransition.bind(this))},r._doTransition=function(e){(e.type!==q.TIME_UPDATE||this._curState===ne.BUFFERING&&e.type===q.TIME_UPDATE)&&this._logger.debug("Do transition request",e.type);var t=this._transitions[this._curState.type];"function"==typeof t[e.type]&&t[e.type](e)},r._updateState=function(e){this._curState.type!==e&&(this._curState.duration=Date.now()/1e3,this._history.push(this._curState),this._prevState=this._curState,this._curState=new te(e),this._logger.debug("Switch player state: from "+this._prevState.type+" to "+this._curState.type),this._dispatchEvent())},r._dispatchEvent=function(){var e=new E(Q.PLAYER_STATE_CHANGED,{oldState:this._prevState,newState:this._curState});this._player.dispatchEvent(e)},r.destroy=function(){this._history=[],this._eventManager.destroy()},r.reset=function(){this._history=[]},t=e,(n=[{key:"currentState",get:function(){return this._curState}},{key:"previousState",get:function(){return this._prevState}},{key:"history",get:function(){return this._history}}])&&ie(t.prototype,n),i&&ie(t,i),e}();function ae(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var oe=function(){var e,t,n;function i(e){void 0===e&&(e={}),this._id=e.id,this._active=e.active,this._label=e.label,this._language=e.language,this._index=e.index,this._available="boolean"!=typeof e.available||e.available,this.clone=i.clone.bind(null,this)}return i.langComparer=function(e,t,n,i){try{return e=e.toLowerCase(),t=t.toLowerCase(),n&&(n=n.toLowerCase()),i?e===t||n===t:!!e&&(e.startsWith(t)||t.startsWith(e))}catch(e){return!1}},i.clone=function(e){return Object.assign(Object.create(Object.getPrototypeOf(e)),e)},e=i,(t=[{key:"id",get:function(){return this._id}},{key:"active",get:function(){return this._active},set:function(e){this._active=e}},{key:"label",get:function(){return this._label},set:function(e){this._label=e}},{key:"language",get:function(){return this._language}},{key:"index",get:function(){return this._index},set:function(e){this._index=e}},{key:"available",get:function(){return this._available},set:function(e){this._available=e}}])&&ae(e.prototype,t),n&&ae(e,n),i}();function se(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ce=function(e){var t,n,i,r,a;function o(t){var n;return void 0===t&&(t={}),(n=e.call(this,t)||this)._bandwidth=t.bandwidth,n._width=t.width,n._height=t.height,n._label=t.label?t.label:n._height?n._height+"p":void 0,n}return n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i=o,(r=[{key:"bandwidth",get:function(){return this._bandwidth}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}}])&&se(i.prototype,r),a&&se(i,a),o}(oe);var ue=function(e){var t,n;function i(){return e.apply(this,arguments)||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(oe);function le(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function de(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var he={"":!0,up:!0};function _e(e){return"number"==typeof e&&e>=0&&e<=100}var Ae,fe=function(){function e(){de(this,"_width",100),de(this,"_lines",3),de(this,"_regionAnchorX",0),de(this,"_regionAnchorY",100),de(this,"_viewportAnchorX",0),de(this,"_viewportAnchorY",100),de(this,"_scroll","")}var t,n,i;return t=e,(n=[{key:"width",get:function(){return this._width},set:function(e){if(!_e(e))throw new Error("Width must be between 0 and 100.");this._width=e}},{key:"scroll",get:function(){return this._scroll},set:function(e){var t=function(e){return"string"==typeof e&&!!he[e.toLowerCase()]&&e.toLowerCase()}(e);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");this._scroll=t}},{key:"viewportAnchorY",get:function(){return this._viewportAnchorY},set:function(e){if(!_e(e))throw new Error("ViewportAnchorY must be between 0 and 100.");this._viewportAnchorY=e}},{key:"viewportAnchorX",get:function(){return this._viewportAnchorX},set:function(e){if(!_e(e))throw new Error("ViewportAnchorX must be between 0 and 100.");this._viewportAnchorX=e}},{key:"regionAnchorX",get:function(){return this._regionAnchorX},set:function(e){if(!_e(e))throw new Error("RegionAnchorY must be between 0 and 100.");this._regionAnchorX=e}},{key:"lines",get:function(){return this._lines},set:function(e){if("number"!=typeof e)throw new TypeError("Lines must be set to a number.");this._lines=e}},{key:"regionAnchorY",get:function(){return this._regionAnchorY},set:function(e){if(!_e(e))throw new Error("RegionAnchorX must be between 0 and 100.");this._regionAnchorY=e}}])&&le(t.prototype,n),i&&le(t,i),e}();function ge(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function pe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Ae="undefined"!=typeof window&&window.VTTRegion?window.VTTRegion:fe;var ve=function(){function e(){pe(this,"_fontSizeIndex",2),pe(this,"fontFamily",e.FontFamily.SANS_SERIF),pe(this,"fontColor",e.StandardColors.WHITE),pe(this,"fontOpacity",e.StandardOpacities.OPAQUE),pe(this,"backgroundColor",e.StandardColors.BLACK),pe(this,"backgroundOpacity",e.StandardOpacities.OPAQUE),pe(this,"fontEdge",e.EdgeStyles.NONE)}e.toRGBA=function(e,t){return"rgba("+e.concat(t).join(",")+")"},e.fromJson=function(t){var n=function(e,t){return null!=e?e:t},i=new e;return i.fontEdge=n(t.fontEdge,i.fontEdge),i.fontSize=n(t.fontSize,i.fontSize),i.fontScale=n(t.fontScale,i.fontScale),i.fontColor=n(t.fontColor,i.fontColor),i.fontOpacity=n(t.fontOpacity,i.fontOpacity),i.backgroundColor=n(t.backgroundColor,i.backgroundColor),i.backgroundOpacity=n(t.backgroundOpacity,i.backgroundOpacity),i.fontFamily=n(t.fontFamily,i.fontFamily),i},e.toJson=function(e){return{fontEdge:e.fontEdge,fontSize:e.fontSize,fontScale:e.fontScale,fontColor:e.fontColor,fontOpacity:e.fontOpacity,backgroundColor:e.backgroundColor,backgroundOpacity:e.backgroundOpacity,fontFamily:e.fontFamily}};var t,n,i,r=e.prototype;return r.getTextShadow=function(){for(var t=[],n=0;n<this.fontEdge.length;n++){var i=this.fontEdge[n].slice(0,3),r=this.fontEdge[n].slice(3,6);t.push(e.toRGBA(i,this.fontOpacity)+" "+r.join("px ")+"px")}return t.join(",")},r.toCSS=function(){var t=[];return t.push("font-family: "+this.fontFamily),t.push("color: "+e.toRGBA(this.fontColor,this.fontOpacity)),t.push("background-color: "+e.toRGBA(this.backgroundColor,this.backgroundOpacity)),t.push("text-shadow: "+this.getTextShadow()),t.join("!important; ")},r.clone=function(){return e.fromJson(e.toJson(this))},r.isEqual=function(t){return JSON.stringify(e.toJson(this))===JSON.stringify(e.toJson(t))},t=e,(n=[{key:"fontSize",set:function(t){var n=e.FontSizes.findIndex((function(e){return e.label===t}));-1!==n&&(this._fontSizeIndex=n)},get:function(){return e.FontSizes[this._fontSizeIndex].label}},{key:"fontScale",set:function(t){var n=e.FontSizes.findIndex((function(e){return e.value===t}));-1!==n&&(this._fontSizeIndex=n)},get:function(){return e.FontSizes[this._fontSizeIndex].value}},{key:"implicitFontScale",get:function(){return.25*e.FontSizes[this._fontSizeIndex].value+1}}])&&ge(t.prototype,n),i&&ge(t,i),e}();pe(ve,"FontFamily",{ARIAL:"Arial",HELVETICA:"Helvetica",VERDANA:"Verdana",SANS_SERIF:"sans-serif"}),pe(ve,"StandardColors",{WHITE:[255,255,255],BLACK:[0,0,0],RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,255,0],MAGENTA:[255,0,255],CYAN:[0,255,255]}),pe(ve,"StandardOpacities",{OPAQUE:1,SEMI_HIGH:.75,SEMI_LOW:.25,TRANSPARENT:0}),pe(ve,"EdgeStyles",{NONE:[],RAISED:[[34,34,34,1,1,0],[34,34,34,2,2,0],[34,34,34,3,3,0]],DEPRESSED:[[204,204,204,1,1,0],[204,204,204,0,1,0],[34,34,34,-1,-1,0],[34,34,34,0,-1,0]],UNIFORM:[[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4]],DROP:[[34,34,34,2,2,3],[34,34,34,2,2,4],[34,34,34,2,2,5]]}),pe(ve,"FontSizes",[{value:-2,label:"50%"},{value:-1,label:"75%"},{value:0,label:"100%"},{value:2,label:"200%"},{value:3,label:"300%"},{value:4,label:"400%"}]);var Ee=ve;function me(e){function t(e,t,n,i){return 3600*(0|e)+60*(0|t)+(0|n)+(0|i)/1e3}var n=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return n?n[3]?t(n[1],n[2],n[3].replace(":",""),n[4]):n[1]>59?t(n[1],n[2],0,n[4]):t(0,n[1],n[2],n[4]):null}var Te={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"‎","&rlm;":"‏","&nbsp;":" "},ye={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},be={v:"title",lang:"lang"},Se={rt:"ruby"};function ke(){this.values=Me(null)}function we(e,t,n,i){var r=i?e.split(i):[e];for(var a in r)if("string"==typeof r[a]){var o=r[a].split(n);if(2===o.length)t(o[0],o[1])}}function Ce(e,t,n){var i=e;function r(){var t=me(e);if(null===t)throw new Ue(Ue.Errors.BadTimeStamp,"Malformed timestamp: "+i);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function a(){e=e.replace(/^\s+/,"")}if(a(),t.startTime=r(),a(),"--\x3e"!==e.substr(0,3))throw new Ue(Ue.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+i);e=e.substr(3),a(),t.endTime=r(),a(),function(e,t){var i=new ke;we(e,(function(e,t){switch(e){case"region":for(var r=n.length-1;r>=0;r--)if(n[r].id===t){i.set(e,n[r].region);break}break;case"vertical":i.alt(e,t,["rl","lr"]);break;case"line":var a=t.split(","),o=a[0];i.integer(e,o),i.percent(e,o)&&i.set("snapToLines",!1),i.alt(e,o,["auto"]),2===a.length&&i.alt("lineAlign",a[1],["start","center","end"]);break;case"position":a=t.split(","),i.percent(e,a[0]),2===a.length&&i.alt("positionAlign",a[1],["start","center","end"]);break;case"size":i.percent(e,t);break;case"align":i.alt(e,t,["start","center","end","left","right"])}}),/:/,/\s/),t.region=i.get("region",null),t.vertical=i.get("vertical",""),t.line=i.get("line",t.line||"auto"),t.lineAlign=i.get("lineAlign","start"),t.snapToLines=i.get("snapToLines",!0),t.size=i.get("size",100);try{t.align=i.get("align","center")}catch(e){t.align=i.get("align","middle")}t.position=i.get("position",t.position||"auto"),t.positionAlign=i.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},t.align)}(e,t)}function Re(e,t){function n(){if(!t)return null;var e,n=t.match(/^([^<]*)(<[^>]+>?)?/);return e=n[1]?n[1]:n[2],t=t.substr(e.length),e}function i(e){return Te[e]}function r(e){for(var t;t=e.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)e=e.replace(t[0],i);return e}function a(e,t){return!Se[t.localName]||Se[t.localName]===e.localName}function o(t,n){var i=ye[t];if(!i)return null;var r=e.document.createElement(i),a=be[t];return a&&n&&(r[a]=n.trim()),r}for(var s,c=e.document.createElement("div"),u=c,l=[];null!==(s=n());)if("<"!==s[0])u.appendChild(e.document.createTextNode(r(s)));else{if("/"===s[1]){l.length&&l[l.length-1]===s.substr(2).replace(">","")&&(l.pop(),u=u.parentNode);continue}var d=me(s.substr(1,s.length-2)),h=void 0;if(d){h=e.document.createProcessingInstruction("timestamp",d),u.appendChild(h);continue}var _=s.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!_)continue;if(!(h=o(_[1],_[3])))continue;if(!a(u,h))continue;_[2]&&(h.className=_[2].substr(1).replace("."," ")),l.push(_[1]),u.appendChild(h),u=h}return c}ke.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,n){for(var i=0;i<n.length;++i)if(t===n[i]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(e,t),!0)}};var De=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function Ie(e){for(var t=0;t<De.length;t++){var n=De[t];if(e>=n[0]&&e<=n[1])return!0}return!1}var Oe=function(e){var t,n;function i(t,n,i){var r;r=e.call(this)||this;var a="undefined"!=typeof navigator&&/MSIE\s8\.0/.test(navigator.userAgent);"undefined"!=typeof WebVTTSet&&(WebVTTSet.fontSet,WebVTTSet.backgroundSet,WebVTTSet.edgeSet),a&&"rgb(255, 255, 255)",r.cue=n,r.cueDiv=Re(t,n.text);var o={color:i.color,backgroundColor:i.backgroundColor,textShadow:i.textShadow,position:"relative",left:0,right:0,top:0,bottom:0,display:"inline"};a||(o.writingMode=""===n.vertical?"horizontal-tb":"lr"===n.vertical?"vertical-lr":"vertical-rl",o.unicodeBidi="plaintext"),r.applyStyles(o,r.cueDiv),r.div=t.document.createElement("div"),o={textAlign:"middle"===n.align?"center":n.align,font:i.font,whiteSpace:"pre-line",position:"absolute"},a||(o.direction=function(e){var t=[],n="";if(!e||!e.childNodes)return"ltr";function i(e,t){for(var n=t.childNodes.length-1;n>=0;n--)e.push(t.childNodes[n])}function r(e){if(!e||!e.length)return null;var t=e.pop(),n=t.textContent||t.innerText;if(n){var a=n.match(/^.*(\n|\r)/);return a?(e.length=0,a[0]):n}return"ruby"===t.tagName?r(e):t.childNodes?(i(e,t),r(e)):void 0}for(i(t,e);n=r(t);)for(var a=0;a<n.length;a++)if(Ie(n.charCodeAt(a)))return"rtl";return"ltr"}(r.cueDiv),o.writingMode=""===n.vertical?"horizontal-tb":"lr"===n.vertical?"vertical-lr":"vertical-rl".stylesunicodeBidi="plaintext"),r.applyStyles(o),r.div.appendChild(r.cueDiv);var s=0;switch(n.positionAlign||n.align){case"start":case"left":case"line-left":s=n.position;break;case"center":s=n.position-n.size/2;break;case"end":case"right":case"line-right":s=n.position-n.size}return""===n.vertical?r.applyStyles({left:r.formatStyle(s,"%"),width:r.formatStyle(Math.min(n.size,100-s)||n.size,"%")}):r.applyStyles({top:r.formatStyle(s,"%"),height:r.formatStyle(Math.min(n.size,100-s)||n.size,"%")}),r.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})},r}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(function(){function e(){}var t=e.prototype;return t.applyStyles=function(e,t){for(var n in t=t||this.div,e)e.hasOwnProperty(n)&&(t.style[n]=e[n])},t.formatStyle=function(e,t){return 0===e?0:e+t},e}()),Ne=function(){function e(e){var t,n,i,r;if(function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"overlaps",(function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top})),e.div){n=e.div.offsetHeight,i=e.div.offsetWidth,r=e.div.offsetTop;var a=(a=e.div.childNodes)&&(a=a[0])&&a.getClientRects&&a.getClientRects();e=e.div.getBoundingClientRect(),t=a?Math.max(a[0]&&a[0].height||0,e.height/a.length):0}this.left=e.left,this.right=e.right,this.top=e.top||r,this.height=e.height||n,this.bottom=e.bottom||r+(e.height||n),this.width=e.width||i,this.lineHeight=t||e.lineHeight||13}var t=e.prototype;return t.move=function(e,t){switch(t=void 0!==t?t:this.lineHeight,e){case"+x":this.left+=t,this.right+=t;break;case"-x":this.left-=t,this.right-=t;break;case"+y":this.top+=t,this.bottom+=t;break;case"-y":this.top-=t,this.bottom-=t}},t.overlapsAny=function(e){for(var t=0;t<e.length;t++)if(this.overlaps(e[t]))return!0;return!1},t.within=function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right},t.overlapsOppositeAxis=function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom}},t.intersectPercentage=function(e){return Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left))*Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top))/(this.height*this.width)},t.toCSSCompatValues=function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}},e.getSimpleBoxPosition=function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0,n=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0,i=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;return{left:(e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e).left,right:e.right,top:e.top||i,height:e.height||t,bottom:e.bottom||i+(e.height||t),width:e.width||n}},e}();function xe(e,t,n,i){var r=new Ne(t),a=t.cue,o=function(e){if("number"==typeof e.line&&(e.snapToLines||e.line>=0&&e.line<=100))return e.line;if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement)return-1;for(var t=e.track,n=t.textTrackList,i=0,r=0;r<n.length&&n[r]!==t;r++)n[r].mode===tt.MODE.SHOWING&&i++;return-1*++i}(a),s=[];if(a.snapToLines){var c;switch(a.vertical){case"":s=["+y","-y"],c="height";break;case"rl":s=["+x","-x"],c="width";break;case"lr":s=["-x","+x"],c="width"}var u=r.lineHeight,l=u*Math.round(o),d=n[c]+u,h=s[0];Math.abs(l)>d&&(l=l<0?-1:1,l*=Math.ceil(d/u)*u),o<0&&(l+=""===a.vertical?n.height:n.width,s=s.reverse()),r.move(h,l)}else{var _=r.lineHeight/n.height*100;switch(a.lineAlign){case"center":o-=_/2;break;case"end":o-=_}switch(a.vertical){case"":t.applyStyles({top:t.formatStyle(o,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(o,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(o,"%")})}s=["+y","-x","+x","-y"],r=new Ne(t)}var A=function(e,t){for(var r,a=new Ne(e),o=1,s=0;s<t.length;s++){for(;e.overlapsOppositeAxis(n,t[s])||e.within(n)&&e.overlapsAny(i);)e.move(t[s]);if(e.within(n))return e;var c=e.intersectPercentage(n);o>c&&(r=new Ne(e),o=c),e=new Ne(a)}return r||a}(r,s);t.move(A.toCSSCompatValues(n))}var Pe=function(e,t){this.window=e,this.state="INITIAL",this.buffer="",this.decoder=t||new TextDecoder("utf8"),this.regionList=[]},Le=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}},Me=Object.create||function(){function e(){}return function(t){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return e.prototype=t,new e}}();function Ue(e,t){this.name="ParsingError",this.code=e.code,this.message=t||e.message}function Fe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Be(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Ue.prototype=Me(Error.prototype),Ue.prototype.constructor=Ue,Ue.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},Pe.prototype={reportOrThrowError:function(e){if(!(e instanceof Ue))throw e;this.onparsingerror&&this.onparsingerror(e)},parse:function(e){var t=this;function n(){for(var e=t.buffer,n=0;n<e.length&&"\r"!==e[n]&&"\n"!==e[n];)++n;var i=e.substr(0,n);return"\r"===e[n]&&++n,"\n"===e[n]&&++n,t.buffer=e.substr(n),i}function i(e){we(e,(function(e,n){switch(e){case"Region":!function(e){var n=new ke;if(we(e,(function(e,t){switch(e){case"id":n.set(e,t);break;case"width":n.percent(e,t);break;case"lines":n.integer(e,t);break;case"regionanchor":case"viewportanchor":var i=t.split(",");if(2!==i.length)break;var r=new ke;if(r.percent("x",i[0]),r.percent("y",i[1]),!r.has("x")||!r.has("y"))break;n.set(e+"X",r.get("x")),n.set(e+"Y",r.get("y"));break;case"scroll":n.alt(e,t,["up"])}}),/=/,/\s/),n.has("id")){var i=new Ae;i.width=n.get("width",100),i.lines=n.get("lines",3),i.regionAnchorX=n.get("regionanchorX",0),i.regionAnchorY=n.get("regionanchorY",100),i.viewportAnchorX=n.get("viewportanchorX",0),i.viewportAnchorY=n.get("viewportanchorY",100),i.scroll=n.get("scroll",""),t.onregion&&t.onregion(i),t.regionList.push({id:n.get("id"),region:i})}}(n)}}),/:/)}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var r;if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var a=(r=n()).match(/^WEBVTT([ \t].*)?$/);if(!a||!a[0])throw new Ue(Ue.Errors.BadSignature);t.state="HEADER"}for(var o=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(o?o=!1:r=n(),t.state){case"HEADER":/:/.test(r)?i(r):r||(t.state="ID");continue;case"NOTE":r||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(r)){t.state="NOTE";break}if(!r)continue;if(t.cue=new je(0,0,""),t.state="CUE",-1===r.indexOf("--\x3e")){t.cue.id=r;continue}case"CUE":try{Ce(r,t.cue,t.regionList)}catch(e){t.reportOrThrowError(e),t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var s=-1!==r.indexOf("--\x3e");if(!r||s&&(o=!0)){t.oncue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}t.cue.text&&(t.cue.text+="\n"),t.cue.text+=r;continue;case"BADCUE":r||(t.state="ID");continue}}}catch(e){t.reportOrThrowError(e),"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),(this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new Ue(Ue.Errors.BadSignature)}catch(e){this.reportOrThrowError(e)}return this.onflush&&this.onflush(),this}};var He={"":!0,lr:!0,rl:!0},Ve={start:!0,center:!0,end:!0,left:!0,right:!0};function Ge(e){return"string"==typeof e&&(!!Ve[e.toLowerCase()]&&e.toLowerCase())}var je,Ye,We,Ke=function(){function e(e,t,n){Be(this,"hasBeenReset",!1),Be(this,"displayState",void 0),Be(this,"_id",""),Be(this,"_pauseOnExit",!1),Be(this,"_region",null),Be(this,"_vertical",""),Be(this,"_snapToLines",!0),Be(this,"_line","auto"),Be(this,"_lineAlign","start"),Be(this,"_position",50),Be(this,"_positionAlign","center"),Be(this,"_size",50),Be(this,"_align","center"),this._startTime=e,this._endTime=t,this._text=n}var t,n,i,r=e.prototype;return r.resetCue=function(){this.hasBeenReset=!0},r.getCueAsHTML=function(){return function(e,t){return e&&t?Re(e,t):null}(window,this.text)},t=e,(n=[{key:"id",get:function(){return this._id},set:function(e){this._id=""+e}},{key:"pauseOnExit",get:function(){return this._pauseOnExit},set:function(e){this._pauseOnExit=e}},{key:"startTime",get:function(){return this._startTime},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");this._startTime=e,this.resetCue()}},{key:"endTime",get:function(){return this._endTime},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");this._endTime=e,this.resetCue()}},{key:"text",get:function(){return this._text},set:function(e){this._text=""+e,this.resetCue()}},{key:"region",get:function(){return this._region},set:function(e){this._region=e,this.resetCue()}},{key:"vertical",get:function(){return this._vertical},set:function(e){var t=function(e){return"string"==typeof e&&!!He[e.toLowerCase()]&&e.toLowerCase()}(e);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");"string"==typeof t&&(this._vertical=t,this.resetCue())}},{key:"snapToLines",get:function(){return this._snapToLines},set:function(e){this._snapToLines=e,this.resetCue()}},{key:"line",get:function(){return this._line},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");this._line=e,this.resetCue()}},{key:"lineAlign",get:function(){return this._lineAlign},set:function(e){var t=Ge(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");"string"==typeof t&&(this._lineAlign=t,this.resetCue())}},{key:"position",get:function(){return this._position},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");this._position=e,this.resetCue()}},{key:"positionAlign",get:function(){return this._positionAlign},set:function(e){var t=Ge(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");"string"==typeof t&&(this._positionAlign=t,this.resetCue())}},{key:"size",get:function(){return this._size},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");this._size=e,this.resetCue()}},{key:"align",get:function(){return this._align},set:function(e){var t=Ge(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");"string"==typeof t&&(this._align=t,this.resetCue())}}])&&Fe(t.prototype,n),i&&Fe(t,i),e}();function ze(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Xe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Xe(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function Xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function qe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}je="undefined"!=typeof window&&window.VTTCue?window.VTTCue:Ke;var Qe,Ze,$e,Je=(We=Ye=function(e){var t,n,i,r,a;function o(t){var n;return void 0===t&&(t={}),(n=e.call(this,t)||this)._label=n.label||n.language,n._kind=t.kind,n._external=t.external,n._index=o._generateIndex(),n._default=t.default||!1,n}return n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,o._generateIndex=function(){return o._tracksCount++},o.reset=function(){o._tracksCount=0},i=o,(r=[{key:"kind",get:function(){return this._kind}},{key:"external",get:function(){return this._external}},{key:"default",get:function(){return this._default}}])&&qe(i.prototype,r),a&&qe(i,a),o}(oe),$e=0,(Ze="_tracksCount")in(Qe=Ye)?Object.defineProperty(Qe,Ze,{value:$e,enumerable:!0,configurable:!0,writable:!0}):Qe[Ze]=$e,We);function et(e){for(var t,n=[],i=ze(e);!(t=i()).done;){var r=t.value;if(window.VTTCue&&r instanceof window.VTTCue||window.DataCue&&r instanceof window.DataCue)n.push(r);else if(window.TextTrackCue&&r instanceof window.TextTrackCue)try{n.push(new je(r.startTime,r.endTime,r.text))}catch(e){new M(M.Severity.RECOVERABLE,M.Category.TEXT,M.Code.UNABLE_TO_CREATE_TEXT_CUE,e)}}return n}Je.MODE={DISABLED:"disabled",SHOWING:"showing",HIDDEN:"hidden"},Je.KIND={METADATA:"metadata",SUBTITLES:"subtitles",CAPTIONS:"captions"},Je.EXTERNAL_TRACK_ID="playkit-external-track",Je.isMetaDataTrack=function(e){return e&&e.kind===Je.KIND.METADATA},Je.isNativeTextTrack=function(e){return e&&[Je.KIND.SUBTITLES,Je.KIND.CAPTIONS].includes(e.kind)},Je.isExternalTrack=function(e){return e&&[e.language,e.label].includes(Je.EXTERNAL_TRACK_ID)};var tt=Je,nt=Object.freeze({VIDEO:"video",AUDIO:"audio",TEXT:"text",IMAGE:"image"}),it={DASH:"dash",HLS:"hls",PROGRESSIVE:"progressive",IMAGE:"image"},rt={HTML5:"html5",FLASH:"flash",SILVERLIGHT:"silverlight",CAST:"cast",YOUTUBE:"youtube",IMAGE:"image"},at={VOD:"Vod",LIVE:"Live",AUDIO:"Audio",IMAGE:"Image",UNKNOWN:"Unknown"},ot={MANUAL:"manual",AUTO:"auto"},st={ANONYMOUS:"anonymous",USE_CREDENTIALS:"use-credentials"},ct=function(){function e(){}return e.prototype.callNext=function(e){e&&e()},e}(),ut=function(){function e(e){this._actions=e,this._middlewares=new v,this._logger=C("Middleware")}var t=e.prototype;return t.use=function(e){for(var t in this._actions){var n=this._actions[t];"function"==typeof e[n]&&(this._logger.debug("Register <"+e.id+"> for action "+n),this._middlewares.push(n,e[n].bind(e)))}},t.run=function(e,t){var n=this;this._logger.debug("Start middleware chain for action "+e);for(var i=this._middlewares.get(e),r=arguments.length,a=new Array(r>2?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];this._executeMiddleware(i,(function(){n._logger.debug("Finish middleware chain for action "+e),t.apply(void 0,arguments)}),a)},t._executeMiddleware=function(e,t,n){var i=n,r=function(e,t,n){var r;(null==t?void 0:t.length)&&(i=t),(null==(r=i)?void 0:r.length)?e.apply(void 0,i.concat([n])):e(n)};e.reduceRight((function(e,t){return function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];r(t,i,e)}}),(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];r(t,n)}))()},e}();var lt=function(){function e(){this._middleware=new ut(e.Actions)}var t=e.prototype;return t.use=function(e){this._middleware.use(e)},t.load=function(t){this._middleware.run(e.Actions.LOAD,t)},t.play=function(t){this._middleware.run(e.Actions.PLAY,t)},t.pause=function(t){this._middleware.run(e.Actions.PAUSE,t)},t.setCurrentTime=function(t,n){this._middleware.run(e.Actions.SET_CURRENT_TIME,n,t)},e}();!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(lt,"Actions",{LOAD:"load",PLAY:"play",PAUSE:"pause",SET_CURRENT_TIME:"setCurrentTime"});var dt={NONE:"none",ANY:"any",NATURAL:"natural",LANDSCAPE:"landscape",PORTRAIT:"portrait",PORTRAIT_PRIMARY:"portrait-primary",PORTRAIT_SECONDARY:"portrait-secondary",LANDSCAPE_PRIMARY:"landscape-primary",LANDSCAPE_SECONDARY:"landscape-secondary"},ht={log:{level:"ERROR"},text:{enableCEA708Captions:!0,useNativeTextTrack:!1,forceCenter:!1,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es"},playback:{audioLanguage:"",textLanguage:"",volume:1,playsinline:!0,preload:"none",autoplay:!1,loop:!1,autopause:!1,allowMutedAutoPlay:!0,muted:!1,pictureInPicture:!0,options:{html5:{hls:{},dash:{},native:{}}},preferNative:{hls:!1,dash:!1},inBrowserFullscreen:!1,screenLockOrientionMode:dt.NONE,playAdsWithMSE:!1,streamPriority:[{engine:"html5",format:"hls"},{engine:"html5",format:"dash"},{engine:"html5",format:"progressive"},{engine:"flash",format:"hls"}]},streaming:{forceBreakStall:!1},abr:{enabled:!0,fpsDroppedFramesInterval:5e3,fpsDroppedMonitoringThreshold:.2,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,restrictions:{minHeight:0,maxHeight:1/0,minWidth:0,maxWidth:1/0,minBitrate:0,maxBitrate:1/0}},drm:{keySystem:""},network:{maxStaleLevelReloads:20}},_t={options:{},metadata:{}},At=(n(5),{MANIFEST:0,SEGMENT:1,LICENSE:2});function ft(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var gt=function(e){var t,n,i,r,a;function o(t){var n;n=e.call(this,t)||this;var i=t.url,r=t.width,a=t.height,o=t.duration,s=t.rows,c=t.cols,u=t.customData;return n._url=i,n._width=r,n._height=a,n._duration=o,n._customData=u,n._rows=s||1,n._cols=c||1,n}return n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i=o,(r=[{key:"url",get:function(){return this._url}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"duration",get:function(){return this._duration}},{key:"rows",get:function(){return this._rows}},{key:"cols",get:function(){return this._cols}},{key:"customData",get:function(){return this._customData}},{key:"sliceWidth",get:function(){return this._width/this._cols}},{key:"sliceHeight",get:function(){return this._height/this._rows}}])&&ft(i.prototype,r),a&&ft(i,a),o}(oe);function pt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var vt=function(){function e(e){var t=e.url,n=e.width,i=e.height,r=e.x,a=e.y;this._url=t,this._width=n,this._height=i,this._x=r,this._y=a}var t,n,i;return t=e,(n=[{key:"url",get:function(){return this._url}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}}])&&pt(t.prototype,n),i&&pt(t,i),e}();function Et(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function mt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Tt=function(e){var t,n;function i(t,n,i){var r;return void 0===i&&(i={}),mt(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r=e.call(this)||this),"_capabilities",{fpsControl:!1}),r._videoElement=t,r._sourceObj=n,r._config=i,r._onDurationChanged=function(){r.isLive()&&r._videoElement.paused&&r._trigger(q.TIME_UPDATE)},r._eventManager=new x,r._handleLiveTimeUpdate(),r}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.isSupported=function(){return!0},i.isMSESupported=function(){var e=window.MediaSource||window.WebKitMediaSource;return!!e&&"function"==typeof e.isTypeSupported};var r,a,o,s=i.prototype;return s.destroy=function(){return this._sourceObj=null,this._config={},this.disableNativeTextTracks(),this._videoElement.removeEventListener(q.DURATION_CHANGE,this._onDurationChanged),this._eventManager.destroy(),Promise.resolve()},s._onTrackChanged=function(e){e instanceof ce?(i._logger.debug("Video track changed",e),this._trigger(Q.VIDEO_TRACK_CHANGED,{selectedVideoTrack:e})):e instanceof ue?(i._logger.debug("Audio track changed",e),this._trigger(Q.AUDIO_TRACK_CHANGED,{selectedAudioTrack:e})):e instanceof tt?(i._logger.debug("Text track changed",e),this._trigger(Q.TEXT_TRACK_CHANGED,{selectedTextTrack:e})):e instanceof gt&&(i._logger.debug("Image track changed",e),this._trigger(Q.IMAGE_TRACK_CHANGED,{selectedImageTrack:e}))},s._trigger=function(e,t){this.dispatchEvent(new E(e,t))},i.canPlayType=function(e,t){return i._throwNotImplementedError("static canPlayType")},s.load=function(){return i._throwNotImplementedError("load")},s.selectVideoTrack=function(e){return i._throwNotImplementedError("selectVideoTrack")},s.selectAudioTrack=function(e){i._throwNotImplementedError("selectAudioTrack")},s.selectTextTrack=function(e){i._throwNotImplementedError("selectTextTrack")},s.selectImageTrack=function(e){},s.hideTextTrack=function(){i._throwNotImplementedError("hideTextTrack")},s.enableAdaptiveBitrate=function(){i._throwNotImplementedError("enableAdaptiveBitrate")},s.isAdaptiveBitrateEnabled=function(){return i._throwNotImplementedError("isAdaptiveBitrateEnabled")},s.applyABRRestriction=function(e){return i._throwNotImplementedError("applyABRRestriction")},s._getLiveEdge=function(){return i._throwNotImplementedError("_getLiveEdge")},s.seekToLiveEdge=function(){i._throwNotImplementedError("seekToLiveEdge")},s.isLive=function(){return i._throwNotImplementedError("isLive")},s.isOnLiveEdge=function(){return this.liveDuration-this._videoElement.currentTime<=2*this.getSegmentDuration()},s.setMaxBitrate=function(e){},s.attachMediaSource=function(){},s.detachMediaSource=function(){},s._handleLiveTimeUpdate=function(){this._videoElement.addEventListener(q.DURATION_CHANGE,this._onDurationChanged)},s.disableNativeTextTracks=function(){Array.from(this._videoElement.textTracks).forEach((function(e){tt.isNativeTextTrack(e)&&!tt.isExternalTrack(e)&&(e.mode=tt.MODE.DISABLED)}))},s.handleMediaError=function(e){return!1},s.getStartTimeOfDvrWindow=function(){return i._throwNotImplementedError("getStartTimeOfDvrWindow")},s.getThumbnail=function(e){return null},s.getSegmentDuration=function(){return i._throwNotImplementedError("getSegmentDuration")},i._throwNotImplementedError=function(e){throw new M(M.Severity.CRITICAL,M.Category.PLAYER,M.Code.RUNTIME_ERROR_METHOD_NOT_IMPLEMENTED,e)},s.getDrmInfo=function(){return null},r=i,(a=[{key:"liveDuration",get:function(){return i._throwNotImplementedError("liveDuration")}},{key:"src",get:function(){return this._loadPromise&&this._sourceObj?this._sourceObj.url:""},set:function(e){!this._loadPromise&&this._sourceObj&&(this._sourceObj.url=e)}},{key:"capabilities",get:function(){return this._capabilities}},{key:"targetBuffer",get:function(){return NaN}}])&&Et(r.prototype,a),o&&Et(r,o),i}(R);function yt(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return bt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function bt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function St(e,t){var n=function(e,t){var n=function(e,t,n){return e>=(t||0)&&e<=(n||1/0)},i=t.maxHeight,r=t.minHeight,a=t.maxWidth,o=t.minWidth;if(0!==r||0!==o||i!==1/0||a!==1/0)return e.filter((function(e){return n(e.height,r,i)})).filter((function(e){return n(e.width,o,a)}));var s=t.maxBitrate,c=t.minBitrate;return 0!==c||s!==1/0?e.filter((function(e){return n(e.bandwidth,c,s)})):e}(e,t);return n.length?n:[]}mt(Tt,"id","BaseAdapter"),mt(Tt,"getLogger",C),mt(Tt,"_logger",Tt.getLogger(Tt.id));var kt={WIDEVINE:"com.widevine.alpha",PLAYREADY:"com.microsoft.playready",FAIRPLAY:"com.apple.fairplay"},wt=C("FairPlay"),Ct=function(){function e(){}return e.isConfigured=function(e,t){return kt.FAIRPLAY===t.keySystem&&!!e.find((function(e){return e.scheme===t.keySystem}))},e.canPlayDrm=function(e){var t=e.some((function(e){return e.scheme===kt.FAIRPLAY}))&&!!window.WebKitMediaKeys;return wt.debug("Can play DRM scheme of: "+kt.FAIRPLAY+" is "+t.toString()),t},e.setDrmPlayback=function(e,t){wt.debug("Sets drm playback");var n=t.find((function(e){return e.scheme===kt.FAIRPLAY}));n&&(e.licenseUrl=n.licenseUrl,e.certificate=n.certificate)},e}(),Rt=n(2);function Dt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var It={NEED_KEY:"webkitneedkey",KEY_MESSAGE:"webkitkeymessage",KEY_ADDED:"webkitkeyadded",KEY_ERROR:"webkitkeyerror"},Ot=function(){function e(t,n,i,r){var a=this;Dt(this,"_logger",C("FairPlayDrmHandler")),Dt(this,"_retryLicenseRequest",4),Dt(this,"_defaultConfig",{licenseUrl:"",certificate:"",network:{responseFilter:function(t,n){var i={};try{var r=new DataView(n.data),o=(new TextDecoder).decode(r).trim();i=JSON.parse(o)}catch(e){return void a._onError(M.Code.BAD_FAIRPLAY_RESPONSE,{error:e,responseText:n.data})}var s=e._validateResponse(i);s.valid?n.data=e._base64DecodeUint8Array(i.ckc):a._onError(M.Code.BAD_FAIRPLAY_RESPONSE,s)}}}),this._config=V.mergeDeep({},this._defaultConfig,n),this._errorCallback=i,this._drmResponseCallback=r,this._videoElement=t,this._onWebkitNeedKeyHandler=function(e){return a._onWebkitNeedKey(e)},this._eventManager=new x,this._eventManager.listen(this._videoElement,It.NEED_KEY,this._onWebkitNeedKeyHandler)}var t=e.prototype;return t._onWebkitNeedKey=function(t){var n=this;this._logger.debug("Webkit need key triggered");var i=t.target,r=t.initData,a=e._extractContentId(r),o=e._base64DecodeUint8Array(this._config.certificate);if(r=e._concatInitDataIdAndCertificate(r,a,o),!i.webkitKeys){var s=this._selectKeySystem();this._logger.debug("Sets media keys"),i.webkitSetMediaKeys(new window.WebKitMediaKeys(s))}i.webkitKeys||this._onError(M.Code.COULD_NOT_CREATE_MEDIA_KEYS),this._logger.debug("Creates session"),this._keySession=i.webkitKeys.createSession("video/mp4",r),this._keySession||this._onError(M.Code.COULD_NOT_CREATE_KEY_SESSION),this._keySession.contentId=a,this._eventManager.listen(this._keySession,It.KEY_MESSAGE,(function(e){return n._onWebkitKeyMessage(e)})),this._eventManager.listen(this._keySession,It.KEY_ADDED,(function(){return n._onWebkitKeyAdded()})),this._eventManager.listen(this._keySession,It.KEY_ERROR,(function(e){return n._onWebkitKeyError(e)}))},t.getDrmInfo=function(){var e=this._config;return{certificate:e.certificate,licenseUrl:e.licenseUrl,scheme:kt.FAIRPLAY}},t.destroy=function(){this._eventManager.destroy(),this._keySession.close(),this._keySession=null},t._onWebkitKeyMessage=function(t){var n=this;this._logger.debug("Webkit key message triggered");var i=t.message,r=new XMLHttpRequest;r.responseType="arraybuffer",this._eventManager.listenOnce(r,"load",(function(e){return n._licenseRequestLoaded(e)}));var a,o={url:this._config.licenseUrl,body:e._base64EncodeUint8Array(i),headers:{}},s=this._config.network.requestFilter;if(s){this._logger.debug("Apply request filter");try{a=s(At.LICENSE,o)}catch(e){a=Promise.reject(e)}}(a=a||Promise.resolve(o)).then((function(e){r.open("POST",e.url,!0);var t=!0;e.headers&&Object.entries(e.headers).forEach((function(e){var n=e[0],i=e[1];"string"==typeof i&&r.setRequestHeader(n,i),t&&(t="content-type"!==n.toLowerCase())})),"boolean"==typeof e.withCredentials&&(r.withCredentials=e.withCredentials),t&&r.setRequestHeader("Content-type","application/json"),n._logger.debug("Ready for license request"),r.onerror=function(){n._onError(M.Code.LICENSE_REQUEST_FAILED,{status:r.status,responseText:r.responseText})},n._licenseRequestTime=Date.now(),r.send(e.body)})).catch((function(e){n._errorCallback(new M(M.Severity.CRITICAL,M.Category.NETWORK,M.Code.REQUEST_FILTER_ERROR,e)),n.destroy()}))},t._onWebkitKeyAdded=function(){this._logger.debug("Decryption key was added to session")},t._onWebkitKeyError=function(e){this._logger.error("A decryption key error was encountered",e),this._retryLicenseRequest<=0&&this._onError(M.Code.LICENSE_REQUEST_FAILED,e.target.error),this._retryLicenseRequest--},t._licenseRequestLoaded=function(e){var t=this;this._logger.debug("License request loaded");var n=e.target;if(n.status>299)this._onError(M.Code.LICENSE_REQUEST_FAILED,{status:n.status,error:n.responseText});else{if(this._drmResponseCallback){var i=Date.now()-this._licenseRequestTime;this._drmResponseCallback({licenseTime:i/1e3,scheme:kt.FAIRPLAY})}var r,a=n.responseURL,o=n.response,s={url:a,originalUrl:this._config.licenseUrl,data:o,headers:Y.convertHeadersToDictionary(n.getAllResponseHeaders())};this._logger.debug("Apply response filter");try{r=this._config.network.responseFilter(At.LICENSE,s)}catch(e){r=Promise.reject(e)}(r=r||Promise.resolve(s)).then((function(e){t._keySession.update(e.data)})).catch((function(e){t._errorCallback(new M(M.Severity.CRITICAL,M.Category.NETWORK,M.Code.RESPONSE_FILTER_ERROR,e)),t.destroy()}))}},t._onError=function(e,t){this._errorCallback(new M(M.Severity.CRITICAL,M.Category.DRM,e,t))},e._validateResponse=function(e){return e.message&&e.message.indexOf("error")>0||null===e.reference||500===e.status_code?{valid:!1,details:"internal server error"}:""===e.ckc?{valid:!1,details:"ckc is missing"}:{valid:!0}},t._selectKeySystem=function(){var e=null;return window.WebKitMediaKeys.isTypeSupported("com.apple.fps.1_0","video/mp4")?e="com.apple.fps.1_0":this._logger.warn("Key System not supported"),e},e._extractContentId=function(t){var n=document.createElement("a");return n.href=e._arrayToString(t),n.hostname},e._arrayToString=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))},e._base64DecodeUint8Array=function(e){for(var t=window.atob(e),n=t.length,i=new Uint8Array(new ArrayBuffer(n)),r=0;r<n;r++)i[r]=t.charCodeAt(r);return i},e._concatInitDataIdAndCertificate=function(t,n,i){"string"==typeof n&&(n=e._stringToArray(n));var r=0,a=new ArrayBuffer(t.byteLength+4+n.byteLength+4+i.byteLength),o=new DataView(a);new Uint8Array(a,r,t.byteLength).set(t),r+=t.byteLength,o.setUint32(r,n.byteLength,!0),r+=4;var s=new Uint8Array(a,r,n.byteLength);return s.set(n),r+=s.byteLength,o.setUint32(r,i.byteLength,!0),r+=4,new Uint8Array(a,r,i.byteLength).set(i),new Uint8Array(a,0,a.byteLength)},e._stringToArray=function(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),i=0,r=e.length;i<r;i++)n[i]=e.charCodeAt(i);return n},e._base64EncodeUint8Array=function(e){for(var t,n,i,r,a,o,s,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",l=0;l<e.length;)r=(t=e[l++])>>2,a=(3&t)<<4|(n=l<e.length?e[l++]:Number.NaN)>>4,o=(15&n)<<2|(i=l<e.length?e[l++]:Number.NaN)>>6,s=63&i,isNaN(n)?o=s=64:isNaN(i)&&(s=64),u+=c.charAt(r)+c.charAt(a)+c.charAt(o)+c.charAt(s);return u},e}();function Nt(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return xt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function xt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Pt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Lt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Mt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Dt(Ot,"WebkitEvents",It),Ot.WebkitEvents=It;var Ut=function(e){var t,n;function i(t,n,r){var a;return i._logger.debug("Creating adapter"),Mt(Lt(a=e.call(this,t,n,r)||this),"_lastTimeUpdate",0),Mt(Lt(a),"_waitingEventTriggered",!1),Mt(Lt(a),"_segmentDuration",0),Mt(Lt(a),"_mediaErrorRecoveryAttempts",0),Mt(Lt(a),"_lastTimeDetach",NaN),Mt(Lt(a),"_startTimeAttach",NaN),Mt(Lt(a),"_nativeTextTracksMap",{}),Mt(Lt(a),"_captionsHidden",!1),Mt(Lt(a),"_seekRangeStart",0),a._config=V.mergeDeep({},Rt,a._config),a._progressiveSources=r.progressiveSources,a._liveEdge=0,a}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.canPlayType=function(e){var t=!1;return"string"==typeof e&&(t=!!i.TEST_VIDEO.canPlayType(e.toLowerCase())),i._logger.debug("canPlayType result for mimeType:"+e+" is "+t.toString()),t},i.canPlayDrm=function(e,t){i._drmProtocol=null;for(var n,r=Nt(i._drmProtocols);!(n=r()).done;){var a=n.value;if(a.isConfigured(e,t)){i._drmProtocol=a;break}}if(!i._drmProtocol)for(var o,s=Nt(i._drmProtocols);!(o=s()).done;){var c=o.value;c.canPlayDrm(e)&&(i._drmProtocol=c)}return!!i._drmProtocol},i.createAdapter=function(e,t,n){i._logger.debug("createAdapter");var r={displayTextTrack:!1,progressiveSources:[]};if(V.hasPropertyPath(n,"text.useNativeTextTrack")&&(r.displayTextTrack=V.getPropertyPath(n,"text.useNativeTextTrack")),V.hasPropertyPath(n,"sources.progressive")&&(r.progressiveSources=V.getPropertyPath(n,"sources.progressive")),V.hasPropertyPath(n,"text")&&(r.enableCEA708Captions=n.text.enableCEA708Captions,r.captionsTextTrack1Label=n.text.captionsTextTrack1Label,r.captionsTextTrack1LanguageCode=n.text.captionsTextTrack1LanguageCode,r.captionsTextTrack2Label=n.text.captionsTextTrack2Label,r.captionsTextTrack2LanguageCode=n.text.captionsTextTrack2LanguageCode),V.hasPropertyPath(n,"playback")&&V.hasPropertyPath(n.playback,"options.html5.native")&&V.mergeDeep(r,n.playback.options.html5.native),V.hasPropertyPath(n,"abr")){var a=n.abr;a.restrictions&&V.createPropertyPath(r,"abr.restrictions",a.restrictions)}return V.hasPropertyPath(n,"sources.options.isStartOverType")&&(r.isStartOverType=!0),r.network=n.network,new this(e,t,r)};var r,a,o,s=i.prototype;return s._dispatchErrorCallback=function(e){this._trigger(q.ERROR,e)},s._dispatchDRMLicenseLoaded=function(e){this._trigger(Q.DRM_LICENSE_LOADED,e)},s._maybeSetDrmPlayback=function(){var e=this;if(i._drmProtocol&&this._sourceObj&&this._sourceObj.drmData){var t={licenseUrl:"",certificate:"",network:this._config.network};i._drmProtocol.setDrmPlayback(t,this._sourceObj.drmData),this._drmHandler=new Ot(this._videoElement,t,(function(t){return e._dispatchErrorCallback(t)}),(function(t){return e._dispatchDRMLicenseLoaded(t)}))}},s._setProgressiveSource=function(){var e=function(e,t,n){var i=null;if(n&&e){for(var r,a=[],o=1/0,s=yt(e);!(r=s()).done;){var c=r.value,u=Math.abs(c.width-t);u<o?(o=u,a=[c]):u===o&&a.push(c)}for(var l=t/n,d=a,h=1/0,_=0,A=a;_<A.length;_++){var f=A[_];if(f.height){var g=Math.abs(f.width/f.height-l);g<h?(h=g,d=[f]):g===h&&d.push(f)}}for(var p=0,v=0,E=d;v<E.length;v++){var m=E[v];(m.bandwidth>p||!m.bandwidth)&&(p=m.bandwidth||p,i=m)}}return i}(this._progressiveSources,this._videoElement.offsetWidth,this._videoElement.offsetHeight);e&&(this._sourceObj=e)},s._isProgressivePlayback=function(){return!!this._sourceObj&&i._progressiveMimeTypes.includes(this._sourceObj.mimetype.toLowerCase())},s.load=function(e){var t=this;return this._wasCurrentTimeSetSuccessfully=!1,this._maybeSetDrmPlayback(),this._loadPromise||(this._loadPromise=new Promise((function(n,i){t._lastTimeUpdate=e||0;var r=t._startTimeAttach||e||0;t._loadPromiseReject=i,t._eventManager.listenOnce(t._videoElement,q.LOADED_DATA,(function(){return t._onLoadedData(n,r)})),t._eventManager.listenOnce(t._videoElement,q.PLAYING,(function(){return t._onPlaying(r)})),t._eventManager.listen(t._videoElement,q.TIME_UPDATE,(function(){return t._onTimeUpdate()})),t._eventManager.listen(t._videoElement,q.PLAY,(function(){return t._resetHeartbeatTimeout()})),t._eventManager.listen(t._videoElement,q.PAUSE,(function(){return t._clearHeartbeatTimeout()})),t._eventManager.listen(t._videoElement,q.ENDED,(function(){return t._clearHeartbeatTimeout()})),t._eventManager.listen(t._videoElement,q.ABORT,(function(){return t._clearHeartbeatTimeout()})),t._eventManager.listen(t._videoElement,q.SEEKED,(function(){return t._syncCurrentTime()})),t._eventManager.listen(t._videoElement,q.WAITING,(function(){return t._waitingEventTriggered=!0})),t._eventManager.listen(t._videoElement,q.PLAYING,(function(){return t._waitingEventTriggered=!1})),t._eventManager.listen(window,"focus",(function(){setTimeout((function(){f.isIOS&&(t._videoElement.currentTime=t._videoElement.currentTime>.1?t._videoElement.currentTime-.1:0),t._syncCurrentTime()}),1e3)})),t._isProgressivePlayback()&&t._setProgressiveSource(),t._sourceObj&&t._sourceObj.url?t._setSrc().then((function(){t._trigger(Q.ABR_MODE_CHANGED,{mode:t._isProgressivePlayback()?"manual":"auto"}),t._videoElement.load()})):t._videoElement.load()}))),this._loadPromise},s._handleDecodeError=function(e){var t=this;i._logger.debug("handleDecodeError",e);var n=this._videoElement.currentTime,r=this._getActivePKAudioTrack(),a=this._getActivePKTextTrack();this._videoElement.load(),this._eventManager.listenOnce(this._videoElement,q.PLAYING,(function(){t._mediaErrorRecoveryAttempts=0})),this._eventManager.listenOnce(this._videoElement,q.CAN_PLAY,(function(){i._logger.debug("CAN_PLAY"),t._videoElement.currentTime=n,t._videoElement.play(),t._videoElement.pause(),r&&t.selectAudioTrack(r),a?t.selectTextTrack(a):t.disableNativeTextTracks()}))},s.handleMediaError=function(e){return this._loadPromiseReject?(this._loadPromiseReject(new M(M.Severity.CRITICAL,M.Category.MEDIA,M.Code.NATIVE_ADAPTER_LOAD_FAILED,e)),!0):!!(e&&e.code===window.MediaError.MEDIA_ERR_DECODE&&(this._mediaErrorRecoveryAttempts++,this._mediaErrorRecoveryAttempts<=3))&&(this._handleDecodeError(e),!0)},s.attachMediaSource=function(){this._startTimeAttach=this._lastTimeDetach,this._lastTimeDetach=NaN},s.detachMediaSource=function(){this._lastTimeDetach=this._videoElement.currentTime,this._videoElement&&this._videoElement.src&&(j.setAttribute(this._videoElement,"src",""),j.removeAttribute(this._videoElement,"src")),this._loadPromise=null},s._setSrc=function(){var e,t=this,n={url:this._sourceObj?this._sourceObj.url:"",body:null,headers:{}};if("function"==typeof V.getPropertyPath(this._config,"network.requestFilter"))try{i._logger.debug("Apply request filter"),e=this._config.network.requestFilter(At.MANIFEST,n)}catch(t){e=Promise.reject(t)}return(e=e||Promise.resolve(n)).then((function(e){t._videoElement.src=e.url})).catch((function(e){t._trigger(q.ERROR,new M(M.Severity.CRITICAL,M.Category.NETWORK,M.Code.REQUEST_FILTER_ERROR,e))})),e},s._onPlaying=function(e){this.isLive()&&this._setStartTime(e)},s._onLoadedData=function(e,t){var n=this,r=function(){n._playerTracks=n._getParsedTracks(),n._addNativeAudioTrackChangeListener(),n._addNativeTextTrackChangeListener(),n._addNativeTextTrackAddedListener(),i._logger.debug("The source has been loaded successfully"),n._loadPromiseReject=null,e({tracks:n._playerTracks}),n.isLive()&&n._handleLiveDurationChange()};this._seekRangeStart=this._videoElement.seekable.length?this._videoElement.seekable.start(0):0,this.isLive()||this._setStartTime(t),this._videoElement.textTracks.length>0?r():this._eventManager.listenOnce(this._videoElement,q.CAN_PLAY,r.bind(this)),this._startTimeAttach=NaN},s._setStartTime=function(e){e>-1&&(this._videoElement.currentTime=e),this._wasCurrentTimeSetSuccessfully=!0},s._onTimeUpdate=function(){this._videoElement.paused||(this._videoElement.currentTime>this._lastTimeUpdate?(this._waitingEventTriggered&&(this._waitingEventTriggered=!1,this._trigger(q.PLAYING)),this._resetHeartbeatTimeout()):this._videoElement.currentTime<this._lastTimeUpdate?this._syncCurrentTime():(this._waitingEventTriggered=!0,this._trigger(q.WAITING))),this._handleVideoTracksChange()},s._syncCurrentTime=function(){this._lastTimeUpdate=this._videoElement.currentTime},s._resetHeartbeatTimeout=function(){var e=this;this._lastTimeUpdate=this._videoElement.currentTime,this._clearHeartbeatTimeout();this._heartbeatTimeoutId=setTimeout((function(){e._clearHeartbeatTimeout(),e._trigger(q.ERROR,new M(M.Severity.CRITICAL,M.Category.NETWORK,M.Code.TIMEOUT,"The player exceeded max buffer time of "+e._config.heartbeatTimeout+" ms. No progress has been done during this time."))}),this._config.heartbeatTimeout)},s._clearHeartbeatTimeout=function(){this._heartbeatTimeoutId&&(clearTimeout(this._heartbeatTimeoutId),this._heartbeatTimeoutId=null)},s._handleVideoTracksChange=function(){if(!this._isProgressivePlayback()){var e=this._videoElement,t=e.videoHeight,n=e.videoWidth,i=e.videoTracks;if(!this._videoDimensions||t!==this._videoDimensions.videoHeight||n!==this._videoDimensions.videoWidth){this._videoDimensions={videoHeight:t,videoWidth:n};var r={language:"",height:t,width:n,active:!0,index:Array.from(i).findIndex((function(e){return e.selected}))};this._onTrackChanged(new ce(r))}}},s.destroy=function(){var t=this;return i._logger.debug("destroy"),new Promise((function(n,i){e.prototype.destroy.call(t).then((function(){t._drmHandler&&t._drmHandler.destroy(),t._waitingEventTriggered=!1,t._progressiveSources=[],t._loadPromise=null,t._nativeTextTracksMap={},t._loadPromiseReject=null,t._liveEdge=0,t._lastTimeUpdate=0,t._lastTimeDetach=NaN,t._startTimeAttach=NaN,t._videoDimensions=null,t._clearHeartbeatTimeout(),t._liveDurationChangeInterval&&(clearInterval(t._liveDurationChangeInterval),t._liveDurationChangeInterval=null),n()}),(function(){return i}))}))},s._getParsedTracks=function(){var e=this._getParsedVideoTracks(),t=this._getParsedAudioTracks(),n=this._getParsedTextTracks();return e.concat(t).concat(n)},s._getParsedVideoTracks=function(){return this._isProgressivePlayback()?this._getParsedProgressiveVideoTracks():this._getParsedAdaptiveVideoTracks()},s._getParsedProgressiveVideoTracks=function(){var e=this._progressiveSources,t=[];if(e)for(var n=0;n<e.length;n++){var i={id:e[n].id,bandwidth:e[n].bandwidth,width:e[n].width,height:e[n].height,active:!!this._sourceObj&&e[n].id===this._sourceObj.id,index:n};t.push(new ce(i))}return t},s._getParsedAdaptiveVideoTracks=function(){var e=this._videoElement.videoTracks,t=[];if(e)for(var n=0;n<e.length;n++){var i={id:e[n].id,active:e[n].selected,label:e[n].label,language:e[n].language,index:n};t.push(new ce(i))}return t},s._getParsedAudioTracks=function(){var e=this._videoElement.audioTracks,t=[];if(e)for(var n=0;n<e.length;n++){var i={id:e[n].id,active:e[n].enabled,label:e[n].label,language:e[n].language,index:n};t.push(new ue(i))}return t},s._getParsedTextTracks=function(){var e=[this._config.captionsTextTrack1Label,this._config.captionsTextTrack2Label],t=[this._config.captionsTextTrack1LanguageCode,this._config.captionsTextTrack2LanguageCode],n=this._videoElement.textTracks,i=[];if(n){for(var r=0;r<n.length;r++)if(!tt.isExternalTrack(n[r])){var a={kind:n[r].kind,active:n[r].mode===tt.MODE.SHOWING,label:n[r].label,language:n[r].language,available:!0};if(a.kind===tt.KIND.SUBTITLES){var o=new tt(a);i.push(o),this._nativeTextTracksMap[o.index]=n[r]}else if(a.kind===tt.KIND.CAPTIONS&&this._config.enableCEA708Captions){a.label=a.label||e.shift(),a.language=a.language||t.shift(),a.available=this._captionsHidden;var s=new tt(a);i.push(s),this._nativeTextTracksMap[s.index]=n[r]}}this._captionsHidden||this._maybeShow708Captions()}return i},s._maybeShow708Captions=function(){var e=this,t=Array.from(this._videoElement.textTracks).filter((function(e){return e.kind===tt.KIND.CAPTIONS})),n=t.find((function(e){return e.mode===tt.MODE.SHOWING||e.mode===tt.MODE.HIDDEN}))||t[0];n&&(n.mode=tt.MODE.HIDDEN,this._captionsHidden=!0,this._eventManager.listenOnce(n,"cuechange",(function(){e._getPKTextTracks().forEach((function(e){return(e.available=!0)&&(e.mode=tt.MODE.DISABLED)})),e._trigger(Q.TRACKS_CHANGED,{tracks:e._playerTracks})})))},s.selectVideoTrack=function(e){this._isProgressivePlayback()?this._selectProgressiveVideoTrack(e):this.selectAdaptiveVideoTrack(e)},s._selectProgressiveVideoTrack=function(e){var t=this,n=this._progressiveSources;if(e instanceof ce&&n&&n[e.index]){var i=this._videoElement.currentTime,r=this._videoElement.paused;e.active=!0,this._sourceObj=n[e.index],this._eventManager.listenOnce(this._videoElement,q.LOADED_DATA,(function(){"Android Browser"===f.browser.name?(t._eventManager.listenOnce(t._videoElement,q.DURATION_CHANGE,(function(){t._videoElement.currentTime=i})),t._eventManager.listenOnce(t._videoElement,q.SEEKED,(function(){t._onTrackChanged(e),r&&t._videoElement.pause()})),t._videoElement.play()):(t._eventManager.listenOnce(t._videoElement,q.SEEKED,(function(){t._onTrackChanged(e)})),t._videoElement.currentTime=i,r||t._videoElement.play())})),this._setSrc()}},s.selectAdaptiveVideoTrack=function(e){var t=this._videoElement.videoTracks;e instanceof ce&&t&&t[e.index]&&(this._disableVideoTracks(),t[e.index].selected=!0,this._onTrackChanged(e))},s.selectAudioTrack=function(e){i._logger.debug("selectAudioTrack");var t=this._videoElement.audioTracks;e instanceof ue&&t&&t[e.index]&&(this._removeNativeAudioTrackChangeListener(),this._switchAudioTrack(e.index),this._onTrackChanged(e),this._addNativeAudioTrackChangeListener())},s._removeNativeAudioTrackChangeListener=function(){this._videoElement.audioTracks&&this._eventManager.unlisten(this._videoElement.audioTracks,"change")},s._addNativeAudioTrackChangeListener=function(){var e=this;this._videoElement.audioTracks&&this._eventManager.listen(this._videoElement.audioTracks,"change",(function(){return e._onNativeAudioTrackChange()}))},s._getPKAudioTracks=function(){return this._playerTracks.filter((function(e){return e instanceof ue}))},s._getActivePKAudioTrack=function(){return this._getPKAudioTracks().find((function(e){return!0===e.active}))},s._onNativeAudioTrackChange=function(){var e=this,t=function(){for(var t=0;t<e._videoElement.audioTracks.length;t++){if(e._videoElement.audioTracks[t].enabled)return t}return-1}(),n=this._getActivePKAudioTrack(),r=n?n.index:-1;if(t!==r){var a=this._getPKAudioTracks().find((function(e){return e.index===t}));a&&(i._logger.debug("Native selection of track, update the player audio track ("+r+" -> "+t+")"),this._onTrackChanged(a))}},s.selectTextTrack=function(e){if(e instanceof tt&&tt.isNativeTextTrack(e)){this._removeNativeTextTrackChangeListener();var t=this._nativeTextTracksMap[e.index];t&&(this.disableNativeTextTracks(),t.mode=this._getDisplayTextTrackModeString(),this._onTrackChanged(e),this._addNativeTextTrackChangeListener())}},s._removeNativeTextTrackChangeListener=function(){this._videoElement.textTracks&&this._eventManager.unlisten(this._videoElement.textTracks,"change")},s._addNativeTextTrackChangeListener=function(){var e=this;this._videoElement.textTracks&&this._eventManager.listen(this._videoElement.textTracks,"change",(function(){return e._onNativeTextTrackChange()}))},s._getPKTextTracks=function(){return this._playerTracks.filter((function(e){return e instanceof tt}))},s._getActivePKTextTrack=function(){return this._getPKTextTracks().find((function(e){return!0===e.active}))},s._onNativeTextTrackChange=function(){var e=this,t=this._getPKTextTracks(),n=t.find((function(e){return"off"===e.language})),r=function(){for(var t in e._nativeTextTracksMap)if(e._getDisplayTextTrackModeString()===e._nativeTextTracksMap[t].mode)return Number(t);return-1}(),a=this._getActivePKTextTrack(),o=a?a.index:-1;if(r!==o)if(-1==r)n&&(i._logger.debug("Native selection of track, update the player text track ("+o+" -> off)"),this._onTrackChanged(n));else{var s=t.find((function(e){return e.index===r}));s&&(i._logger.debug("Native selection of track, update the player text track ("+o+" -> "+r+")"),this._onTrackChanged(s))}},s._getDisplayTextTrackModeString=function(){return this._config.displayTextTrack?tt.MODE.SHOWING:tt.MODE.HIDDEN},s._addNativeTextTrackAddedListener=function(){var e=this;!this._config.displayTextTrack&&this._videoElement.textTracks&&this._eventManager.listen(this._videoElement.textTracks,"addtrack",(function(){return e._onNativeTextTrackAdded()}))},s._onNativeTextTrackAdded=function(){this._playerTracks=this._getParsedTracks(),this._trigger(Q.TRACKS_CHANGED,{tracks:this._playerTracks})},s.hideTextTrack=function(){this.disableNativeTextTracks()},s.enableAdaptiveBitrate=function(){i._logger.warn("Enabling adaptive bitrate is not supported for native playback")},s.isAdaptiveBitrateEnabled=function(){return!this._isProgressivePlayback()},s.applyABRRestriction=function(e){V.createPropertyPath(this._config,"abr.restrictions",e),this._maybeApplyAbrRestrictions(e)},s._maybeApplyAbrRestrictions=function(e){if(this._isProgressivePlayback()){var t=St(this._playerTracks.filter((function(e){return e instanceof ce})),e);!t.find((function(e){return e.active}))&&t.length?this.selectVideoTrack(t[0]):i._logger.warn("Invalid restrictions, there are not tracks within the restriction range")}},s._disableVideoTracks=function(){var e=this._videoElement.videoTracks;if(e)for(var t=0;t<e.length;t++)e[t].selected=!1},s._switchAudioTrack=function(e){i._logger.debug("_switchAudioTracks");var t=this._videoElement.audioTracks;if(t)for(var n=0;n<t.length;n++)t[n].enabled=n==e},s._getLiveEdge=function(){return this._videoElement.seekable.length?this._videoElement.seekable.end(this._videoElement.seekable.length-1):this._videoElement.buffered.length?this._videoElement.buffered.end(this._videoElement.buffered.length-1):this._videoElement.duration},s.seekToLiveEdge=function(){try{this._videoElement.currentTime=this._getLiveEdge()}catch(e){return}},s.getSegmentDuration=function(){return this._segmentDuration},s.isLive=function(){return this._videoElement.duration===1/0},s.isOnLiveEdge=function(){return!!this._wasCurrentTimeSetSuccessfully&&e.prototype.isOnLiveEdge.call(this)},s._handleLiveDurationChange=function(){var e=this;this._liveDurationChangeInterval=setInterval((function(){e._calculateSegmentDuration();var t=e._getLiveEdge();e._liveEdge!==t&&(e._liveEdge=t,e._videoElement.dispatchEvent(new window.Event(q.DURATION_CHANGE)))}),1e3)},s._calculateSegmentDuration=function(){if(0===this._videoElement.seekable.start(0)){var e=this._videoElement,t=e.buffered,n=e.seekable;t.length&&n.length&&(this._segmentDuration=(t.end(t.length-1)-n.end(n.length-1))/3)}else{var i=this._getLiveEdge();this._liveEdge&&this._liveEdge!==i&&(this._segmentDuration=i-this._liveEdge)}},s.getStartTimeOfDvrWindow=function(){return this.isLive()&&this._videoElement.seekable.length?this._config.isStartOverType?this._seekRangeStart:this._videoElement.seekable.start(0):0},s.getDrmInfo=function(){return this._drmHandler?this._drmHandler.getDrmInfo():null},r=i,(a=[{key:"liveDuration",get:function(){return this._getLiveEdge()}}])&&Pt(r.prototype,a),o&&Pt(r,o),i}(Tt);function Ft(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Mt(Ut,"id","NativeAdapter"),Mt(Ut,"_logger",Tt.getLogger(Ut.id)),Mt(Ut,"TEST_VIDEO",j.createElement("video")),Mt(Ut,"_drmProtocols",[Ct]),Mt(Ut,"_drmProtocol",null),Mt(Ut,"_progressiveMimeTypes",["video/mp4","audio/mp3"]);var Bt=function(){function e(){}return e.register=function(t){t&&(e._mediaSourceAdapters.includes(t)?e._logger.debug("Adapter <"+t.id+"> is already registered, do not register again"):(e._logger.debug("Adapter <"+t.id+"> has been registered successfully"),e._mediaSourceAdapters.push(t)))},e.unRegister=function(t){var n=e._mediaSourceAdapters.indexOf(t);n>-1&&(e._logger.debug("Unregistered <"+t.id+"> adapter"),e._mediaSourceAdapters.splice(n,1))},e.canPlaySource=function(t,n,i){void 0===n&&(n=!0),e._orderMediaSourceAdapters(n);var r=e._mediaSourceAdapters;if(t&&t.mimetype)for(var a=0;a<r.length;a++)if(r[a].canPlayType(t.mimetype)&&(!t.drmData||r[a].canPlayDrm(t.drmData,i)))return e._selectedAdapter=r[a],e._logger.debug("Selected adapter is <"+e._selectedAdapter.id+">"),!0;return!1},e._orderMediaSourceAdapters=function(t){e._mediaSourceAdapters=e._mediaSourceAdapters.filter((function(e){return"NativeAdapter"!==e.id})),t?e._mediaSourceAdapters.unshift(Ut):e._mediaSourceAdapters.push(Ut)},e.getMediaSourceAdapter=function(t,n,i){return t&&n&&i?(e._selectedAdapter||e.canPlaySource(n,!0,i.drm),e._selectedAdapter?e._selectedAdapter.createAdapter(t,n,i):null):null},e.destroy=function(){e._selectedAdapter=null},e}();Ft(Bt,"_logger",C("MediaSourceProvider")),Ft(Bt,"_mediaSourceAdapters",[Ut]),Ft(Bt,"_selectedAdapter",null);var Ht=Bt.register,Vt=function(e,t,n,i,r){this.startTime=e,this.endTime=t,this.id=n,this.type=i,this.metadata=r};function Gt(e){try{var t=e.startTime,n=e.endTime,i=e.id,r=e.type,a=e.metadata,o={};window.VTTCue?o=new window.VTTCue(t,n,""):window.TextTrackCue&&(o=new window.TextTrackCue(t,n,""));var s={key:r,data:a};return o.id=i,o.value=s,o}catch(e){return null}}function jt(e){if(e){var t=e.startTime,n=e.endTime,i=e.id;if(Yt(e)){var r=Yt(e),a=r.type,o=r.metadata;return new Vt(t,n,i,a,o)}}return null}function Yt(e){if(e){var t=e.type,n=e.value,i=e.track;if(n){var r=n.key,a=n.data,o="org.id3"===t||"id3"===(i&&i.label),s=Object.values(Vt.TYPE).find((function(e){return e===r}));return s||(s=o?Vt.TYPE.ID3:Vt.TYPE.CUSTOM),{type:s,metadata:o||!a?n:a}}}return null}Vt.TYPE={ID3:"id3",EMSG:"emsg",CUE_POINT:"cuepoint",CUSTOM:"custom"};var Wt,Kt,zt=n(3);function Xt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var qt=(Kt=Wt=function(){function e(){}return e.runCapability=function(){e._capabilities.autoplay||"boolean"==typeof e._capabilities.autoplay&&"boolean"==typeof e._capabilities.mutedAutoPlay?e._playPromiseResult=Promise.resolve(e._capabilities):(e._vid||(e._vid=j.createElement("video"),e._vid.src=zt.a,e._vid.setAttribute("playsinline","")),e._playPromiseResult=new Promise((function(t){e._setMuted(!1),e._getPlayPromise().then((function(){return t({autoplay:!0,mutedAutoPlay:!0})})).catch((function(){e._setMuted(!0),e._getPlayPromise().then((function(){return t({autoplay:!1,mutedAutoPlay:!0})})).catch((function(){return t({autoplay:!1,mutedAutoPlay:!1})}))}))})))},e.getCapability=function(){return e._playPromiseResult.then((function(t){var n;return t.autoplay?n=Promise.resolve(t):(e.runCapability(),n=e._playPromiseResult),n.then((function(t){return V.mergeDeep(t,e._capabilities)}))}))},e.setCapabilities=function(t){e._logger.debug("Set player capabilities",t);var n=t.autoplay,i=t.mutedAutoPlay;"boolean"==typeof n&&(e._capabilities.autoplay=n),"boolean"==typeof i&&(e._capabilities.mutedAutoPlay=i)},e._getPlayPromise=function(){return e._vid.play()||e._forcePromiseReturnValue()},e._setMuted=function(t){t?(e._vid.muted=!0,e._vid.setAttribute("muted","")):(e._vid.muted=!1,e._vid.removeAttribute("muted"))},e._forcePromiseReturnValue=function(){return new Promise((function(t,n){e._vid.addEventListener(q.ERROR,(function(){n()}));var i=setTimeout((function(){e._logger.debug("Timeout 500 ms has been reached"),n()}),500);!0===e._vid.paused?(clearTimeout(i),n()):(clearTimeout(i),t())}))},e}(),Xt(Wt,"_logger",C("Html5AutoPlayCapability")),Xt(Wt,"_capabilities",{}),Kt);function Qt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $t=function(e){var t,n;function i(t,n,r){var a;return Zt(Qt(a=e.call(this)||this),"_droppedFramesInterval",null),Zt(Qt(a),"_lastDroppedFrames",0),Zt(Qt(a),"_lastDecodedFrames",0),Zt(Qt(a),"_lastTime",0),Zt(Qt(a),"_currentBitrate",0),a._eventManager=new x,a._mediaSourceAdapter=t,a._config=n,a._videoElement=r,a._mediaSourceAdapter.capabilities.fpsControl?(a._eventManager.listen(a._mediaSourceAdapter,Q.FPS_DROP,(function(e){return a._triggerFPSDrop(e.payload.data)})),Qt(a)):(-1===a._getDroppedAndDecodedFrames()[0]?i._logger.debug("Dropped frame watcher is not supported"):a._config.capLevelOnFPSDrop?(i._logger.debug("Initialized capLevelOnFPSDrop = true"),a._init()):i._logger.debug("Not Initialized"),a)}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r=i.prototype;return r._init=function(){var e=this;this._eventManager.listen(this._mediaSourceAdapter,Q.VIDEO_TRACK_CHANGED,(function(t){return e._currentBitrate=t.payload.selectedVideoTrack.bandwidth})),this._droppedFramesInterval=setInterval((function(){return e._checkFPS()}),this._config.fpsDroppedFramesInterval)},r._triggerFPSDrop=function(e){this.dispatchEvent(new E(Q.FPS_DROP,e))},r._getDroppedAndDecodedFrames=function(){if("function"==typeof this._videoElement.getVideoPlaybackQuality){var e=this._videoElement.getVideoPlaybackQuality();return[e.droppedVideoFrames,e.totalVideoFrames]}return"number"==typeof this._videoElement.webkitDroppedFrameCount&&"number"==typeof this._videoElement.webkitDecodedFrameCount?[this._videoElement.webkitDroppedFrameCount,this._videoElement.webkitDecodedFrameCount]:[-1,-1]},r._checkFPS=function(){var e=this._getDroppedAndDecodedFrames(),t=e[0],n=e[1];try{var r=performance.now();if(n){if(this._lastTime){var a=r-this._lastTime,o=t-this._lastDroppedFrames,s=n-this._lastDecodedFrames,c=1e3*o/a;c>0&&(i._logger.debug("checkFPS : droppedFPS/decodedFPS:"+c/(1e3*s/a)),o>this._config.fpsDroppedMonitoringThreshold*s&&(this._mediaSourceAdapter.setMaxBitrate(this._currentBitrate-1),this._triggerFPSDrop({currentDropped:o,currentDecoded:s,totalDroppedFrames:c})))}this._lastTime=r,this._lastDroppedFrames=t,this._lastDecodedFrames=n}}catch(e){i._logger.error("Error occur while trying to check dropFrames: ",e)}},r.destroy=function(){this._droppedFramesInterval&&clearInterval(this._droppedFramesInterval),this._droppedFramesInterval=null,this._eventManager.destroy()},i}(R);function Jt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function en(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Zt($t,"_logger",C("droppedFramesWatcher"));var tn=function(e){var t,n;function i(t,n,i){var r;return en(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r=e.call(this)||this),"_reset",!1),r._eventManager=new x,r._canLoadMediaSourceAdapterPromise=Promise.resolve(),r._createVideoElement(i),r._init(t,n),r}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.isSupported=function(){try{var e=j.createElement("video");return e.volume=.5,!!e.canPlayType}catch(e){return!1}},i.createEngine=function(e,t,n){return new this(e,t,n)},i.canPlaySource=function(e,t,n){return Bt.canPlaySource(e,t,n)},i.runCapabilities=function(){i._capabilities.forEach((function(e){return e.runCapability()}))},i.getCapabilities=function(){var e=[];return i._capabilities.forEach((function(t){return e.push(t.getCapability())})),Promise.all(e).then((function(e){var t,n={};return e.forEach((function(e){return Object.assign(n,e)})),(t={})[i.id]=n,t}))},i.setCapabilities=function(e){i._capabilities.forEach((function(t){return t.setCapabilities(e)}))},i.prepareVideoElement=function(e){if(!i.videoElementStore[e]){i._logger.debug("Create the video element for playing "+e);var t=j.createElement("video");i.videoElementStore[e]=t}i._logger.debug("Prepare the video element for playing "+e),i.videoElementStore[e].load()};var r,a,o,s=i.prototype;return s.restore=function(e,t){this.reset(),this._init(e,t)},s.reset=function(){var e=this;this._reset||(this._reset=!0,this._eventManager.removeAll(),this._droppedFramesWatcher&&(this._droppedFramesWatcher.destroy(),this._droppedFramesWatcher=null),this._canLoadMediaSourceAdapterPromise=new Promise((function(t,n){var i=e._mediaSourceAdapter?e._mediaSourceAdapter.destroy():Promise.resolve();e._el&&e._el.src?i.then((function(){j.setAttribute(e._el,"src",""),j.removeAttribute(e._el,"src"),t()}),n):i.then(t,n)})),this._mediaSourceAdapter=null)},s.destroy=function(){this.detach(),this._el&&(this.pause(),j.removeAttribute(this._el,"src"),j.removeChild(this._el.parentNode,this._el)),this._eventManager.destroy(),Bt.destroy(),this._droppedFramesWatcher&&(this._droppedFramesWatcher.destroy(),this._droppedFramesWatcher=null),this._mediaSourceAdapter&&(this._mediaSourceAdapter.destroy(),this._mediaSourceAdapter=null)},s.attachMediaSource=function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.attachMediaSource()},s.detachMediaSource=function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.detachMediaSource()},s.attach=function(){var e=this;Object.keys(q).forEach((function(t){[q.ERROR,q.WAITING].includes(q[t])||e._eventManager.listen(e._el,q[t],(function(){return e.dispatchEvent(new E(q[t]))}))})),this._eventManager.listen(this._el,q.ERROR,(function(){return e._handleVideoError()})),this._eventManager.listen(this._el,q.WAITING,(function(){return e._handleWaiting()})),this._handleMetadataTrackEvents(),this._eventManager.listen(this._el.textTracks,"addtrack",(function(t){tt.isNativeTextTrack(t.track)&&e.dispatchEvent(new E(Q.TEXT_TRACK_ADDED,{track:t.track}))}));var t=this._mediaSourceAdapter;t&&(this._eventManager.listen(t,Q.VIDEO_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,Q.AUDIO_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,Q.TEXT_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,Q.IMAGE_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,Q.ABR_MODE_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,Q.TEXT_CUE_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,Q.TRACKS_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,Q.FRAG_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,Q.DRM_LICENSE_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,Q.MANIFEST_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,q.ERROR,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,q.TIME_UPDATE,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,q.PLAYING,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,q.WAITING,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,Q.MEDIA_RECOVERED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,Q.TIMED_METADATA_ADDED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,"hlsFragParsingMetadata",(function(t){return e.dispatchEvent(t)})),this._droppedFramesWatcher&&this._eventManager.listen(this._droppedFramesWatcher,Q.FPS_DROP,(function(t){return e.dispatchEvent(t)})))},s.detach=function(){var e=this;Object.keys(q).forEach((function(t){e._eventManager.unlisten(e._el,q[t])})),this._mediaSourceAdapter&&(this._eventManager.unlisten(this._mediaSourceAdapter,Q.VIDEO_TRACK_CHANGED),this._eventManager.unlisten(this._mediaSourceAdapter,Q.AUDIO_TRACK_CHANGED),this._eventManager.unlisten(this._mediaSourceAdapter,Q.TEXT_TRACK_CHANGED),this._eventManager.unlisten(this._mediaSourceAdapter,Q.TEXT_CUE_CHANGED))},s.getVideoElement=function(){return this._el},s.selectVideoTrack=function(e){this._mediaSourceAdapter&&this._mediaSourceAdapter.selectVideoTrack(e)},s.selectAudioTrack=function(e){this._mediaSourceAdapter&&this._mediaSourceAdapter.selectAudioTrack(e)},s.selectTextTrack=function(e){this._removeCueChangeListeners(),this._mediaSourceAdapter&&this._mediaSourceAdapter.selectTextTrack(e),this.resetAllCues(),this._addCueChangeListener()},s.selectImageTrack=function(e){this._mediaSourceAdapter&&this._mediaSourceAdapter.selectImageTrack(e)},s.hideTextTrack=function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.hideTextTrack(),this._removeCueChangeListeners()},s.enableAdaptiveBitrate=function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.enableAdaptiveBitrate()},s.isAdaptiveBitrateEnabled=function(){return!!this._mediaSourceAdapter&&this._mediaSourceAdapter.isAdaptiveBitrateEnabled()},s.applyABRRestriction=function(e){if(this._mediaSourceAdapter)return this._mediaSourceAdapter.applyABRRestriction(e)},s.seekToLiveEdge=function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.seekToLiveEdge()},s.isOnLiveEdge=function(){return!!this._mediaSourceAdapter&&this._mediaSourceAdapter.isOnLiveEdge()},s.getStartTimeOfDvrWindow=function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.getStartTimeOfDvrWindow():0},s.isLive=function(){return!!this._mediaSourceAdapter&&this._mediaSourceAdapter.isLive()},s.play=function(){var e=this,t=this._el.play();return t&&t.catch((function(t){return e.dispatchEvent(new E(Q.PLAY_FAILED,{error:t}))})),t},s.pause=function(){return this._el.pause()},s.load=function(e){var t=this;return this._el.load(),this._canLoadMediaSourceAdapterPromise.then((function(){return t._mediaSourceAdapter?t._mediaSourceAdapter.load(e):Promise.resolve({})})).catch((function(e){return t.dispatchEvent(new E(q.ERROR,e)),Promise.reject(e)}))},s.enterPictureInPicture=function(){var e=this;try{document.pictureInPictureEnabled&&"function"==typeof this._el.requestPictureInPicture?this._el.requestPictureInPicture().catch((function(t){e.dispatchEvent(new E(q.ERROR,new M(M.Severity.RECOVERABLE,M.Category.PLAYER,M.Code.ENTER_PICTURE_IN_PICTURE_FAILED,t)))})):"function"==typeof this._el.webkitSetPresentationMode&&(this._el.webkitSetPresentationMode("picture-in-picture"),setTimeout((function(){return e.dispatchEvent(new E(q.ENTER_PICTURE_IN_PICTURE))}),0))}catch(e){this.dispatchEvent(new E(q.ERROR,new M(M.Severity.RECOVERABLE,M.Category.PLAYER,M.Code.ENTER_PICTURE_IN_PICTURE_FAILED,e)))}},s.exitPictureInPicture=function(){var e=this;try{document.pictureInPictureEnabled&&"function"==typeof document.exitPictureInPicture&&this._el===document.pictureInPictureElement?document.exitPictureInPicture().catch((function(t){e.dispatchEvent(new E(q.ERROR,new M(M.Severity.RECOVERABLE,M.Category.PLAYER,M.Code.EXIT_PICTURE_IN_PICTURE_FAILED,t)))})):"function"==typeof this._el.webkitSetPresentationMode&&this._el.webkitSetPresentationMode("inline")}catch(e){this.dispatchEvent(new E(q.ERROR,new M(M.Severity.RECOVERABLE,M.Category.PLAYER,M.Code.EXIT_PICTURE_IN_PICTURE_FAILED,e)))}},s.isPictureInPictureSupported=function(){return"function"==typeof this._el.webkitSupportsPresentationMode?this._el.webkitSupportsPresentationMode("picture-in-picture"):!!document.pictureInPictureEnabled},s.getThumbnail=function(e){if(this._mediaSourceAdapter)return this._mediaSourceAdapter.getThumbnail(e)},s._init=function(e,t){this._config=t,this._reset=!1,this._loadMediaSourceAdapter(e),this.attach()},s._createVideoElement=function(e){this._el=i.videoElementStore[e]||j.createElement("video"),this._el.id=G.uniqueId(5),this._el.controls=!1},s._loadMediaSourceAdapter=function(e){this._mediaSourceAdapter=Bt.getMediaSourceAdapter(this.getVideoElement(),e,this._config),this._mediaSourceAdapter&&(this._droppedFramesWatcher=new $t(this._mediaSourceAdapter,this._config.abr,this._el))},s._addCueChangeListener=function(){var e=this,t=Array.from(this._el.textTracks).find((function(e){return tt.isNativeTextTrack(e)&&e.mode!==tt.MODE.DISABLED}));t&&this._eventManager.listen(t,"cuechange",(function(t){return e._onCueChange(t)}))},s._removeCueChangeListeners=function(){var e=this;Array.from(this._el.textTracks).filter((function(e){return!tt.isMetaDataTrack(e)})).forEach((function(t){e._eventManager.unlisten(t,"cuechange")}))},s._onCueChange=function(e){var t=et(e.currentTarget.activeCues);this.dispatchEvent(new E(Q.TEXT_CUE_CHANGED,{cues:t}))},s.resetAllCues=function(){var e=Array.from(this._el.textTracks).find((function(e){return tt.isNativeTextTrack(e)&&e.mode!==tt.MODE.DISABLED}));if(e)for(var t=0;t<e.cues.length;t++)e.cues[t].hasBeenReset=!0},s._handleVideoError=function(){if(this._el.error){var e=this._el.error.code;if(e!==window.MediaError.MEDIA_ERR_ABORTED){var t=this._getMsExtendedError(),n=this._el.error.message;if(this._mediaSourceAdapter&&!this._mediaSourceAdapter.handleMediaError(this._el.error)){var i=new M(M.Severity.CRITICAL,M.Category.MEDIA,M.Code.VIDEO_ERROR,{code:e,extended:t,message:n});this.dispatchEvent(new E(q.ERROR,i))}}}},s._handleWaiting=function(){var e=this,t=!1;this._eventManager.listenOnce(this._el,q.PLAYING,(function(){return t=!0})),setTimeout((function(){t||e.dispatchEvent(new E(q.WAITING))}),200)},s._getMsExtendedError=function(){var e=this._el.error.msExtendedCode;return e&&(e<0&&(e+=Math.pow(2,32)),e=e.toString(16)),e},s._handleMetadataTrackEvents=function(){var e=this,t=function(t){t.mode=tt.MODE.HIDDEN,e._eventManager.listen(t,"cuechange",(function(){var t=[];Array.from(e._el.textTracks).forEach((function(e){tt.isMetaDataTrack(e)&&(t=t.concat(et(e.activeCues)))})),t=t.sort((function(e,t){return e.startTime-t.startTime})),e.dispatchEvent(new E(Q.TIMED_METADATA,{cues:t})),e.dispatchEvent(new E(Q.TIMED_METADATA_CHANGE,{cues:t.map((function(e){return jt(e)}))}))}))};Array.from(this._el.textTracks).forEach((function(e){tt.isMetaDataTrack(e)&&t(e)})),this._eventManager.listen(this._el.textTracks,"addtrack",(function(e){tt.isMetaDataTrack(e.track)&&t(e.track)})),this._eventManager.listen(this._el.textTracks,"change",(function(){Array.from(e._el.textTracks).forEach((function(e){tt.isMetaDataTrack(e)&&e.mode!==tt.MODE.HIDDEN&&(e.mode=tt.MODE.HIDDEN)}))}))},s.addTextTrack=function(e,t,n){return this._el.addTextTrack(e,t,n)},s.getNativeTextTracks=function(){return Array.from(this._el.textTracks)},s.getDrmInfo=function(){var e;return null==(e=this._mediaSourceAdapter)?void 0:e.getDrmInfo()},r=i,(a=[{key:"id",get:function(){return i.id}},{key:"src",set:function(e){this._mediaSourceAdapter&&(this._mediaSourceAdapter.src=e)},get:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.src:""}},{key:"currentTime",get:function(){return this._el?this._el.currentTime:0},set:function(e){this._el&&(this._el.currentTime=e)}},{key:"duration",get:function(){return this._el.duration}},{key:"liveDuration",get:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.liveDuration:-1}},{key:"volume",set:function(e){this._el.volume=e},get:function(){return this._el.volume}},{key:"paused",get:function(){return this._el.paused}},{key:"seeking",get:function(){return this._el.seeking}},{key:"seekable",get:function(){return this._el.seekable}},{key:"played",get:function(){return this._el.played}},{key:"buffered",get:function(){return this._el.buffered}},{key:"muted",set:function(e){this._el.muted=e},get:function(){return this._el.muted}},{key:"defaultMuted",get:function(){return this._el.defaultMuted}},{key:"poster",set:function(e){this._el.poster=e},get:function(){return this._el.poster}},{key:"preload",set:function(e){this._el.preload=e},get:function(){return this._el.preload}},{key:"autoplay",set:function(e){this._el.autoplay=e},get:function(){return this._el.autoplay}},{key:"loop",set:function(e){this._el.loop=e},get:function(){return this._el.loop}},{key:"controls",set:function(e){this._el.controls=e},get:function(){return this._el.controls}},{key:"playbackRate",set:function(e){this._el.playbackRate=e},get:function(){return this._el.playbackRate}},{key:"defaultPlaybackRate",set:function(e){this._el.defaultPlaybackRate=e},get:function(){return this._el.defaultPlaybackRate}},{key:"ended",get:function(){return this._el.ended}},{key:"error",get:function(){return this._el.error}},{key:"networkState",get:function(){return this._el.networkState}},{key:"readyState",get:function(){return this._el.readyState}},{key:"videoHeight",get:function(){return this._el.videoHeight}},{key:"videoWidth",get:function(){return this._el.videoWidth}},{key:"playsinline",set:function(e){e?this._el.setAttribute("playsinline",""):this._el.removeAttribute("playsinline")},get:function(){return""===this._el.getAttribute("playsinline")}},{key:"crossOrigin",set:function(e){"string"==typeof e?this._el.setAttribute("crossorigin",e):this._el.removeAttribute("crossorigin")},get:function(){return this._el.getAttribute("crossorigin")}},{key:"playbackRates",get:function(){return i.PLAYBACK_RATES}},{key:"isInPictureInPicture",get:function(){return!!document.pictureInPictureElement&&null!=document.pictureInPictureElement&&this._el===document.pictureInPictureElement||!!this._el.webkitPresentationMode&&"picture-in-picture"===this._el.webkitPresentationMode}},{key:"targetBuffer",get:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.targetBuffer:NaN}},{key:"availableBuffer",get:function(){var e=0;if(this.buffered)for(var t=0;t<this.buffered.length;t++)this.buffered.start(t)<=this._el.currentTime&&this._el.currentTime<=this.buffered.end(t)&&(e=this.buffered.end(t)-this._el.currentTime);return e}}])&&Jt(r.prototype,a),o&&Jt(r,o),i}(R);function nn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}en(tn,"_logger",C("Html5")),en(tn,"_capabilities",[qt]),en(tn,"id","html5"),en(tn,"videoElementStore",{}),en(tn,"PLAYBACK_RATES",[.5,1,1.5,2]);var rn=function(){function e(){}return e.register=function(t,n){t&&!e._engineProviders[t]?(e._logger.debug("Engine <"+t+"> has been registered successfully"),e._engineProviders[t]=n):e._logger.debug("Engine <"+t+"> is already registered, do not register again")},e.unRegister=function(t){e._engineProviders[t]&&(e._logger.debug("Unregistered <"+t+"> Engine"),delete e._engineProviders[t])},e.getEngines=function(){return Object.keys(e._engineProviders).map((function(t){return e._engineProviders[t]}))},e.destroy=function(){e._engineProviders={}},e}();nn(rn,"_logger",C("EngineProvider")),nn(rn,"_engineProviders",{}),tn.isSupported()&&rn.register(tn.id,tn);var an=rn.register,on=rn.unRegister;function sn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var un=1,ln=2,dn=3,hn="srt",_n="vtt",An=function(e){var t,n;function i(t){var n;return cn(sn(n=e.call(this)||this),"_externalCueIndex",0),cn(sn(n),"_textTrackModel",{}),cn(sn(n),"_activeTextCues",[]),cn(sn(n),"_isTextTrackActive",!1),cn(sn(n),"_lastTimeUpdate",0),n._player=t,n._eventManager=new x,n}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r=i.prototype;return r.hideTextTrack=function(){this._player.config.text.useNativeTextTrack?(this._removeCueChangeListeners(),this._resetExternalNativeTextTrack()):this._isTextTrackActive&&(this._eventManager.unlisten(this._player,q.TIME_UPDATE),this.dispatchEvent(new E(Q.TEXT_CUE_CHANGED,{cues:[]})),this._resetCurrentTrack())},r.getExternalTracks=function(e){var t=this,n=this._player.sources.captions;if(!n)return[];this._player.config.text.useNativeTextTrack&&this._addNativeTextTrack();var i=e.filter((function(e){return e instanceof tt})),r=[];return n.forEach((function(e){if(e.language){var n=t._createTextTrack(e);t._maybeAddTrack(n,e,i,r)}else{var a=new M(M.Severity.RECOVERABLE,M.Category.TEXT,M.Code.UNKNOWN_LANGUAGE,{caption:e});t.dispatchEvent(new E(q.ERROR,a))}})),r},r._maybeAddTrack=function(e,t,n,r){var a=n.find((function(e){return e.available&&oe.langComparer(t.language,e.language)}));a?i._logger.warn("duplicated language, taking the inband option. Language: ",a.language):(r.push(e),this._updateTextTracksModel(t))},r._createTextTrack=function(e){return new tt({active:!!e.default,kind:tt.KIND.SUBTITLES,label:e.label,language:e.language,external:!0})},r._updateTextTracksModel=function(e){this._textTrackModel[e.language]={cuesStatus:un,cues:[],url:e.url,type:e.type}},r.selectTextTrack=function(e){var t=this;this._textTrackModel[e.language]&&(this._textTrackModel[e.language].cuesStatus===dn?this._selectTextTrack(e):this._textTrackModel[e.language].cuesStatus===un&&this._downloadAndParseCues(e).then((function(){t._textTrackModel[e.language].cuesStatus=dn,t._selectTextTrack(e)})).catch((function(e){return t.dispatchEvent(new E(q.ERROR,e))})))},r._selectTextTrack=function(e){this.hideTextTrack(),this._player.config.text.useNativeTextTrack?(this._addCuesToNativeTextTrack(this._textTrackModel[e.language].cues),this._addCueChangeListener()):this._setTextTrack(e),e.active=!0,this.dispatchEvent(new E(Q.TEXT_TRACK_CHANGED,{selectedTextTrack:e}))},r.resetAllCues=function(){for(var e in this._textTrackModel)this._textTrackModel[e].cues.forEach((function(e){e.hasBeenReset=!0}))},r._addCueChangeListener=function(){var e=this,t=this._player.getVideoElement();if(t&&t.textTracks){var n=Array.from(t.textTracks).find((function(e){return tt.isNativeTextTrack(e)&&e.mode===tt.MODE.SHOWING}));n&&this._eventManager.listen(n,"cuechange",(function(t){return e._onCueChange(t)}))}},r._removeCueChangeListeners=function(){var e=this._player.getVideoElement();if(e&&e.textTracks)for(var t=0;t<e.textTracks.length;t++)this._eventManager.unlisten(e.textTracks[t],"cuechange")},r._onCueChange=function(e){var t=et(e.currentTarget.activeCues);this.dispatchEvent(new E(Q.TEXT_CUE_CHANGED,{cues:t}))},r.reset=function(){this._resetCurrentTrack(),this._textTrackModel={},this._resetExternalNativeTextTrack(),this._eventManager.removeAll()},r.destroy=function(){this._textTrackModel={},this._eventManager.destroy(),this._activeTextCues=[]},r._resetCurrentTrack=function(){this._activeTextCues=[],this._isTextTrackActive=!1,this._maybeSetExternalCueIndex()},r._getCuesString=function(e){var t=this;return new Promise((function(n,i){var r=t._textTrackModel[e.language],a=r.type||t._getFileType(r.url);[hn,_n].includes(a)||(t._textTrackModel[e.language].cuesStatus=un,i(new M(M.Severity.RECOVERABLE,M.Category.TEXT,M.Code.UNKNOWN_FILE_TYPE,{captionType:a}))),Y.execute(r.url,{},"GET").then((function(e){n(a===hn?t._convertSrtToVtt(e):e)})).catch((function(){t._textTrackModel[e.language].cuesStatus=un,i(new M(M.Severity.RECOVERABLE,M.Category.TEXT,M.Code.HTTP_ERROR,{url:r.url}))}))}))},r._parseCues=function(e){return new Promise((function(t,n){var r=new Pe(window,Le()),a=[];r.oncue=function(e){return a.push(e)},r.onflush=function(){i._logger.debug("finished parsing external cues"),t(a)},r.parse(e),r.flush(),r.onparsingerror((function(e){return n(e)}))}))},r._convertSrtToVtt=function(e){return"WEBVTT\n\n"+e.replace(/(\d\d:\d\d:\d\d),(\d\d\d) --> (\d\d:\d\d:\d\d),(\d\d\d)/g,(function(e,t,n,i,r){return t+"."+n+" --\x3e "+i+"."+r}))},r._downloadAndParseCues=function(e){var t=this;return this._textTrackModel[e.language].cuesStatus=ln,new Promise((function(n,i){t._getCuesString(e).then((function(e){return t._parseCues(e)})).then((function(i){t._textTrackModel[e.language].cues=i,n()})).catch((function(e){return i(e)}))}))},r._getFileType=function(e){return e.split(/[#?]/)[0].split(".").pop().trim()},r._handleCaptionOnTimeUpdate=function(e){var t=this._player.currentTime;if(t){var n=!1;this._hadSeeked()&&(this._activeTextCues=[],n=this._maybeSetExternalCueIndex());var i=this._maybeRemoveActiveCues(),r=this._maybeAddToActiveCues(e);(n||r||i)&&this.dispatchEvent(new E(Q.TEXT_CUE_CHANGED,{cues:this._activeTextCues})),this._lastTimeUpdate=t}},r._hadSeeked=function(){return!!this._player.currentTime&&Math.abs(this._player.currentTime-this._lastTimeUpdate)>1},r._maybeRemoveActiveCues=function(){var e=this._player.currentTime;if(!e)return!1;var t=this._activeTextCues.filter((function(t){return t.startTime<e&&e<t.endTime})),n=this._activeTextCues.length!==t.length;return this._activeTextCues=t,n},r._maybeAddToActiveCues=function(e){var t=this._player.currentTime;if(!t)return!1;for(var n=!1,i=this._textTrackModel[e.language].cues;this._externalCueIndex<i.length&&t>i[this._externalCueIndex].startTime;)t<i[this._externalCueIndex].endTime&&this._activeTextCues.push(i[this._externalCueIndex]),this._externalCueIndex++,n=!0;return n},r._maybeSetExternalCueIndex=function(){var e=this._player._getTextTracks().find((function(e){return e.active&&e.external}));if(e&&e.external){for(var t=this._textTrackModel[e.language]?this._textTrackModel[e.language].cues:[],n=0;n<t.length&&!(t[n].startTime<this._player.currentTime&&this._player.currentTime<t[n].endTime)&&!(t[n].endTime>this._player.currentTime&&t[n].startTime>this._player.currentTime);n++);return this._externalCueIndex=n,!0}return!1},r._resetExternalNativeTextTrack=function(){var e=this._player.getVideoElement();if(e&&e.textTracks){var t=Array.from(e.textTracks).find((function(e){return!!e&&tt.isExternalTrack(e)}));t&&(t.cues&&Object.values(t.cues).forEach((function(e){return t.removeCue(e)})),t.mode=tt.MODE.DISABLED)}},r._addCuesToNativeTextTrack=function(e){var t=this._player.getVideoElement();if(t&&t.textTracks){var n=Array.from(t.textTracks).find((function(e){return!!e&&tt.isExternalTrack(e)}));if(n)if(n.mode=tt.MODE.SHOWING,void 0===window.VTTCue)this._convertCues(e).forEach((function(e){return n.addCue(e)}));else e.forEach((function(e){return n.addCue(e)}))}},r._convertCues=function(e){return e.map((function(e){return new window.TextTrackCue(e.startTime,e.endTime,e.text)}))},r._addNativeTextTrack=function(){var e=this._player.getVideoElement();e&&e.textTracks&&(Array.from(e.textTracks).findIndex((function(e){return!!e&&tt.isExternalTrack(e)}))>-1?this._resetExternalNativeTextTrack():e.addTextTrack(tt.KIND.SUBTITLES,tt.EXTERNAL_TRACK_ID,tt.EXTERNAL_TRACK_ID))},r._setTextTrack=function(e){var t=this;this._player.config.text.useNativeTextTrack||(this._isTextTrackActive=!0,i._logger.debug("External text track changed",e),this._activeTextCues=[],this._externalCueIndex=0,this.dispatchEvent(new E(Q.TEXT_CUE_CHANGED,{cues:this._activeTextCues})),this._eventManager.listen(this._player,q.TIME_UPDATE,(function(){return t._handleCaptionOnTimeUpdate(e)})))},i}(R);cn(An,"_logger",C("ExternalCaptionsHandler"));var fn={PRE:"preroll",MID:"midroll",POST:"postroll",OVERLAY:"overlay"},gn={VAST:"vast",VMAP:"vmap"};var pn=function(e){var t,n;function i(){return e.call(this)||this}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r=i.prototype;return r.destroy=function(){this._observer&&this._observer.disconnect(),this._observer=null,this._el=null},r.init=function(e){this._observer||(this._el=e,window.ResizeObserver?this._createNativeObserver():this._createIframeObserver(),this._el instanceof HTMLElement&&this._observer&&this._observer.observe(this._el))},r._createNativeObserver=function(){var e=this;this._observer=new window.ResizeObserver((function(t){t.forEach((function(){e._triggerResize()}))}))},r._createIframeObserver=function(){this._observer=new vn(this._triggerResize.bind(this))},r._triggerResize=function(){this.dispatchEvent(new E(Q.RESIZE))},i}(R),vn=function(){function e(e){!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"_observersStore",{}),this._onChangeCallback=e}var t=e.prototype;return t.observe=function(e){var t=this,n=this._createIframe(),i=e.getAttribute("id");this._observersStore[i]=n,e.appendChild(n),n.contentWindow.onresize=function(){return t._onChangeCallback()}},t.disconnect=function(){for(var e in this._observersStore){var t=document.getElementById(e),n=this._observersStore[e];n.onresize=null,t&&(t.removeChild(n),delete this._observersStore[t.getAttribute("id")])}},t._createIframe=function(){var e=document.createElement("iframe");return e.className="playkit-size-iframe",e},e}();function En(e,t){if(void 0===e&&(e=[]),void 0===t&&(t=function(){return 1}),0===e.length||1===e.length&&0!==t(e[0]))return null;var n=Math.floor(e.length/2);return 0===t(e[n])?e[n]:t(e[n])>0?En(e.slice(0,n),t):En(e.slice(n+1),t)}function mn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Tn=function(){function e(e){mn(this,"_isElementInFullscreen",!1),mn(this,"_isScreenLocked",!1),mn(this,"_isScreenOrientationSupport",!!screen&&!!screen.orientation&&"function"==typeof screen.orientation.unlock&&"function"==typeof screen.orientation.lock),mn(this,"_isFullscreenEventDispatched",!1),this._player=e,this._isInBrowserFullscreen=!1,this._eventManager=new x}var t=e.prototype;return t._isNativeDocumentFullscreen=function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)},t._isIOSFullscreen=function(){var e="function"==typeof this._player.getVideoElement?this._player.getVideoElement():null;return"iOS"===this._player.env.os.name&&!!e&&("fullscreen"===e.webkitPresentationMode||!e.webkitPresentationMode&&e.webkitDisplayingFullscreen)},t.isFullscreen=function(){return this._isNativeDocumentFullscreen()&&this._isElementInFullscreen||this._isIOSFullscreen()||this._isInBrowserFullscreen},t.enterFullscreen=function(e){if(!this.isFullscreen()){this.registerFullScreenEvents();var t=e&&j.getElementById(e),n=this._player.config.playback;if(t||(t=this._player.getView()),"iOS"===this._player.env.os.name)if(n.inBrowserFullscreen&&n.playsinline||this._player._engineType===rt.YOUTUBE)this._enterInBrowserFullscreen(t);else{var i=this._player.getVideoElement();i&&"function"==typeof i.webkitEnterFullScreen&&(this._player.isInPictureInPicture()?(setTimeout((function(){return i.webkitEnterFullScreen()}),1e3),this._player.exitPictureInPicture()):i.webkitEnterFullScreen())}else this._requestFullscreen(t)}},t.exitFullscreen=function(){if(this.isFullscreen())if("iOS"===this._player.env.os.name)if(this._isInBrowserFullscreen||this._player._engineType===rt.YOUTUBE)this._exitInBrowserFullscreen();else{var e=this._player.getVideoElement();e&&"function"==typeof e.webkitExitFullscreen&&e.webkitExitFullscreen()}else this._requestExitFullscreen()},t._nativeEnterFullScreen=function(e){return"function"==typeof e.requestFullscreen?e.requestFullscreen():"function"==typeof e.mozRequestFullScreen?e.mozRequestFullScreen():"function"==typeof e.webkitRequestFullScreen?e.webkitRequestFullScreen():"function"==typeof e.msRequestFullscreen?e.msRequestFullscreen():void 0},t._requestFullscreen=function(e){var t=this;this._player.isInPictureInPicture()&&this._player.exitPictureInPicture(),Promise.resolve(this._nativeEnterFullScreen(e)).then((function(){t._isElementInFullscreen=!0;var e=V.getPropertyPath(t._player,"config.playback.screenLockOrientionMode"),n=e!==dt.NONE&&Object.values(dt).includes(e);t._isScreenOrientationSupport&&n&&screen.orientation.lock(e).then((function(){return t._isScreenLocked=!0})).catch((function(){return t._isScreenLocked=!1}))}),(function(){}))},t._nativeExitFullScreen=function(){return"function"==typeof document.exitFullscreen?document.exitFullscreen():"function"==typeof document.webkitExitFullscreen?document.webkitExitFullscreen():"function"==typeof document.mozCancelFullScreen?document.mozCancelFullScreen():"function"==typeof document.msExitFullscreen?document.msExitFullscreen():void 0},t._requestExitFullscreen=function(){var e=this;Promise.resolve(this._nativeExitFullScreen()).then((function(){e._isElementInFullscreen=!1,e._isScreenOrientationSupport&&e._isScreenLocked&&(screen.orientation.unlock(),e._isScreenLocked=!1)}),(function(){}))},t._enterInBrowserFullscreen=function(e){this._player.isInPictureInPicture()&&this._player.exitPictureInPicture(),j.addClassName(e,"playkit-in-browser-fullscreen-mode"),this._isInBrowserFullscreen=!0,this._fullscreenEnterHandler(),this._player.dispatchEvent(new E(this._player.Event.RESIZE))},t._exitInBrowserFullscreen=function(){var e=j.getElementBySelector(".playkit-in-browser-fullscreen-mode");e&&j.removeClassName(e,"playkit-in-browser-fullscreen-mode"),this._isInBrowserFullscreen=!1,this._fullscreenExitHandler(),this._player.dispatchEvent(new E(this._player.Event.RESIZE))},t.registerFullScreenEvents=function(){var e=this;"iOS"===this._player.env.os.name?this._handleIosFullscreen():(this._eventManager.listen(document,"webkitfullscreenchange",(function(){return e._fullscreenChangeHandler()})),this._eventManager.listen(document,"mozfullscreenchange",(function(){return e._fullscreenChangeHandler()})),this._eventManager.listen(document,"fullscreenchange",(function(){return e._fullscreenChangeHandler()})),this._eventManager.listen(document,"MSFullscreenChange",(function(){return e._fullscreenChangeHandler()})))},t._handleIosFullscreen=function(){var e=this,t=function(){var t=e._player.getVideoElement();t&&(e._eventManager.listen(t,"webkitbeginfullscreen",(function(){return e._fullscreenEnterHandler()})),e._eventManager.listen(t,"webkitendfullscreen",(function(){return e._fullscreenExitHandler()})))};this._player.getVideoElement()?t():this._eventManager.listenOnce(this._player,this._player.Event.SOURCE_SELECTED,(function(){return t()}))},t._fullscreenChangeHandler=function(){this.isFullscreen()?this._fullscreenEnterHandler():this._fullscreenExitHandler()},t._fullscreenEnterHandler=function(){this.isFullscreen()&&!this._isFullscreenEventDispatched&&(this._isFullscreenEventDispatched=!0,this._player.dispatchEvent(new E(this._player.Event.ENTER_FULLSCREEN)))},t._fullscreenExitHandler=function(){!this.isFullscreen()&&this._isFullscreenEventDispatched&&(this._isFullscreenEventDispatched=!1,this._eventManager.removeAll(),this._player.dispatchEvent(new E(this._player.Event.EXIT_FULLSCREEN)))},t.destroy=function(){this._eventManager.destroy()},e}();function yn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var bn=function(){function e(){yn(this,"_decoratorProviders",new Map),yn(this,"_logger",C("EngineDecoratorManager"))}var t=e.prototype;return t.register=function(e){this._decoratorProviders.has(e.getName())?this._logger.warn("decorator already registered for "+e.getName()):this._decoratorProviders.set(e.getName(),e)},t.createDecorators=function(e,t){return this._logger.debug("decorators created for "+Array.from(this._decoratorProviders.keys()).toString()),Array.from(this._decoratorProviders.values(),(function(n){return n.getEngineDecorator(e,t)}))},t.destroy=function(){this._logger.debug("decorators destroyed"),this._decoratorProviders.clear()},e}();function Sn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function kn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var wn=function(e){var t,n;function i(t,n){var i;return(i=e.call(this)||this)._eventManager=new x,i._pluginDecorators=n.createDecorators(t,e.prototype.dispatchEvent.bind(kn(i))),Object.values(Z).forEach((function(e){return i._eventManager.listen(t,e,(function(e){return i.dispatchEvent(e)}))})),new Proxy(t,{get:function(e,t){"destroy"===t&&i._destroy();var n,r=i._pluginDecorators.find((function(e){return e.active}));return(n="addEventListener"===t||"removeEventListener"===t?kn(i):r&&t in r?r:e)[t]&&"function"==typeof n[t].bind?n[t].bind(n):n[t]},set:function(e,t,n){var r=i._pluginDecorators.find((function(e){return t in e&&e.active}));return r&&t in r?r[t]=n:e[t]=n,!0}})||kn(i)}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,a,o,s=i.prototype;return s.dispatchEvent=function(t){var n=this._pluginDecorators.find((function(e){return e.active}));return n&&n.dispatchEvent?n.dispatchEvent(t):e.prototype.dispatchEvent.call(this,t)},s._destroy=function(){this._pluginDecorators=[],this._eventManager.destroy()},r=i,(a=[{key:"active",get:function(){return!0}}])&&Sn(r.prototype,a),o&&Sn(r,o),i}(R),Cn="audio",Rn="captions",Dn="qualities",In={TRUE:!0,FALSE:!1,IN_VIEW:"inview"};function On(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Nn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Nn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function Nn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function xn(){return(xn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function Pn(e,t,n,i,r,a,o){try{var s=e[a](o),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(i,r)}function Ln(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var a=e.apply(t,n);function o(e){Pn(a,i,r,o,s,"next",e)}function s(e){Pn(a,i,r,o,s,"throw",e)}o(void 0)}))}}function Mn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Un=/#wh=/i,Fn=/#xywh=/i,Bn=new RegExp("^/[^/].+"),Hn=function(e){var t,n;function i(){var t;return Mn(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t=e.call(this)||this),"_cues",[]),t._eventManager=new x,t}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r=i.prototype;return r.load=function(){var e=Ln(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return i._logger.debug("start loading the vtt thumbnails"),e.next=5,this._downloadAndParseCues(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),r.getThumbnail=function(e){var t=this._findCue(e,this._cues);if(t){var n=t.size,i=t.coordinates,r=xn({url:t.imgUrl},n=n||this._naturalImgSize,i=i||{x:0,y:0});return new vt(r)}return null},r.isUsingVttThumbnails=function(){var e;return!!(null==(e=this._cues)?void 0:e.length)},r._downloadAndParseCues=function(){var e=Ln(regeneratorRuntime.mark((function e(t){var n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._downloadVttFile(t);case 3:return n=e.sent,e.next=6,this._processVtt(n);case 6:return i=e.sent,e.next=9,this._formatIntoThumbnailCues(i,t);case 9:this._cues=e.sent,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),this.dispatchEvent(new E(q.ERROR,e.t0));case 15:case"end":return e.stop()}}),e,this,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),r._downloadVttFile=function(){var e=Ln(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Y.execute(t.vttUrl,{},"GET");case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),new M(M.Severity.RECOVERABLE,M.Category.TEXT,M.Code.HTTP_ERROR,e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),r._processVtt=function(){var e=Ln(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=new Pe(window,Le()),a=[];r.oncue=function(e){return a.push(e)},r.onflush=function(){i._logger.debug("finished parsing thumbnails cues"),e(a)},r.parse(t),r.flush(),r.onparsingerror((function(e){return n(e)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r._formatIntoThumbnailCues=function(){var e=Ln(regeneratorRuntime.mark((function e(t,n){var i,r,a,o,s,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.validateThumbnailsVTTFormat(t)){e.next=4;break}throw new M(M.Severity.RECOVERABLE,M.Category.TEXT,M.Code.INVALID_VTT_THUMBNAILS_FILE,{message:"invalid thumbnail vtt format",vttUrl:n.vttUrl});case 4:return i=this._extractCueMetadata(t[0],n),e.next=7,this.validateImgUrl(i.imgUrl);case 7:if(e.sent){e.next=11;break}throw new M(M.Severity.RECOVERABLE,M.Category.TEXT,M.Code.INVALID_VTT_THUMBNAILS_FILE,{message:"failed loading the image - invalid image url",imgUrl:i.imgUrl});case 11:return e.next=13,this.extractImgNaturalDimensions(i.imgUrl);case 13:for(this._naturalImgSize=e.sent,r=[],a=On(t);!(o=a()).done;)s=o.value,c=this._extractCueMetadata(s,n),r.push(c);return e.abrupt("return",r);case 17:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),r.validateThumbnailsVTTFormat=function(e){return e.length&&e[0]instanceof je},r.extractImgNaturalDimensions=function(e){var t=this;return new Promise((function(n){var i=new Image;i.src=e,t._eventManager.listenOnce(i,"load",(function(){n({height:i.naturalHeight,width:i.naturalWidth})})),t._eventManager.listenOnce(i,"error",(function(){return n(null)}))}))},r.validateImgUrl=function(e){var t=this;return new Promise((function(n){var i=new Image;i.src=e,t._eventManager.listenOnce(i,"load",(function(){n(!0)})),t._eventManager.listenOnce(i,"error",(function(){return n(!1)}))}))},r._extractCueMetadata=function(e,t){var n,r=e.startTime,a=e.endTime,o=e.text,s=t.vttUrl.substring(0,t.vttUrl.lastIndexOf("/")),c=Un.test(o),u=Fn.test(o),l=!1,d=null,h=null;if(c)n=o.split(Un)[0],i._logger.warn('vtt thumbnails in "'+Un+'" form - is supported but the width and height options are ignored and The images will be displayed in their natural dimensions'),l=void 0!==n;else if(u){var _=o.split(Fn);n=_[0];var A=_[1].split(",").map(Number),f=A[0],g=A[1],p=A[2],v=A[3];d={x:f,y:g},h={width:p,height:v},l=[f,g,p,v,n].every((function(e){return void 0!==e}))}else n=o,l=!!o;if(0!==n.indexOf("http://")&&0!==n.indexOf("https://")&&(n=s+"/"+(n=Bn.test(n)?n.substring(1):n)),l)return{startTime:r,endTime:a,imgUrl:n,size:h,coordinates:d};throw new M(M.Severity.RECOVERABLE,M.Category.TEXT,M.Code.INVALID_VTT_THUMBNAILS_FILE,{message:"error while parsing the vtt cues - invalid cue",parsedCue:{startTime:r,endTime:a,options:o}})},r._findCue=function(e,t){for(var n=0,i=t.length-1;n<=i;){var r=Math.floor((n+i)/2),a=t[r];if(e>=a.startTime&&e<a.endTime)return t[r];e<a.startTime?i=r-1:n=r+1}return null},r.reset=function(){this._cues=[],this._eventManager.removeAll(),this._naturalImgSize={}},r.destroy=function(){this.reset(),this._eventManager.destroy()},i}(R);function Vn(){return(Vn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function Gn(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return jn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function jn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Yn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Wn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Mn(Hn,"_logger",C("ExternalThumbnailsHandler"));var zn="off",Xn=function(e){var t,n;function i(t){var n;return void 0===t&&(t={}),Kn(Wn(n=e.call(this)||this),"_sources",{}),Kn(Wn(n),"_activeTextCues",[]),Kn(Wn(n),"_textDisplaySettings",{}),Kn(Wn(n),"_playbackAttributesState",{muted:void 0,volume:void 0,rate:void 0,videoTrack:void 0,audioLanguage:"",textLanguage:""}),Kn(Wn(n),"_hasUserInteracted",!1),Kn(Wn(n),"_isOnLiveEdge",!1),Kn(Wn(n),"_shouldLoadAfterAttach",!1),n._setConfigLogLevel(t),n._playerId=G.uniqueId(5),n._prepareVideoElement(),i.runCapabilities(),n._env=f,n._tracks=[],n._firstPlay=!0,n._loadingMedia=!1,n._loading=!1,n._playbackStart=!1,n._firstPlaying=!1,n._reset=!0,n._destroyed=!1,n._fallbackToMutedAutoPlay=!1,n._config=i._defaultConfig,n._sources=V.copyDeep(_t),n._eventManager=new x,n._posterManager=new z,n._stateManager=new re(Wn(n)),n._resizeWatcher=new pn,n._playbackMiddleware=new lt,n._textStyle=new Ee,n._createReadyPromise(),n._createPlayerContainer(),n._appendDomElements(),n._externalCaptionsHandler=new An(Wn(n)),n._externalThumbnailsHandler=new Hn,n._fullscreenController=new Tn(Wn(n)),n.configure(t),n}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.runCapabilities=function(){i._logger.debug("Running player capabilities"),rn.getEngines().forEach((function(e){return e.runCapabilities()}))},i.getCapabilities=function(e){i._logger.debug("Get player capabilities",e);var t=[];return rn.getEngines().forEach((function(e){return t.push(e.getCapabilities())})),Promise.all(t).then((function(t){var n={};return t.forEach((function(e){return Object.assign(n,e)})),e?n[e]:n}))},i.setCapabilities=function(e,t){i._logger.debug("Set player capabilities",e,t);var n=rn.getEngines().find((function(t){return t.id===e}));n&&n.setCapabilities(t)};var r,a,o,s=i.prototype;return s.configure=function(e){void 0===e&&(e={}),this._setConfigLogLevel(e),V.mergeDeep(this._config,e),this._applyTextTrackConfig(e),this._applyABRRestriction(e)},s.setSourcesMetadata=function(e){this._sources&&(this._sources.metadata||(this._sources.metadata={}),V.mergeDeep(this._sources.metadata,e))},s.setSources=function(e){this._hasSources(e)?(this.reset(),V.mergeDeep(this._sources,e),this._resizeWatcher.init(j.getElementById(this._playerId)),i._logger.debug("Change source started"),this.dispatchEvent(new E(Q.CHANGE_SOURCE_STARTED)),this._reset=!1,this._selectEngineByPriority()?(this.dispatchEvent(new E(Q.SOURCE_SELECTED,{selectedSource:this._sources[this._streamType]})),this._attachMedia(),this._handlePlaybackOptions(),this._posterManager.setSrc(this._sources.poster),this._handleDimensions(),this._handlePreload(),this._handleAutoPlay(),i._logger.debug("Change source ended"),this.dispatchEvent(new E(Q.CHANGE_SOURCE_ENDED))):(i._logger.warn("No playable engines was found to play the given sources"),this.dispatchEvent(new E(q.ERROR,new M(M.Severity.CRITICAL,M.Category.PLAYER,M.Code.NO_ENGINE_FOUND_TO_PLAY_THE_SOURCE,"No Engine Found To Play The Source"))))):V.mergeDeep(this._sources,e)},s.ready=function(){return this._readyPromise?this._readyPromise:Promise.resolve()},s.load=function(){var e=this;this.src?i._logger.debug("The source has already been loaded. load request ignored"):this._playbackMiddleware.load((function(){e._engine?e._load():e._eventManager.listenOnce(e,Q.SOURCE_SELECTED,(function(){return e._load()}))}))},s.play=function(e){var t=this;e&&e.programmatic?this._autoPlay():(this._playbackStart||(this._playbackStart=!0,this.dispatchEvent(new E(Q.PLAYBACK_START)),this.src||this._prepareVideoElement(),this.load()),this._engine?this._playbackMiddleware.play((function(){return t._play()})):this._loadingMedia?this._playbackMiddleware.play((function(){return t._playAfterAsyncMiddleware()})):this.dispatchEvent(new E(q.ERROR,new M(M.Severity.CRITICAL,M.Category.PLAYER,M.Code.NO_SOURCE_PROVIDED,"No Source Provided"))))},s.pause=function(){this._engine&&this._playbackMiddleware.pause(this._pause.bind(this))},s.getView=function(){return this._el},s.getVideoElement=function(){if(this._engine)return this._engine.getVideoElement()},s.reset=function(e){void 0===e&&(e=!1),this._reset||(this.pause(),this._externalCaptionsHandler.reset(),this._externalThumbnailsHandler.reset(),this._posterManager.reset(),this._stateManager.reset(),this._sources=V.copyDeep(_t),this._activeTextCues=[],this._updateTextDisplay([]),this._tracks=[],tt.reset(),this._resetStateFlags(),this._engineType="",this._streamType="",this._pendingSelectedVideoTrack=null,this._engine&&this._engine.reset(),this.showBlackCover(),this._reset=!0,this.dispatchEvent(new E(Q.PLAYER_RESET,{isChangeMedia:e})),this._eventManager.removeAll(),this._resizeWatcher.init(j.getElementById(this._playerId)),this._createReadyPromise(),this._isOnLiveEdge=!1,this._shouldLoadAfterAttach=!1)},s.destroy=function(){this._destroyed||(this._externalCaptionsHandler.destroy(),this._posterManager.destroy(),this._stateManager.destroy(),this._fullscreenController.destroy(),this._activeTextCues=[],this._textDisplaySettings={},this._config={},this._tracks=[],this._engineType="",this._streamType="",this._readyPromise=null,this._pendingSelectedVideoTrack=null,this._resetStateFlags(),this._playbackAttributesState={},this._engine&&this._engine.destroy(),this._engineDecoratorManager&&this._engineDecoratorManager.destroy(),this._resizeWatcher.destroy(),this._el&&j.removeChild(this._el.parentNode,this._el),this._destroyed=!0,this.dispatchEvent(new E(Q.PLAYER_DESTROY)),this._eventManager.destroy())},s.hideBlackCover=function(){this._blackCoverEl&&(this._blackCoverEl.style.visibility="hidden")},s.showBlackCover=function(){this._blackCoverEl&&(this._blackCoverEl.style.visibility="visible")},s.attachMediaSource=function(){var e=this;this._engine&&(this._shouldLoadAfterAttach=!0,this._engine.attachMediaSource(),this._eventManager.listenOnce(this,q.CAN_PLAY,(function(){"number"==typeof e._playbackAttributesState.rate&&(e.playbackRate=e._playbackAttributesState.rate)})))},s.detachMediaSource=function(){this._engine&&(this.pause(),this.hideTextTrack(),this._shouldLoadAfterAttach=!1,this._createReadyPromise(),this._engine.detachMediaSource())},s.registerEngineDecoratorProvider=function(e){this._engineDecoratorManager||(this._engineDecoratorManager=new bn),e&&this._engineDecoratorManager.register(e)},s._getTargetElement=function(){return j.getElementById(this._config.targetId)},s.isLive=function(){return!(this._sources.type===at.VOD||!(this._sources.type===at.LIVE||this._engine&&this._engine.isLive()))},s.isAudio=function(){return this._sources.type===at.AUDIO},s.isOnLiveEdge=function(){return this._engine&&"function"==typeof this._engine.isOnLiveEdge?this._engine.isOnLiveEdge():this._isOnLiveEdge},s.isDvr=function(){return this.isLive()&&this._sources.dvr},s.seekToLiveEdge=function(){this._engine&&this.isLive()&&(this._engine.seekToLiveEdge(),this._isOnLiveEdge=!0)},s.getStartTimeOfDvrWindow=function(){return this._engine?this._engine.getStartTimeOfDvrWindow():0},s.getTracks=function(e){switch(e){case nt.VIDEO:return V.copyDeep(this._getVideoTracks());case nt.AUDIO:return V.copyDeep(this._getAudioTracks());case nt.TEXT:return V.copyDeep(this._getTextTracks());case nt.IMAGE:return V.copyDeep(this._getImageTracks());default:return V.copyDeep(this._tracks)}},s.getActiveTracks=function(){return V.copyDeep({video:this._getVideoTracks().find((function(e){return e.active})),audio:this._getAudioTracks().find((function(e){return e.active})),text:this._getTextTracks().find((function(e){return e.active}))})},s.selectTrack=function(e){this._engine&&(e instanceof ce?(this._playbackAttributesState.videoTrack=e,this._stateManager.currentState.type===ne.IDLE?this._pendingSelectedVideoTrack=e:this._engine.selectVideoTrack(e)):e instanceof ue?this._engine.selectAudioTrack(e):e instanceof tt?(this._resetTextDisplay(),e.language===zn?(this.hideTextTrack(),this._externalCaptionsHandler.hideTextTrack(),this._playbackAttributesState.textLanguage=zn):e.external?(this._engine.hideTextTrack(),this._externalCaptionsHandler.selectTextTrack(e)):(this._externalCaptionsHandler.hideTextTrack(),this._engine.selectTextTrack(e))):e instanceof gt&&this._engine.selectImageTrack(e))},s.hideTextTrack=function(){if(this._engine){this._engine.hideTextTrack(),this._resetTextDisplay();var e=this._getTextTracks(),t=e.find((function(e){return!0===e.active}));t&&t.external&&this._externalCaptionsHandler.hideTextTrack(),e.map((function(e){return e.active=!1}));var n=e.find((function(e){return e.language===zn}));n&&(n.active=!0,this.dispatchEvent(new E(Q.TEXT_TRACK_CHANGED,{selectedTextTrack:n}))),this._playbackAttributesState.textLanguage=zn}},s.showTextTrack=function(){var e=this._getTextTracks(),t=this._playbackAttributesState.textLanguage!==zn&&this._playbackAttributesState.textLanguage||this._getLanguage(e,"auto",e.find((function(e){return e.default})));this._setDefaultTrack(e,t)},s.addTextTrack=function(e,t,n){if(this._engine&&"function"==typeof this._engine.addTextTrack)return this._engine.addTextTrack(e,t,n)},s.getNativeTextTracks=function(){return this._engine&&"function"==typeof this._engine.getNativeTextTracks?this._engine.getNativeTextTracks():[]},s.enableAdaptiveBitrate=function(){this._engine&&this._engine.enableAdaptiveBitrate(),this._playbackAttributesState.videoTrack=void 0},s.isAdaptiveBitrateEnabled=function(){return!!this._engine&&this._engine.isAdaptiveBitrateEnabled()},s._applyABRRestriction=function(e){if(V.hasPropertyPath(e,"abr.restrictions")&&this._engine&&this._tracks.length){var t=this._config.abr.restrictions,n=St(this._tracks.filter((function(e){return e instanceof ce})),t);if(n.length){var r=this._tracks.filter((function(e){return e instanceof ce&&e.available}));!(r.length===n.length&&r.every((function(e,t){return e.bandwidth===n[t].bandwidth})))&&(this._engine.applyABRRestriction(t),this._tracks.forEach((function(e){!n.includes(e)&&e instanceof ce?(e.available=!1,e.active=!1):e.available=!0})),this.getActiveTracks().video||(n[0].active=!0),this.dispatchEvent(new E(Q.TRACKS_CHANGED,{tracks:this._tracks.filter((function(e){return e.available}))})))}else i._logger.warn("Invalid restriction, Nothing has changed values do not meet the restriction")}},s._applyTextTrackConfig=function(e){if(V.hasPropertyPath(e,"text.textTrackDisplaySetting")||V.getPropertyPath(e,"text.forceCenter")){var t={};V.hasPropertyPath(this._config,"text.textTrackDisplaySetting")&&(t=V.mergeDeep(t,this._config.text.textTrackDisplaySetting)),V.getPropertyPath(this._config,"text.forceCenter")&&(t=V.mergeDeep(t,{position:"auto",align:"center",size:"100"})),this.setTextDisplaySettings(t)}try{V.hasPropertyPath(e,"text.textStyle")&&(this.textStyle=Ee.fromJson(this._config.text.textStyle))}catch(e){i._logger.warn(e)}},s.getThumbnail=function(e){return this._externalThumbnailsHandler.isUsingVttThumbnails()?this._externalThumbnailsHandler.getThumbnail(e):this._engine?this._engine.getThumbnail(e):null},s.setTextDisplaySettings=function(e){this._textDisplaySettings=V.mergeDeep(this._textDisplaySettings,e),this._updateCueDisplaySettings();for(var t=0;t<this._activeTextCues.length;t++)this._activeTextCues[t].hasBeenReset=!0;this._updateTextDisplay(this._activeTextCues)},s.isFullscreen=function(){return this._fullscreenController.isFullscreen()},s.notifyEnterFullscreen=function(){this.isFullscreen()&&this.dispatchEvent(new E(Q.ENTER_FULLSCREEN))},s.notifyExitFullscreen=function(){this.isFullscreen()||this.dispatchEvent(new E(Q.EXIT_FULLSCREEN))},s.enterFullscreen=function(e){this._fullscreenController.enterFullscreen(e)},s.exitFullscreen=function(){this._fullscreenController.exitFullscreen()},s.enterPictureInPicture=function(){this.isFullscreen()&&this.exitFullscreen(),this._engine&&!this._engine.isInPictureInPicture&&this._engine.enterPictureInPicture()},s.exitPictureInPicture=function(){this._engine&&this._engine.isInPictureInPicture&&this._engine.exitPictureInPicture()},s.isInPictureInPicture=function(){return!!this._engine&&this._engine.isInPictureInPicture},s.isPictureInPictureSupported=function(){return!!this._config.playback.pictureInPicture&&this._engine.isPictureInPictureSupported()},s.isVr=function(){return!!this._sources.vr},s.getLogLevel=function(e){return k(e)},s.setLogLevel=function(e,t){w(e,t)},s.getDrmInfo=function(){var e;return null==(e=this._engine)?void 0:e.getDrmInfo()},s._resetTextDisplay=function(){this._activeTextCues=[],this._updateTextDisplay([])},s._prepareVideoElement=function(){var e=this;rn.getEngines().forEach((function(t){t.prepareVideoElement(e._playerId)}))},s._setConfigLogLevel=function(e){e.log&&e.log.level&&T[e.log.level]&&w(T[e.log.level]),e.log&&"function"==typeof e.log.handler&&b(e.log.handler)},s._hasSources=function(e){return!!e&&!!Object.values(it).find((function(t){return e[t]&&e[t].length>0}))},s._createPlayerContainer=function(){var e=this._el=j.createElement("div");j.addClassName(e,"playkit-container"),j.setAttribute(e,"id",this._playerId),j.setAttribute(e,"tabindex","-1")},s._appendEngineEl=function(){if(this._el){var e=this._engine.getVideoElement();j.addClassName(e,"playkit-engine");var t="playkit-engine-"+this._engine.id;j.addClassName(e,t),j.prependTo(e,this._el),"youtube"===this._engine.id&&(this._el.style.zIndex=1)}},s._appendDomElements=function(){this._blackCoverEl=j.createElement("div"),j.addClassName(this._blackCoverEl,"playkit-black-cover"),j.appendChild(this._el,this._blackCoverEl);var e=this._posterManager.getElement();j.addClassName(e,"playkit-poster"),j.appendChild(this._el,e),this._textDisplayEl=j.createElement("div"),j.addClassName(this._textDisplayEl,"playkit-subtitles"),j.appendChild(this._el,this._textDisplayEl)},s._createReadyPromise=function(){var e=this;this._readyPromise=new Promise((function(t,n){e._eventManager.listenOnce(e,Q.TRACKS_CHANGED,(function(){e.dispatchEvent(new E(Q.MEDIA_LOADED)),t()})),e._eventManager.listen(e,q.ERROR,(function(e){e.payload.severity===M.Severity.CRITICAL&&n()}))})).catch((function(){}))},s._selectEngineByPriority=function(){for(var e,t=this,n=this._config.playback.streamPriority,r=this._config.playback.preferNative,a=this._sources,o=function(){var n=e.value,o="string"==typeof n.engine?n.engine.toLowerCase():"",s="string"==typeof n.format?n.format.toLowerCase():"",c=rn.getEngines().find((function(e){return e.id===o}));if(c){var u=a[s];if(u&&u.length>0){var l=u[0];if(c.canPlaySource(l,r[s],t._config.drm))return i._logger.debug("Source selected: ",u),t._loadEngine(c,l),t._engineType=o,t._streamType=s,{v:!0}}}},s=Gn(n);!(e=s()).done;){var c=o();if("object"==typeof c)return c.v}return!1},s._loadEngine=function(e,t){this._engine?this._engine.id===e.id?this._engine.restore(t,Vn({},this._config,{sources:this._sources})):(this._engine.destroy(),this._createEngine(e,t),this._appendEngineEl()):(this._createEngine(e,t),this._appendEngineEl())},s._createEngine=function(e,t){var n=e.createEngine(t,Vn({},this._config,{sources:this._sources}),this._playerId);this._engine=this._engineDecoratorManager?new wn(n,this._engineDecoratorManager):n},s._attachMedia=function(){var e=this;if(this._engine){Object.keys(q).forEach((function(t){e._eventManager.listen(e._engine,q[t],(function(t){return e.dispatchEvent(t)}))})),this._eventManager.listen(this._engine,q.SEEKING,(function(){e.isLive()&&(e._isOnLiveEdge=!(!e.duration||!e.currentTime)&&(e.currentTime>=e.duration-1&&!e.paused))})),this._eventManager.listen(this._engine,q.SEEKED,(function(){var t=e._env.browser.name;"Edge"!==t&&"IE"!==t||e._removeTextCuePatch()})),this._eventManager.listen(this._engine,Q.MEDIA_RECOVERED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,Q.IMAGE_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,Q.TEXT_TRACK_ADDED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,Q.VIDEO_TRACK_CHANGED,(function(t){return e._markActiveTrack(t.payload.selectedVideoTrack),e.dispatchEvent(t)})),this._eventManager.listen(this._engine,Q.AUDIO_TRACK_CHANGED,(function(t){e.ready().then((function(){return e._playbackAttributesState.audioLanguage=t.payload.selectedAudioTrack.language})),e._markActiveTrack(t.payload.selectedAudioTrack),e.dispatchEvent(t)})),this._eventManager.listen(this._engine,Q.TEXT_TRACK_CHANGED,(function(t){return e._onTextTrackChanged(t)})),this._eventManager.listen(this._engine,Q.TRACKS_CHANGED,(function(t){return e._onTracksChanged(t)})),this._eventManager.listen(this._engine,Q.TEXT_CUE_CHANGED,(function(t){return e._onCueChange(t)})),this._eventManager.listen(this._engine,Q.ABR_MODE_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,Q.TIMED_METADATA,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,Q.TIMED_METADATA_CHANGE,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,Q.TIMED_METADATA_ADDED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,Q.PLAY_FAILED,(function(t){e._onPlayFailed(t),e.dispatchEvent(t)})),this._eventManager.listen(this._engine,Q.FPS_DROP,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,Q.FRAG_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,Q.DRM_LICENSE_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,Q.MANIFEST_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,Q.MEDIA_RECOVERED,(function(){return e._handleRecovered()})),this._eventManager.listen(this,q.PLAY,this._onPlay.bind(this)),this._eventManager.listen(this,q.PAUSE,this._onPause.bind(this)),this._eventManager.listen(this,q.PLAYING,this._onPlaying.bind(this)),this._eventManager.listen(this,q.ENDED,this._onEnded.bind(this)),this._eventManager.listen(this,Q.MUTE_CHANGE,(function(){e._playbackAttributesState.muted=e.muted})),this._eventManager.listen(this,q.VOLUME_CHANGE,(function(){e._playbackAttributesState.volume=e.volume})),this._eventManager.listen(this,q.RATE_CHANGE,(function(){e._playbackAttributesState.rate=e.playbackRate})),this._eventManager.listen(this,Q.ENTER_FULLSCREEN,(function(){return e._resetTextCuesAndReposition()})),this._eventManager.listen(this,Q.EXIT_FULLSCREEN,(function(){return e._resetTextCuesAndReposition()})),this._eventManager.listen(this._resizeWatcher,Q.RESIZE,(function(t){e._resetTextCuesAndReposition(),e.dispatchEvent(t)})),this._eventManager.listen(this._externalCaptionsHandler,Q.TEXT_CUE_CHANGED,(function(t){return e._onCueChange(t)})),this._eventManager.listen(this._externalCaptionsHandler,Q.TEXT_TRACK_CHANGED,(function(t){return e._onTextTrackChanged(t)})),this._eventManager.listen(this._externalCaptionsHandler,q.ERROR,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._externalThumbnailsHandler,q.ERROR,(function(t){return e.dispatchEvent(t)}));var t=j.getElementBySelector("#"+this.config.targetId);t&&this._eventManager.listen(t,"click",(function(){e._hasUserInteracted=!0,e.dispatchEvent(new E(Q.USER_GESTURE))}),{capture:!0})}},s._handleRecovered=function(){this._stateManager.currentState.type===ne.PLAYING&&this.play()},s._onTextTrackChanged=function(e){var t=this;this.ready().then((function(){return t._playbackAttributesState.textLanguage=e.payload.selectedTextTrack.language})),this._markActiveTrack(e.payload.selectedTextTrack),this.dispatchEvent(e)},s._resetTextCuesAndReposition=function(){this._engine.resetAllCues(),this._externalCaptionsHandler.resetAllCues(),this._updateTextDisplay([]);for(var e=0;e<this._activeTextCues.length;e++)this._activeTextCues[e].hasBeenReset=!0;this._updateTextDisplay(this._activeTextCues)},s._removeTextCuePatch=function(){var e=this,t=this._activeTextCues.filter((function(t){var n=t._endTime,i=t._startTime,r=e.currentTime;if(r<n&&r>i)return t}));this._updateTextDisplay(t)},s._handlePlaybackOptions=function(){if(this._config.playback=this._config.playback||{},"boolean"==typeof this._playbackAttributesState.muted?this.muted=this._playbackAttributesState.muted:"boolean"==typeof this._config.playback.muted&&(this.muted=this._config.playback.muted),"number"==typeof this._playbackAttributesState.volume?this.volume=this._playbackAttributesState.volume:"number"==typeof this._config.playback.volume&&(this.volume=this._config.playback.volume),"boolean"==typeof this._config.playback.playsinline&&(this.playsinline=this._config.playback.playsinline),"string"==typeof this._config.playback.crossOrigin&&(this.crossOrigin=this._config.playback.crossOrigin),Array.isArray(this._config.playback.playbackRates)){var e=this._config.playback.playbackRates.filter((function(e,t,n){return e>0&&e<=16&&n.indexOf(e)===t})).sort((function(e,t){return e-t}));e&&(this._playbackRates=e)}},s._handlePreload=function(){"auto"!==this._config.playback.preload||this._config.playback.autoplay||this.load()},s._autoPlay=function(){var e=this,t=this._config.playback.allowMutedAutoPlay;i.getCapabilities(this.engineType).then((function(i){i.autoplay?n():i.mutedAutoPlay?e.muted&&!e._fallbackToMutedAutoPlay?r():t?a():o():o()}));var n=function(){i._logger.debug("Start autoplay"),e._fallbackToMutedAutoPlay&&(e._fallbackToMutedAutoPlay=!1,e.muted=!1),e.play()},r=function(){i._logger.debug("Start muted autoplay"),e.play()},a=function(){i._logger.debug("Fallback to muted autoplay"),e._fallbackToMutedAutoPlay=!0,e.muted=!0,e.dispatchEvent(new E(Q.FALLBACK_TO_MUTED_AUTOPLAY)),e.play()},o=function(){i._logger.warn("Autoplay failed, pause player"),e._posterManager.show(),e.load(),e.dispatchEvent(new E(Q.AUTOPLAY_FAILED))}},s._handleAutoPlay=function(){(this.isAudio()||this._config.playback.autoplay!==In.TRUE)&&this._posterManager.show(),this._config.playback.autoplay===In.TRUE&&this._autoPlay()},s._playAfterAsyncMiddleware=function(){var e=this;this._engine?this._play():this._eventManager.listenOnce(this,Q.SOURCE_SELECTED,(function(){return e._play()}))},s._load=function(){var e=this;if(this._engine&&!this.src&&!this._loading){this._loading=!0;var t=this._sources.startTime;this._engine.load(t).then((function(n){e.isLive()&&(-1===t||Number(t)>=Number(e.duration))&&(e._isOnLiveEdge=!0),e._updateTracks(n.tracks),e.dispatchEvent(new E(Q.TRACKS_CHANGED,{tracks:e._tracks})),e._externalThumbnailsHandler.load(e.sources.thumbnails)})).finally((function(){e._loading=!1,e._reset=!1}))}},s._handleDimensions=function(){var e=this.config.dimensions;V.isObject(e)&&!V.isEmptyObject(e)&&(this.dimensions=e)},s._play=function(){var e=this;this._shouldLoadAfterAttach&&(this._load(),this._shouldLoadAfterAttach=!1),this.ready().then((function(){e._shouldPlayerSeekToLiveEdge()&&e.seekToLiveEdge(),e._engine.play()}))},s._shouldPlayerSeekToLiveEdge=function(){if(this.isLive()){var e=!this.isDvr()||"number"==typeof this.currentTime&&this.currentTime<0;return this._firstPlay?!!this.src&&!this.isOnLiveEdge():e}return!1},s._pause=function(){this._engine.pause()},s._setCurrentTime=function(e){if(this._engine&&B.isNumber(e)){var t=e;e<0&&(t=0);var n=this.isLive()?this._engine.duration:this._engine.duration-.1;t>n&&(t=n),this._engine.currentTime=t}},s._onPause=function(){this._isOnLiveEdge=!1},s._onPlay=function(){this._firstPlay&&(this._firstPlay=!1,this.dispatchEvent(new E(Q.FIRST_PLAY)),this.hideBlackCover(),"number"==typeof this._playbackAttributesState.rate&&(this.playbackRate=this._playbackAttributesState.rate))},s._onPlaying=function(){this._firstPlaying||(this._firstPlaying=!0,this.isAudio()||this._posterManager.hide(),this.dispatchEvent(new E(Q.FIRST_PLAYING))),this._engine&&this._pendingSelectedVideoTrack&&(this._engine.selectVideoTrack(this._pendingSelectedVideoTrack),this._pendingSelectedVideoTrack=null)},s._onPlayFailed=function(e){this._firstPlay&&this._config.playback.autoplay&&(this._posterManager.show(),this.dispatchEvent(new E(Q.AUTOPLAY_FAILED,e.payload)))},s._onEnded=function(){this.paused||this._pause()},s._resetStateFlags=function(){this._loading=!1,this._firstPlay=!0,this._loadingMedia=!1,this._playbackStart=!1,this._firstPlaying=!1},s._calcRatio=function(e,t){if(void 0!==t.ratio&&(this._aspectRatio=t.ratio),this._aspectRatio){var n=this._aspectRatio.split(":").map((function(e){return Number(e)})),i=n[0],r=n[1];if(t.width||!t.width&&!t.height){var a=r/i*e.clientWidth;e.style.height=a+"px"}else if(t.height&&!t.width){var o=i/r*e.clientHeight;e.style.width=o+"px"}}},s._onTracksChanged=function(e){this._updateTracks(e.payload.tracks),this.dispatchEvent(e)},s._updateTracks=function(e){i._logger.debug("Tracks changed",e),this._tracks=e.concat(this._externalCaptionsHandler.getExternalTracks(e)),this._applyABRRestriction(this._config),this._addTextTrackOffOption(),this._maybeSetTracksLabels(),this._setDefaultTracks()},s._getTracksByType=function(e){return this._tracks.reduce((function(t,n){return n instanceof e&&n.available&&t.push(n),t}),[])},s._getImageTracks=function(){return this._getTracksByType(gt)},s._getTextTracks=function(){return this._getTracksByType(tt)},s._getVideoTracks=function(){return this._getTracksByType(ce)},s._getAudioTracks=function(){return this._getTracksByType(ue)},s._markActiveTrack=function(e){var t;if(e instanceof ce?t=this._getVideoTracks():e instanceof ue?t=this._getAudioTracks():e instanceof tt&&(t=this._getTextTracks()),t)for(var n=0;n<t.length;n++)t[n].active=e.index===t[n].index},s._onCueChange=function(e){i._logger.debug("Text cue changed",e.payload.cues);try{this._activeTextCues=e.payload.cues.filter((function(e,t,n){var i=n[t-1];return!i||!(e.startTime===i.startTime&&e.endTime===i.endTime&&e.text.trim()===i.text.trim())}))}catch(t){this._activeTextCues=e.payload.cues}this._updateCueDisplaySettings(),this._updateTextDisplay(this._activeTextCues),this.dispatchEvent(e)},s._updateCueDisplaySettings=function(){for(var e=this._activeTextCues,t=this._textDisplaySettings,n=0;n<e.length;n++){var i=e[n];for(var r in t)t[r]&&(i[r]=t[r])}},s._updateTextDisplay=function(e){this._config.text.useNativeTextTrack||this._config.text.useShakaTextTrackDisplay||function(e,t,n,i){if(!e||!t||!n)return null;for(;n.firstChild;)n.removeChild(n.firstChild);var r=e.document.createElement("div");if(r.style.position="absolute",r.style.left="0",r.style.right="0",r.style.top="0",r.style.bottom="0",r.style.margin="1.5%",n.appendChild(r),function(e){for(var t=0;t<e.length;t++)if(e[t].hasBeenReset||!e[t].displayState)return!0;return!1}(t)){var a=[],o=Ne.getSimpleBoxPosition(r),s=o.height<o.width?o.height:o.width,c={font:1*(Math.round(.058*s*100)/100)*i.implicitFontScale+"px "+i.fontFamily,color:Ee.toRGBA(i.fontColor,i.fontOpacity),backgroundColor:Ee.toRGBA(i.backgroundColor,i.backgroundOpacity),textShadow:i.getTextShadow()};!function(){for(var n,i,s=0;s<t.length;s++)i=t[s],n=new Oe(e,i,c),r.appendChild(n.div),xe(0,n,o,a),i.displayState=n.div,a.push(Ne.getSimpleBoxPosition(n))}()}else for(var u=0;u<t.length;u++)r.appendChild(t[u].displayState)}(window,e,this._textDisplayEl,this._textStyle)},s._addTextTrackOffOption=function(){var e=this._getTextTracks();e&&e.length&&this._tracks.push(new tt({active:!1,kind:tt.KIND.SUBTITLES,label:"Off",language:zn}))},s._setDefaultTracks=function(){var e=this.getActiveTracks(),t=this._getTextTracks().find((function(e){return e.default})),n=this.config.playback,i=this._getTextTracks().find((function(e){return tt.langComparer(zn,e.language)})),r=this._getLanguage(this._getTextTracks(),n.textLanguage,t),a=this._playbackAttributesState.textLanguage&&this._playbackAttributesState.textLanguage!==zn?this._playbackAttributesState.textLanguage:r,o=this._playbackAttributesState.audioLanguage||this._getLanguage(this._getAudioTracks(),n.audioLanguage,e.audio);a===n.textLanguage?this._setDefaultTrack(this._getTextTracks(),a,i,n.additionalTextLanguage):this._setDefaultTrack(this._getTextTracks(),a,i),o===n.audioLanguage?this._setDefaultTrack(this._getAudioTracks(),o,e.audio,n.additionalAudioLanguage):this._setDefaultTrack(this._getAudioTracks(),o,e.audio),this._setDefaultVideoTrack()},s._getLanguage=function(e,t,n){var i=t;if("auto"===i){var r=e.find((function(e){return oe.langComparer(J.language,e.language)}));r?i=r.language:n&&n.language!==zn?i=n.language:e&&e.length>0&&(i=e[0].language)}return i},s._setDefaultTrack=function(e,t,n,i){var r=this,a=function(e){r.selectTrack(e),r._markActiveTrack(e)},o=e.find((function(e){return oe.langComparer(t,e.language,i,!0)}));if(o)a(o);else{var s=e.find((function(e){return oe.langComparer(t,e.language,i,!1)}));s?a(s):n&&!n.active&&this.selectTrack(n)}},s._setDefaultVideoTrack=function(){var e=this,t=this._getVideoTracks().sort((function(e,t){return t.bandwidth-e.bandwidth})),n=t.find((function(t){var n;return t.label&&t.label===(null==(n=e._playbackAttributesState.videoTrack)?void 0:n.label)}));n||(n=t.find((function(t){var n;return t.height&&t.height===(null==(n=e._playbackAttributesState.videoTrack)?void 0:n.height)}))),n&&this.selectTrack(n)},s._maybeSetTracksLabels=function(){var e=this._config.customLabels;if(e)for(var t in e){if(!Object.prototype.hasOwnProperty.call(e,t))return;switch(t){case Dn:this._setTracksCustomLabels(this._getVideoTracks(),e[t]);break;case Cn:this._setTracksCustomLabels(this._getAudioTracks(),e[t]);break;case Rn:this._setTracksCustomLabels(this._getTextTracks(),e[t])}}},s._setTracksCustomLabels=function(e,t){e.forEach((function(e){var n=t(V.copyDeep(e));n&&(e.label=n)}))},r=i,o=[{key:"_defaultConfig",get:function(){return V.copyDeep(ht)}}],(a=[{key:"videoHeight",get:function(){return this._engine?this._engine.videoHeight:null}},{key:"videoWidth",get:function(){return this._engine?this._engine.videoWidth:null}},{key:"buffered",get:function(){return this._engine?this._engine.buffered:null}},{key:"stats",get:function(){var e={targetBuffer:NaN,availableBuffer:NaN};return this._engine&&(e.targetBuffer=this._engine.targetBuffer,e.availableBuffer=this._engine.availableBuffer),e}},{key:"currentTime",set:function(e){this._playbackMiddleware.setCurrentTime(e,this._setCurrentTime.bind(this))},get:function(){return this._engine?this._engine.currentTime:null}},{key:"duration",get:function(){return this._engine?this._engine.duration:null}},{key:"liveDuration",get:function(){return this._engine?this._engine.liveDuration:null}},{key:"volume",set:function(e){if(this._engine&&(B.isFloat(e)||0===e||1===e)){var t=e;t<0&&(t=0),t>1&&(t=1),this._engine.volume=t}},get:function(){return this._engine?this._engine.volume:null}},{key:"paused",get:function(){return this._engine?this._engine.paused:null}},{key:"seeking",get:function(){return this._engine?this._engine.seeking:null}},{key:"playsinline",set:function(e){this._engine&&(this._engine.playsinline=e)},get:function(){return this._engine?this._engine.playsinline:null}},{key:"muted",set:function(e){this._engine&&(this._engine.muted=e,this.dispatchEvent(new E(Q.MUTE_CHANGE,{mute:e})),!1===e&&(this._fallbackToMutedAutoPlay=e))},get:function(){return this._engine?this._engine.muted:null}},{key:"src",get:function(){return this._engine?this._engine.src:null}},{key:"dimensions",set:function(e){var t=this._getTargetElement();if(!e||V.isEmptyObject(e))this._aspectRatio=null,t.style.width=null,t.style.height=null;else{var n=V.mergeDeep(this.dimensions,e),i=n.height,r=n.width;t.style.width="number"==typeof r?r+"px":r,t.style.height="number"==typeof i?i+"px":i,this._calcRatio(t,e)}},get:function(){return{width:this._el.clientWidth,height:this._el.clientHeight}}},{key:"poster",get:function(){return this._posterManager.src}},{key:"playbackRate",set:function(e){this._engine&&(this._engine.playbackRate=e)},get:function(){return this._engine?this._engine.playbackRate:null}},{key:"playbackRates",get:function(){return this._playbackRates?this._playbackRates:this._engine?this._engine.playbackRates:[]}},{key:"defaultPlaybackRate",get:function(){return this._engine?this._engine.defaultPlaybackRate:1}},{key:"engineType",get:function(){return this._engineType}},{key:"streamType",get:function(){return this._streamType}},{key:"env",get:function(){return this._env}},{key:"config",get:function(){return V.mergeDeep({},this._config)}},{key:"sources",get:function(){return V.mergeDeep({},this._sources)}},{key:"hasUserInteracted",get:function(){return this._hasUserInteracted}},{key:"loadingMedia",set:function(e){this._loadingMedia=e}},{key:"crossOrigin",set:function(e){this._engine&&(this._engine.crossOrigin=e)},get:function(){return this._engine?this._engine.crossOrigin:null}},{key:"ended",get:function(){return this._engine?this._engine.ended:null}},{key:"playbackMiddleware",get:function(){return this._playbackMiddleware}},{key:"posterManager",get:function(){return this._posterManager}},{key:"textDisplaySetting",get:function(){return V.copyDeep(this._textDisplaySettings)}},{key:"textStyle",set:function(e){if(!(e instanceof Ee))throw new Error("Style must be instance of TextStyle");var t=j.getElementBySelector("."+this._playerId+".playkit-subtitles-style");t||(t=j.createElement("style"),j.addClassName(t,this._playerId),j.addClassName(t,"playkit-subtitles-style"),j.appendChild(document.head,t));for(var n=t.sheet;n.cssRules.length;)n.deleteRule(0);try{this._textStyle=e,this._config.text.useNativeTextTrack?n.insertRule("#"+this._playerId+" video.playkit-engine::cue { "+e.toCSS()+" }",0):this._engine&&(this._engine.resetAllCues(),this._externalCaptionsHandler.resetAllCues(),this._updateTextDisplay(this._activeTextCues)),this.dispatchEvent(new E(Q.TEXT_STYLE_CHANGED))}catch(e){i._logger.error(e.message)}},get:function(){return this._textStyle.clone()}},{key:"Event",get:function(){return Z}},{key:"TextStyle",get:function(){return Ee}},{key:"State",get:function(){return ne}},{key:"Track",get:function(){return nt}},{key:"LogLevelType",get:function(){return y}},{key:"LogLevel",get:function(){return T}},{key:"AbrMode",get:function(){return ot}},{key:"MediaType",get:function(){return at}},{key:"StreamType",get:function(){return it}},{key:"EngineType",get:function(){return rt}},{key:"CorsType",get:function(){return st}},{key:"AdBreakType",get:function(){return fn}},{key:"AdTagType",get:function(){return gn}},{key:"Error",get:function(){return M}}])&&Yn(r.prototype,a),o&&Yn(r,o),i}(R);Kn(Xn,"_logger",C("Player"));var qn=function(){function e(e){this._name=e.getName(),this._getEngineDecorator=e.getEngineDecorator.bind(e)}var t=e.prototype;return t.getEngineDecorator=function(e,t){return this._getEngineDecorator(e,t)},t.getName=function(){return this._name},e}(),Qn={HLS:["application/x-mpegurl","application/vnd.apple.mpegurl"],DASH:["application/dash+xml"],PROGRESSIVE:["video/mp4"],SMOOTH_STREAMING:["application/vnd.ms-sstr+xml"]},Zn="0.82.1",$n="@playkit-js/playkit-js";function Jn(e){return new Xn(e||{})}var ei=Xn.getCapabilities,ti=Xn.setCapabilities;t.default=Jn}])}));
//# sourceMappingURL=playkit.js.map