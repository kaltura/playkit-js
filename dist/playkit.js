!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("core",[],t):"object"==typeof exports?exports.core=t():(e.playkit=e.playkit||{},e.playkit.core=t())}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=8)}([function(e,t,n){var r;
/*!
 * UAParser.js v0.7.21
 * Lightweight JavaScript-based User-Agent string parser
 * https://github.com/faisalman/ua-parser-js
 *
 * Copyright Â© 2012-2019 Faisal Salman <f@faisalman.com>
 * Licensed under MIT License
 */!function(i,a){"use strict";var o="model",s="name",u="type",c="vendor",l="version",f="mobile",d="tablet",h="smarttv",A={extend:function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2==0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},_={rgx:function(e,t){for(var n,r,i,a,o,s,u=0;u<t.length&&!o;){var c=t[u],l=t[u+1];for(n=r=0;n<c.length&&!o;)if(o=c[n++].exec(e))for(i=0;i<l.length;i++)s=o[++r],"object"==typeof(a=l[i])&&a.length>0?2==a.length?"function"==typeof a[1]?this[a[0]]=a[1].call(this,s):this[a[0]]=a[1]:3==a.length?"function"!=typeof a[1]||a[1].exec&&a[1].test?this[a[0]]=s?s.replace(a[1],a[2]):void 0:this[a[0]]=s?a[1].call(this,s,a[2]):void 0:4==a.length&&(this[a[0]]=s?a[3].call(this,s.replace(a[1],a[2])):void 0):this[a]=s||void 0;u+=2}},str:function(e,t){for(var n in t)if("object"==typeof t[n]&&t[n].length>0){for(var r=0;r<t[n].length;r++)if(A.has(t[n][r],e))return"?"===n?void 0:n}else if(A.has(t[n],e))return"?"===n?void 0:n;return e}},p={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},y={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[s,l],[/(opios)[\/\s]+([\w\.]+)/i],[[s,"Opera Mini"],l],[/\s(opr)\/([\w\.]+)/i],[[s,"Opera"],l],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(bidubrowser|baidubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[s,l],[/(konqueror)\/([\w\.]+)/i],[[s,"Konqueror"],l],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[s,"IE"],l],[/(edge|edgios|edga|edg)\/((\d+)?[\w\.]+)/i],[[s,"Edge"],l],[/(yabrowser)\/([\w\.]+)/i],[[s,"Yandex"],l],[/(Avast)\/([\w\.]+)/i],[[s,"Avast Secure Browser"],l],[/(AVG)\/([\w\.]+)/i],[[s,"AVG Secure Browser"],l],[/(puffin)\/([\w\.]+)/i],[[s,"Puffin"],l],[/(focus)\/([\w\.]+)/i],[[s,"Firefox Focus"],l],[/(opt)\/([\w\.]+)/i],[[s,"Opera Touch"],l],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[s,"UCBrowser"],l],[/(comodo_dragon)\/([\w\.]+)/i],[[s,/_/g," "],l],[/(windowswechat qbcore)\/([\w\.]+)/i],[[s,"WeChat(Win) Desktop"],l],[/(micromessenger)\/([\w\.]+)/i],[[s,"WeChat"],l],[/(brave)\/([\w\.]+)/i],[[s,"Brave"],l],[/(qqbrowserlite)\/([\w\.]+)/i],[s,l],[/(QQ)\/([\d\.]+)/i],[s,l],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[s,l],[/(baiduboxapp)[\/\s]?([\w\.]+)/i],[s,l],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[s,l],[/(MetaSr)[\/\s]?([\w\.]+)/i],[s],[/(LBBROWSER)/i],[s],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[l,[s,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[l,[s,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[s,l],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[l,[s,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[s,/(.+)/,"$1 WebView"],l],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[s,/(.+(?:g|us))(.+)/,"$1 $2"],l],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[l,[s,"Android Browser"]],[/(sailfishbrowser)\/([\w\.]+)/i],[[s,"Sailfish Browser"],l],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[s,l],[/(dolfin)\/([\w\.]+)/i],[[s,"Dolphin"],l],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[s,"360 Browser"]],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[s,"Chrome"],l],[/(coast)\/([\w\.]+)/i],[[s,"Opera Coast"],l],[/fxios\/([\w\.-]+)/i],[l,[s,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[l,[s,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[l,s],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[s,"GSA"],l],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[s,[l,_.str,p.browser.oldsafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[s,l],[/(navigator|netscape)\/([\w\.-]+)/i],[[s,"Netscape"],l],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[s,l]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",A.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/windows\s(ce|mobile);\sppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[["architecture",/ower/,"",A.lowerize]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[["architecture",A.lowerize]]],device:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[o,c,[u,d]],[/applecoremedia\/[\w\.]+ \((ipad)/],[o,[c,"Apple"],[u,d]],[/(apple\s{0,1}tv)/i],[[o,"Apple TV"],[c,"Apple"],[u,h]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[c,o,[u,d]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[o,[c,"Amazon"],[u,d]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[o,_.str,p.device.amazon.model],[c,"Amazon"],[u,f]],[/android.+aft([bms])\sbuild/i],[o,[c,"Amazon"],[u,h]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[o,c,[u,f]],[/\((ip[honed|\s\w*]+);/i],[o,[c,"Apple"],[u,f]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[c,o,[u,f]],[/\(bb10;\s(\w+)/i],[o,[c,"BlackBerry"],[u,f]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[o,[c,"Asus"],[u,d]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[c,"Sony"],[o,"Xperia Tablet"],[u,d]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[o,[c,"Sony"],[u,f]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[c,o,[u,"console"]],[/android.+;\s(shield)\sbuild/i],[o,[c,"Nvidia"],[u,"console"]],[/(playstation\s[34portablevi]+)/i],[o,[c,"Sony"],[u,"console"]],[/(sprint\s(\w+))/i],[[c,_.str,p.device.sprint.vendor],[o,_.str,p.device.sprint.model],[u,f]],[/(htc)[;_\s-]+([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[c,[o,/_/g," "],[u,f]],[/(nexus\s9)/i],[o,[c,"HTC"],[u,d]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p|vog-l29|ane-lx1|eml-l29)/i],[o,[c,"Huawei"],[u,f]],[/android.+(bah2?-a?[lw]\d{2})/i],[o,[c,"Huawei"],[u,d]],[/(microsoft);\s(lumia[\s\w]+)/i],[c,o,[u,f]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[o,[c,"Microsoft"],[u,"console"]],[/(kin\.[onetw]{3})/i],[[o,/\./g," "],[c,"Microsoft"],[u,f]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[o,[c,"Motorola"],[u,f]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[o,[c,"Motorola"],[u,d]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[c,A.trim],[o,A.trim],[u,h]],[/hbbtv.+maple;(\d+)/i],[[o,/^/,"SmartTV"],[c,"Samsung"],[u,h]],[/\(dtv[\);].+(aquos)/i],[o,[c,"Sharp"],[u,h]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[c,"Samsung"],o,[u,d]],[/smart-tv.+(samsung)/i],[c,[u,h],o],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[c,"Samsung"],o,[u,f]],[/sie-(\w*)/i],[o,[c,"Siemens"],[u,f]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[c,"Nokia"],o,[u,f]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[o,[c,"Acer"],[u,d]],[/android.+([vl]k\-?\d{3})\s+build/i],[o,[c,"LG"],[u,d]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[c,"LG"],o,[u,d]],[/(lg) netcast\.tv/i],[c,o,[u,h]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[o,[c,"LG"],[u,f]],[/(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i],[c,o,[u,d]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[o,[c,"Lenovo"],[u,d]],[/(lenovo)[_\s-]?([\w-]+)/i],[c,o,[u,f]],[/linux;.+((jolla));/i],[c,o,[u,f]],[/((pebble))app\/[\d\.]+\s/i],[c,o,[u,"wearable"]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[c,o,[u,f]],[/crkey/i],[[o,"Chromecast"],[c,"Google"],[u,h]],[/android.+;\s(glass)\s\d/i],[o,[c,"Google"],[u,"wearable"]],[/android.+;\s(pixel c)[\s)]/i],[o,[c,"Google"],[u,d]],[/android.+;\s(pixel( [23])?( xl)?)[\s)]/i],[o,[c,"Google"],[u,f]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:a\d|one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[o,/_/g," "],[c,"Xiaomi"],[u,f]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[o,/_/g," "],[c,"Xiaomi"],[u,d]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[o,[c,"Meizu"],[u,f]],[/(mz)-([\w-]{2,})/i],[[c,"Meizu"],o,[u,f]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})[\s)]/i],[o,[c,"OnePlus"],[u,f]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[o,[c,"RCA"],[u,d]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[o,[c,"Dell"],[u,d]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[o,[c,"Verizon"],[u,d]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[c,"Barnes & Noble"],o,[u,d]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[o,[c,"NuVision"],[u,d]],[/android.+;\s(k88)\sbuild/i],[o,[c,"ZTE"],[u,d]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[o,[c,"Swiss"],[u,f]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[o,[c,"Swiss"],[u,d]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[o,[c,"Zeki"],[u,d]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[c,"Dragon Touch"],o,[u,d]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[o,[c,"Insignia"],[u,d]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[o,[c,"NextBook"],[u,d]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[c,"Voice"],o,[u,f]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[c,"LvTel"],o,[u,f]],[/android.+;\s(PH-1)\s/i],[o,[c,"Essential"],[u,f]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[o,[c,"Envizen"],[u,d]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[c,o,[u,d]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[o,[c,"MachSpeed"],[u,d]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[c,o,[u,d]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[o,[c,"Rotor"],[u,d]],[/android.+(KS(.+))\s+build/i],[o,[c,"Amazon"],[u,d]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[c,o,[u,d]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[u,A.lowerize],c,o],[/[\s\/\(](smart-?tv)[;\)]/i],[[u,h]],[/(android[\w\.\s\-]{0,9});.+build/i],[o,[c,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[l,[s,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[l,[s,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[s,l],[/rv\:([\w\.]{1,9}).+(gecko)/i],[l,s]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[s,l],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[s,[l,_.str,p.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[s,"Windows"],[l,_.str,p.os.windows.version]],[/\((bb)(10);/i],[[s,"BlackBerry"],l],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i],[s,l],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[s,"Symbian"],l],[/\((series40);/i],[s],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[s,"Firefox OS"],l],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[s,l],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[s,"Chromium OS"],l],[/(sunos)\s?([\w\.\d]*)/i],[[s,"Solaris"],l],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[s,l],[/(haiku)\s(\w+)/i],[s,l],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[l,/_/g,"."],[s,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[s,"Mac OS"],[l,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[s,l]]},g=function(e,t){if("object"==typeof e&&(t=e,e=void 0),!(this instanceof g))return new g(e,t).getResult();var n=e||(i&&i.navigator&&i.navigator.userAgent?i.navigator.userAgent:""),r=t?A.extend(y,t):y;return this.getBrowser=function(){var e={name:void 0,version:void 0};return _.rgx.call(e,n,r.browser),e.major=A.major(e.version),e},this.getCPU=function(){var e={architecture:void 0};return _.rgx.call(e,n,r.cpu),e},this.getDevice=function(){var e={vendor:void 0,model:void 0,type:void 0};return _.rgx.call(e,n,r.device),e},this.getEngine=function(){var e={name:void 0,version:void 0};return _.rgx.call(e,n,r.engine),e},this.getOS=function(){var e={name:void 0,version:void 0};return _.rgx.call(e,n,r.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n=e,this},this};g.VERSION="0.7.21",g.BROWSER={NAME:s,MAJOR:"major",VERSION:l},g.CPU={ARCHITECTURE:"architecture"},g.DEVICE={MODEL:o,VENDOR:c,TYPE:u,CONSOLE:"console",MOBILE:f,SMARTTV:h,TABLET:d,WEARABLE:"wearable",EMBEDDED:"embedded"},g.ENGINE={NAME:s,VERSION:l},g.OS={NAME:s,VERSION:l},void 0!==t?(void 0!==e&&e.exports&&(t=e.exports=g),t.UAParser=g):void 0===(r=function(){return g}.call(t,n,t,e))||(e.exports=r);var v=i&&(i.jQuery||i.Zepto);if(v&&!v.ua){var E=new g;v.ua=E.getResult(),v.ua.get=function(){return E.getUA()},v.ua.set=function(e){E.setUA(e);var t=E.getResult();for(var n in t)v.ua[n]=t[n]}}}("object"==typeof window?window:this)},function(e,t,n){var r,i;
/*!
 * js-logger - http://github.com/jonnyreeves/js-logger
 * Jonny Reeves, http://jonnyreeves.co.uk/
 * js-logger may be freely distributed under the MIT license.
 */!function(a){"use strict";var o,s={};s.VERSION="1.6.0";var u={},c=function(e,t){return function(){return t.apply(e,arguments)}},l=function(){var e,t,n=arguments,r=n[0];for(t=1;t<n.length;t++)for(e in n[t])!(e in r)&&n[t].hasOwnProperty(e)&&(r[e]=n[t][e]);return r},f=function(e,t){return{value:e,name:t}};s.TRACE=f(1,"TRACE"),s.DEBUG=f(2,"DEBUG"),s.INFO=f(3,"INFO"),s.TIME=f(4,"TIME"),s.WARN=f(5,"WARN"),s.ERROR=f(8,"ERROR"),s.OFF=f(99,"OFF");var d=function(e){this.context=e,this.setLevel(e.filterLevel),this.log=this.info};d.prototype={setLevel:function(e){e&&"value"in e&&(this.context.filterLevel=e)},getLevel:function(){return this.context.filterLevel},enabledFor:function(e){var t=this.context.filterLevel;return e.value>=t.value},trace:function(){this.invoke(s.TRACE,arguments)},debug:function(){this.invoke(s.DEBUG,arguments)},info:function(){this.invoke(s.INFO,arguments)},warn:function(){this.invoke(s.WARN,arguments)},error:function(){this.invoke(s.ERROR,arguments)},time:function(e){"string"==typeof e&&e.length>0&&this.invoke(s.TIME,[e,"start"])},timeEnd:function(e){"string"==typeof e&&e.length>0&&this.invoke(s.TIME,[e,"end"])},invoke:function(e,t){o&&this.enabledFor(e)&&o(t,l({level:e},this.context))}};var h,A=new d({filterLevel:s.OFF});(h=s).enabledFor=c(A,A.enabledFor),h.trace=c(A,A.trace),h.debug=c(A,A.debug),h.time=c(A,A.time),h.timeEnd=c(A,A.timeEnd),h.info=c(A,A.info),h.warn=c(A,A.warn),h.error=c(A,A.error),h.log=h.info,s.setHandler=function(e){o=e},s.setLevel=function(e){for(var t in A.setLevel(e),u)u.hasOwnProperty(t)&&u[t].setLevel(e)},s.getLevel=function(){return A.getLevel()},s.get=function(e){return u[e]||(u[e]=new d(l({name:e},A.context)))},s.createDefaultHandler=function(e){(e=e||{}).formatter=e.formatter||function(e,t){t.name&&e.unshift("["+t.name+"]")};var t={},n=function(e,t){Function.prototype.apply.call(e,console,t)};return"undefined"==typeof console?function(){}:function(r,i){r=Array.prototype.slice.call(r);var a,o=console.log;i.level===s.TIME?(a=(i.name?"["+i.name+"] ":"")+r[0],"start"===r[1]?console.time?console.time(a):t[a]=(new Date).getTime():console.timeEnd?console.timeEnd(a):n(o,[a+": "+((new Date).getTime()-t[a])+"ms"])):(i.level===s.WARN&&console.warn?o=console.warn:i.level===s.ERROR&&console.error?o=console.error:i.level===s.INFO&&console.info?o=console.info:i.level===s.DEBUG&&console.debug?o=console.debug:i.level===s.TRACE&&console.trace&&(o=console.trace),e.formatter(r,i),n(o,r))}},s.useDefaults=function(e){s.setLevel(e&&e.defaultLevel||s.DEBUG),s.setHandler(s.createDefaultHandler(e))},void 0===(i="function"==typeof(r=s)?r.call(t,n,t,e):r)||(e.exports=i)}()},function(e){e.exports=JSON.parse('{"heartbeatTimeout":30000}')},function(e){e.exports=JSON.parse('{"a":"data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAC721kYXQhEAUgpBv/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA3pwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcCEQBSCkG//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADengAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAsJtb292AAAAbG12aGQAAAAAAAAAAAAAAAAAAAPoAAAALwABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAB7HRyYWsAAABcdGtoZAAAAAMAAAAAAAAAAAAAAAIAAAAAAAAALwAAAAAAAAAAAAAAAQEAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAAC8AAAAAAAEAAAAAAWRtZGlhAAAAIG1kaGQAAAAAAAAAAAAAAAAAAKxEAAAIAFXEAAAAAAAtaGRscgAAAAAAAAAAc291bgAAAAAAAAAAAAAAAFNvdW5kSGFuZGxlcgAAAAEPbWluZgAAABBzbWhkAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAADTc3RibAAAAGdzdHNkAAAAAAAAAAEAAABXbXA0YQAAAAAAAAABAAAAAAAAAAAAAgAQAAAAAKxEAAAAAAAzZXNkcwAAAAADgICAIgACAASAgIAUQBUAAAAAAfQAAAHz+QWAgIACEhAGgICAAQIAAAAYc3R0cwAAAAAAAAABAAAAAgAABAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAIAAAABAAAAHHN0c3oAAAAAAAAAAAAAAAIAAAFzAAABdAAAABRzdGNvAAAAAAAAAAEAAAAsAAAAYnVkdGEAAABabWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAtaWxzdAAAACWpdG9vAAAAHWRhdGEAAAABAAAAAExhdmY1Ni40MC4xMDE="}')},function(e,t,n){var r=n(5),i=n(6);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var a={insert:"head",singleton:!1};r(i,a);e.exports=i.locals||{}},function(e,t,n){"use strict";var r,i=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},a=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),o=[];function s(e){for(var t=-1,n=0;n<o.length;n++)if(o[n].identifier===e){t=n;break}return t}function u(e,t){for(var n={},r=[],i=0;i<e.length;i++){var a=e[i],u=t.base?a[0]+t.base:a[0],c=n[u]||0,l="".concat(u," ").concat(c);n[u]=c+1;var f=s(l),d={css:a[1],media:a[2],sourceMap:a[3]};-1!==f?(o[f].references++,o[f].updater(d)):o.push({identifier:l,updater:p(d,t),references:1}),r.push(l)}return r}function c(e){var t=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var i=n.nc;i&&(r.nonce=i)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(t);else{var o=a(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var l,f=(l=[],function(e,t){return l[e]=t,l.filter(Boolean).join("\n")});function d(e,t,n,r){var i=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=f(t,i);else{var a=document.createTextNode(i),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(a,o[t]):e.appendChild(a)}}function h(e,t,n){var r=n.css,i=n.media,a=n.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),a&&btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var A=null,_=0;function p(e,t){var n,r,i;if(t.singleton){var a=_++;n=A||(A=c(t)),r=d.bind(null,n,a,!1),i=d.bind(null,n,a,!0)}else n=c(t),r=h.bind(null,n,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=i());var n=u(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<n.length;r++){var i=s(n[r]);o[i].references--}for(var a=u(e,t),c=0;c<n.length;c++){var l=s(n[c]);0===o[l].references&&(o[l].updater(),o.splice(l,1))}n=a}}}},function(e,t,n){(t=n(7)(!1)).push([e.i,".playkit-container {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  color: #fff;\n  outline: none;\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n}\n\n.playkit-engine {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  object-fit: contain;\n}\n\n.playkit-engine video::-webkit-media-controls-panel,\n.playkit-engine video::-webkit-media-controls-panel-container,\n.playkit-engine video::-webkit-media-controls-start-playback-button,\n.playkit-engine video::-webkit-media-controls-play-button {\n  display: none;\n  -webkit-appearance: none;\n}\n\n.playkit-poster {\n  position: absolute;\n  display: block;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background-size: contain;\n  background-position: center center;\n  background-repeat: no-repeat;\n  background-color: #000;\n}\n\n.playkit-subtitles {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  left: 0;\n}\n\n.playkit-black-cover {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  background-color: black;\n}\n\n.playkit-size-iframe {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  border: 0;\n  z-index: -100;\n}\n\n.playkit-in-browser-fullscreen-mode {\n  width: 100% !important;\n  height: 100% !important;\n  position: fixed !important;\n  top: 0 !important;\n  left: 0 !important;\n  /*added for blocking element with fixed position which could be on the top of the player */\n  z-index: 999999 !important;\n}\n",""]),e.exports=t},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var i=(o=r,s=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),u="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(u," */")),a=r.sources.map((function(e){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(e," */")}));return[n].concat(a).concat([i]).join("\n")}var o,s,u;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,r){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(r)for(var a=0;a<this.length;a++){var o=this[a][0];null!=o&&(i[o]=!0)}for(var s=0;s<e.length;s++){var u=[].concat(e[s]);r&&i[u[0]]||(n&&(u[2]?u[2]="".concat(n," and ").concat(u[2]):u[2]=n),t.push(u))}},t}},function(e,t,n){"use strict";n.r(t),n.d(t,"loadPlayer",(function(){return gi})),n.d(t,"registerMediaSourceAdapter",(function(){return xn})),n.d(t,"BaseMediaSourceAdapter",(function(){return nn})),n.d(t,"registerEngineDecoratorProvider",(function(){return Zr})),n.d(t,"BaseMiddleware",(function(){return Mt})),n.d(t,"Track",(function(){return ye})),n.d(t,"VideoTrack",(function(){return Se})),n.d(t,"AudioTrack",(function(){return Pe})),n.d(t,"TextTrack",(function(){return Be})),n.d(t,"TextStyle",(function(){return Ye})),n.d(t,"Utils",(function(){return r})),n.d(t,"utils",(function(){return r})),n.d(t,"Error",(function(){return G})),n.d(t,"FakeEvent",(function(){return m})),n.d(t,"FakeEventTarget",(function(){return T})),n.d(t,"EventManager",(function(){return I})),n.d(t,"VERSION",(function(){return pi})),n.d(t,"NAME",(function(){return yi})),n.d(t,"Env",(function(){return _})),n.d(t,"State",(function(){return le})),n.d(t,"getCapabilities",(function(){return vi})),n.d(t,"setCapabilities",(function(){return Ei})),n.d(t,"registerEngine",(function(){return fr})),n.d(t,"unRegisterEngine",(function(){return dr})),n.d(t,"AdBreakType",(function(){return Rr})),n.d(t,"AdTagType",(function(){return Cr})),n.d(t,"AdEventType",(function(){return re})),n.d(t,"Html5EventType",(function(){return ie})),n.d(t,"CustomEventType",(function(){return ae})),n.d(t,"EventType",(function(){return oe})),n.d(t,"StateType",(function(){return fe})),n.d(t,"TrackType",(function(){return Ot})),n.d(t,"EngineType",(function(){return It})),n.d(t,"MediaType",(function(){return Pt})),n.d(t,"StreamType",(function(){return Dt})),n.d(t,"AbrMode",(function(){return Nt})),n.d(t,"LogLevelType",(function(){return L})),n.d(t,"CorsType",(function(){return Lt})),n.d(t,"DrmScheme",(function(){return on})),n.d(t,"MimeType",(function(){return _i})),n.d(t,"RequestType",(function(){return Wt})),n.d(t,"getLogger",(function(){return F})),n.d(t,"LogLevel",(function(){return N})),n.d(t,"getLogLevel",(function(){return M})),n.d(t,"setLogLevel",(function(){return U}));var r={};n.r(r),n.d(r,"Number",(function(){return X})),n.d(r,"String",(function(){return q})),n.d(r,"Object",(function(){return Q})),n.d(r,"Generator",(function(){return Z})),n.d(r,"Dom",(function(){return $})),n.d(r,"Http",(function(){return J})),n.d(r,"VERSION",(function(){return ee})),n.d(r,"ResizeWatcher",(function(){return Ur}));var i=n(0),a=n.n(i),o=/^.*(web0s).*(smarttv).*$/i,s=/^.*(smart-tv).*(tizen).*$/i,u=/^.*(vidaa).*(smarttv).*$/i,c=[[s],[[a.a.BROWSER.NAME,"SAMSUNG_TV_BROWSER"],[a.a.BROWSER.MAJOR,""],[a.a.BROWSER.VERSION,""]]],l=[[o],[a.a.OS.NAME],[u],[a.a.OS.NAME]],f=[[o],[[a.a.DEVICE.VENDOR,"LG"],[a.a.DEVICE.TYPE,a.a.DEVICE.SMARTTV]],[s],[[a.a.DEVICE.VENDOR,"SAMSUNG"],[a.a.DEVICE.TYPE,a.a.DEVICE.SMARTTV]],[u],[[a.a.DEVICE.VENDOR,"HISENSE"],[a.a.DEVICE.TYPE,a.a.DEVICE.SMARTTV]],[/^.*(smart-tv|smarttv).*$/i],[[a.a.DEVICE.TYPE,a.a.DEVICE.SMARTTV]]],d=[[/(edg)\/((\d+)?[\w.]+)/i],[[a.a.BROWSER.NAME,"Edge"],a.a.BROWSER.VERSION,a.a.BROWSER.MAJOR]],h=[].concat(d,c),A=new a.a(void 0,{browser:h,device:f,os:l}).getResult();A.isConsole=A.device.type===a.a.DEVICE.CONSOLE,A.isSmartTV=A.device.type===a.a.DEVICE.SMARTTV,A.isMobile=A.device.type===a.a.DEVICE.MOBILE,A.isTablet=A.device.type===a.a.DEVICE.TABLET,A.isWearable=A.device.type===a.a.DEVICE.WEARABLE,A.isEmbedded=A.device.type===a.a.DEVICE.EMBEDDED,A.isIPadOS="Mac OS"===A.os.name&&"ontouchend"in document,A.isSafari=A.browser.name.includes("Safari"),A.isIOS="iOS"===A.os.name,A.isMacOS="Mac OS"===A.os.name;var _=A;function p(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var v=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._map=new Map}var t,n,r;return t=e,(n=[{key:"push",value:function(e,t){if(this._map.has(e)){var n=this._map.get(e);Array.isArray(n)&&(n.push(t),this._map.set(e,n))}else this._map.set(e,[t])}},{key:"set",value:function(e,t){this._map.set(e,t)}},{key:"has",value:function(e){return this._map.has(e)}},{key:"get",value:function(e){var t=this._map.get(e);return t?t.slice():[]}},{key:"getAll",value:function(){var e,t=[],n=p(this._map.values());try{for(n.s();!(e=n.n()).done;){var r=e.value;t=t.concat(r)}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"remove",value:function(e,t){if(this._map.has(e)){var n=this._map.get(e);if(Array.isArray(n))for(var r=0;r<n.length;++r)n[r]==t&&(n.splice(r,1),--r)}}},{key:"keys",value:function(){return this._map.keys()}},{key:"clear",value:function(){this._map.clear()}}])&&g(t.prototype,n),r&&g(t,r),e}();function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var m=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.bubbles=!1,this.cancelable=!1,this.defaultPrevented=!1,this.timeStamp=window.performance?window.performance.now():Date.now(),this.type=t,this.isTrusted=!1,this.currentTarget=null,this.target=null,this.stopped=!1,this.payload=n}var t,n,r;return t=e,(n=[{key:"preventDefault",value:function(){}},{key:"stopImmediatePropagation",value:function(){this.stopped=!0}},{key:"stopPropagation",value:function(){}}])&&E(t.prototype,n),r&&E(t,r),e}();function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var T=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._listeners=new v,this.dispatchTarget=this}var t,n,r;return t=e,(n=[{key:"addEventListener",value:function(e,t){this._listeners.push(e,t)}},{key:"removeEventListener",value:function(e,t){this._listeners.remove(e,t)}},{key:"dispatchEvent",value:function(e){for(var t=this._listeners.get(e.type)||[],n=0;n<t.length;++n){e.target=this.dispatchTarget,e.currentTarget=this.dispatchTarget;var r=t[n];try{r.handleEvent?r.handleEvent(e):r.call(this,e)}catch(e){}if(e.stopped)break}return e.defaultPrevented}}])&&b(t.prototype,n),r&&b(t,r),e}();function k(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function C(e,t,n){return t&&R(e.prototype,t),n&&R(e,n),e}var O=function(){function e(){w(this,e),this._bindingMap=new v}return C(e,[{key:"destroy",value:function(){return this.removeAll(),this._bindingMap=null,Promise.resolve()}},{key:"listenOnce",value:function(e,t,n,r){var i=this;this.listen(e,t,(function r(a){i.unlisten(e,t,r),n.call(i,a)}),r)}},{key:"listen",value:function(e,t,n,r){var i=new D(e,t,n,r);this._bindingMap&&this._bindingMap.push(t,i)}},{key:"unlisten",value:function(e,t,n){if(this._bindingMap)for(var r=this._bindingMap.get(t),i=0;i<r.length;++i){var a=r[i];a.target!==e||a.listener!==n&&n||(a.unlisten(),this._bindingMap&&this._bindingMap.remove(t,a))}}},{key:"removeAll",value:function(){if(this._bindingMap){var e,t=k(this._bindingMap.getAll());try{for(t.s();!(e=t.n()).done;){e.value.unlisten()}}catch(e){t.e(e)}finally{t.f()}this._bindingMap&&this._bindingMap.clear()}}}]),e}(),D=function(){function e(t,n,r,i){w(this,e),this.target=t,this.type=n,this.listener=r,this.options=i,this.target.addEventListener(n,r,!1)}return C(e,[{key:"unlisten",value:function(){this.target&&(this.target.removeEventListener(this.type,this.listener,this.options),this.target=null,this.listener=null,this.options=null)}}]),e}(),I=O,P=n(1),N={DEBUG:P.DEBUG,INFO:P.INFO,TIME:P.TIME,WARN:P.WARN,ERROR:P.ERROR,OFF:P.OFF},L={};function x(e){return e?P.get(e):P}function M(e){return x(e).getLevel()}function U(e,t){x(t).setLevel(e)}Object.keys(N).forEach((function(e){L[e]=e})),P.useDefaults({defaultLevel:P.ERROR});var F=x,j={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,UNKNOWN_DATA_URI_ENCODING:1005,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_CREATE_TEXT_CUE:2009,DASH_ADAPTER_ERROR_PARSE_ISSUE:2010,UNKNOWN_FILE_TYPE:2011,UNKNOWN_LANGUAGE:2012,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,HLS_FATAL_MEDIA_ERROR:3018,HLS_FRAG_PARSING_ERROR:3019,HLS_BUFFER_APPEND_ISSUE:3020,HLS_BUFFER_APPENDING_ISSUE:3021,NATIVE_ADAPTER_LOAD_FAILED:3022,HLS_BUFFER_STALLED_ERROR:3023,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,RESTRICTIONS_CANNOT_BE_MET:4012,NO_PERIODS:4014,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_COULD_NOT_GUESS_MIME_TYPE:4021,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_LIVE_CONTENT_NOT_SUPPORTED:4029,HLSJS_CANNOT_PARSE:4030,INVALID_STREAMS_CHOSEN:5005,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,BAD_FAIRPLAY_RESPONSE:6015,COULD_NOT_CREATE_MEDIA_KEYS:6016,COULD_NOT_CREATE_KEY_SESSION:6017,LOAD_INTERRUPTED:7e3,BITRATE_SWITCH_ISSUE:7001,LOAD_FAILED:7002,RUNTIME_ERROR_NOT_REGISTERED_PLUGIN:7003,RUNTIME_ERROR_METHOD_NOT_IMPLEMENTED:7004,RUNTIME_ERROR_NOT_VALID_HANDLER:7005,NO_SOURCE_PROVIDED:7006,NO_ENGINE_FOUND_TO_PLAY_THE_SOURCE:7007,ENTER_PICTURE_IN_PICTURE_FAILED:7008,EXIT_PICTURE_IN_PICTURE_FAILED:7009,PLUGIN_LOAD_FAILED:7010,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,STORE_ALREADY_IN_PROGRESS:9006,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,CONTENT_UNSUPPORTED_BY_BROWSER:9009,CANNOT_ADD_ITEM:9010,DOWNLOAD_FAILED:9011,COULD_NOT_GET_INFO_FROM_MEDIA_PROVIDER:9012,ENTRY_DOES_NOT_EXIST:9013,PAUSE_FAILED:9014,RESUME_FAILED:9015,RENEW_LICENSE_FAILED:9016,ENTRY_ALREADY_EXISTS:9017,REMOVE_FAILED:9018,CAST_LOAD_MEDIA_FAILED:10001,CAST_CUSTOM_MESSAGE_PARSING_ERROR:10002,CAST_EDIT_TRACKS_INFO_ERROR:10003,VR_NOT_SUPPORTED:11e3};Object.assign(j,{XML_PARSING_ERROR:8100,VAST_SCHEMA_VALIDATION_ERROR:8101,VAST_RESPONSE_VERSION_NOT_SUPPORTED:8102,TRAFFICKING_ERROR:8200,VAST_UNEXPECTED_LINEARITY:8201,VAST_UNEXPECTED_DURATION_ERROR:8202,VAST_UNEXPECTED_SIZE_ERROR:8203,VAST_WRAPPER_ERROR:8300,VAST_URI_ERROR:8301,VAST_TOO_MANY_REDIRECTS:8302,NO_ADS_VAST_RESPONSE:8303,GENERAL_LINEAR_ERROR:8400,FILE_NOT_FOUND:8401,VAST_MEDIA_LOAD_TIMEOUT:8402,MEDIA_FILE_NOT_FOUND:8403,MEDIA_FILE_DISPLAY_ERROR:8405,MEZZANINE_FILE_NOT_PROVIDED:8406,MEZZANINE_DOWNLOADED_FOR_THE_FIRST_TIME:8407,VAST_RESPONSE_AD_REJECTED:8408,CREATIVE_WAS_NOT_EXECUTED:8409,CODE_REFERENCED_NOT_EXECUTED:8410,GENERAL_NON_LINEAR_AD_ERROR:8500,NON_LINEAR_CREATIVE_DIMENSIONS_NOT_ALIGN_ERROR:8501,NON_LINEAR_FETCH_ERROR:8502,NON_LINEAR_RESOURCE_NOT_FOUND:8503,GENERAL_COMPANION_ADS_ERROR:8600,COMPANION_DIMENSIONS_NOT_FIT:8601,COMPANION_CANNOT_BE_DISPLAY:8602,COMPANION_CANNOT_BE_FETCHED:8603,COMPANION_TYPE_NOT_FOUND:8604,AD_UNDEFINED_ERROR:8900,GENERAL_VPAID_ERROR:8901});function B(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var G=function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};B(this,e),this.severity=t,this.category=n,this.code=r,this.data=i,M("Error")!==N.OFF&&e._logger.error("Category:".concat(n," | Code:").concat(r," |"),i)};V(G,"Severity",{RECOVERABLE:1,CRITICAL:2}),V(G,"Category",{NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,ADS:8,STORAGE:9,CAST:10,VR:11}),V(G,"Code",j),V(G,"_logger",F("Error"));function H(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||K(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function W(e){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function K(e,t){if(e){if("string"==typeof e)return z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?z(e,t):void 0}}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var X={isNumber:function(e){return Number(e)===e},isInt:function(e){return this.isNumber(e)&&e%1==0},isFloat:function(e){return this.isNumber(e)&&e%1!=0}},q={capitlize:function(e){return"string"!=typeof e?e:e.charAt(0).toUpperCase()+e.slice(1)},endsWith:function(e,t){return"string"==typeof e&&"string"==typeof t&&-1!=e.indexOf(t,e.length-t.length)}},Q={merge:function(e){var t,n={},r=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=K(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;Object.assign(n,i)}}catch(e){r.e(e)}finally{r.f()}return n},isObject:function(e){return e&&"object"===W(e)&&!Array.isArray(e)},mergeDeep:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(!n.length)return e;var i=n.shift();if(this.isObject(e)&&this.isObject(i))for(var a in i)this.isObject(i[a])?(e[a]||Object.assign(e,Y({},a,{})),this.mergeDeep(e[a],i[a])):Object.assign(e,Y({},a,i[a]));return this.mergeDeep.apply(this,[e].concat(n))},copyDeep:function(e){var t,n=this;return Array.isArray(e)?(t=e.length>0?e.slice(0):[]).forEach((function(e,r){("object"===W(e)&&e!=={}||Array.isArray(e)&&e.length>0)&&(t[r]=n.copyDeep(e))})):null!==e&&"object"===W(e)?e.clone&&"function"==typeof e.clone?t=e.clone():(t=Object.assign({__proto__:e.__proto__},e),Object.keys(t).forEach((function(e){("object"===W(t[e])&&t[e]!=={}||Array.isArray(t[e])&&t[e].length>0)&&(t[e]=n.copyDeep(t[e]))}))):t=e,t},isEmptyObject:function(e){for(var t in e)if(window.Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},getPropertyPath:function(e,t){return t.split(".").reduce((function(e,t){return null==e?e:e[t]}),e)},hasPropertyPath:function(e,t){if(!t)return!1;for(var n=t.split("."),r=0;r<n.length;r++){var i=n[r];if(!e||!window.Object.prototype.hasOwnProperty.call(e,i))return!1;e=e[i]}return!0},createPropertyPath:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=t.split("."),i=e;r.length>1;){var a=r,o=H(a),s=o[0],u=o.slice(1);r=u,void 0===i[s]&&(i[s]={}),i=i[s]}return i[r[0]]=n,e},deletePropertyPath:function(e,t){if(e&&t){for(var n=t.split("."),r=0;r<n.length-1;r++)if(void 0===(e=e[n[r]]))return;delete e[n.pop()]}},defer:function(){var e,t,n=new Promise((function(n,r){e=n,t=r}));return n.resolve=e,n.reject=t,n},bind:function(e,t){return function(){t.apply(e,arguments)}}},Z={uniqueId:function(e){var t=2+(!e||e<0?0:e-2);return"_"+Math.random().toString(36).substr(2,t)},guid:function(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},$={addClassName:function(e,t){e.classList?e.classList.add(t):$.hasClassName(e,t)||(e.className+=t)},removeClassName:function(e,t){e.classList?e.classList.remove(t):$.hasClassName(e,t)&&(e.className=e.className.replace(new RegExp("(\\s|^)"+t+"(\\s|$)")," ").replace(/^\s+|\s+$/g,""))},hasClassName:function(e,t){return e.className&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(e.className)},setAttribute:function(e,t,n){e.setAttribute(t,n)},removeAttribute:function(e,t){e.removeAttribute(t)},setStyle:function(e,t,n){void 0!==e.style.getPropertyValue(t)&&e.style.setProperty(t,n)},appendChild:function(e,t){e&&t&&e.appendChild&&e.appendChild(t)},removeChild:function(e,t){e&&t&&e.removeChild&&e.removeChild(t)},prependTo:function(e,t){t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)},getElementById:function(e){return document.getElementById(e)},getElementsByTagName:function(e){return document.getElementsByTagName(e)},createElement:function(e){return document.createElement(e)},loadStyleSheetAsync:function(e){var t=this;return new Promise((function(n,r){var i=!1,a=t.createElement("link");a.type="text/css",a.rel="stylesheet",a.href=e,a.async=!0,a.onload=a.onreadystatechange=function(){i||this.readyState&&"complete"!==this.readyState||(i=!0,n(this))},a.onerror=a.onabort=r,$.appendChild(document.head,a)}))},loadScriptAsync:function(e){var t=this;return new Promise((function(n,r){var i=!1,a=document.getElementsByTagName("script")[0],o=t.createElement("script");o.type="text/javascript",o.src=e,o.async=!0,o.onload=o.onreadystatechange=function(){i||this.readyState&&"complete"!==this.readyState||(i=!0,n(this))},o.onerror=o.onabort=r,a&&a.parentNode&&a.parentNode.insertBefore(o,a)}))},getElementBySelector:function(e){try{return document.querySelector(e)}catch(e){return}},insertBefore:function(e,t,n){try{return e.insertBefore(t,n)}catch(e){return null}}},J={protocol:/^(https?:)/i.test(document.location.protocol)?document.location.protocol:"https:",execute:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST",r=arguments.length>3?arguments[3]:void 0,i=new XMLHttpRequest;return new Promise((function(a,o){i.onreadystatechange=function(){if(4===i.readyState)if(200===i.status)try{var e=JSON.parse(i.responseText);a(e)}catch(e){a(i.responseText)}else o(i.responseText)},i.open(n,e),r&&r.forEach((function(e,t){i.setRequestHeader(t,e)})),i.send(t)}))},jsonp:function(e,t,n){var r,i=(n=n||{}).timeout?n.timeout:5e3,a=document.createElement("script"),o="jsonpcallback"+Math.round(Date.now()+1000001*Math.random()),s=e,u=function(){a&&a.parentNode&&a.parentNode.removeChild(a),window[o]=function(){},r&&clearTimeout(r)};return new Promise((function(n,c){i&&(r=setTimeout((function(){u(),c(new G(G.Severity.CRITICAL,G.Category.NETWORK,G.Code.TIMEOUT,e))}),i)),window[o]=function(r){var i=t(r,e);u(),n(i)},s.match(/\?/)?s+="&responseFormat=jsonp&callback="+o:s+="?responseFormat=jsonp&callback="+o,a.type="text/javascript",a.src=s,document.getElementsByTagName("head")[0].appendChild(a)}))},convertHeadersToDictionary:function(e){var t={};try{e.trim().split(/[\r\n]+/).forEach((function(e){var n=e.split(": "),r=n.shift().toLowerCase(),i=n.join(": ");t[r]=i}))}catch(e){}return t}},ee={compare:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=(n=Q.merge([{lexicographical:!1,zeroExtend:!0},n])).lexicographical,i=n.zeroExtend,a=(e||"0").split("."),o=(t||"0").split("."),s=function(e){return(r?/^\d+[A-Za-zÎ±Ã]*$/:/^\d+[A-Za-zÎ±Ã]?$/).test(e)},u=function(e){return e.map((function(e){var t=/[A-Za-zÎ±Ã]/.exec(e);return Number(t?e.replace(t[0],"."+e.charCodeAt(t.index)):e)}))};if(!a.every(s)||!o.every(s))return NaN;if(i){for(;a.length<o.length;)a.push("0");for(;o.length<a.length;)o.push("0")}r||(a=u(a),o=u(o));for(var c=0;c<a.length;++c){if(o.length===c)return 1;if(a[c]!==o[c])return a[c]>o[c]?1:-1}return a.length!==o.length?-1:0}};function te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ne=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._createEl()}var t,n,r;return t=e,(n=[{key:"setSrc",value:function(e){e&&(this._posterUrl=e,$.setStyle(this._el,"background-image",'url("'.concat(this._posterUrl,'")')),this.hide())}},{key:"getElement",value:function(){return this._el}},{key:"_createEl",value:function(){if(!this._el){var e=this._el=$.createElement("div");$.setAttribute(e,"id",Z.uniqueId(5)),$.setAttribute(e,"tabindex","-1")}}},{key:"_removeEl",value:function(){this._el&&$.removeChild(this._el.parentNode,this._el)}},{key:"show",value:function(){$.setStyle(this._el,"display","")}},{key:"hide",value:function(){$.setStyle(this._el,"display","none")}},{key:"reset",value:function(){this._posterUrl="",$.setStyle(this._el,"background-image","")}},{key:"destroy",value:function(){this.reset(),this._removeEl()}},{key:"src",get:function(){return this._posterUrl}}])&&te(t.prototype,n),r&&te(t,r),e}(),re={AD_CAN_SKIP:"adcanskip",AD_MANIFEST_LOADED:"admanifestloaded",AD_LOADED:"adloaded",AD_STARTED:"adstarted",AD_RESUMED:"adresumed",AD_PAUSED:"adpaused",AD_CLICKED:"adclicked",AD_SKIPPED:"adskipped",AD_COMPLETED:"adcompleted",AD_ERROR:"aderror",ADS_COMPLETED:"adscompleted",ALL_ADS_COMPLETED:"alladscompleted",AD_BREAK_START:"adbreakstart",AD_BREAK_END:"adbreakend",AD_FIRST_QUARTILE:"adfirstquartile",AD_MIDPOINT:"admidpoint",AD_THIRD_QUARTILE:"adthirdquartile",USER_CLOSED_AD:"userclosedad",AD_VOLUME_CHANGED:"advolumechanged",AD_MUTED:"admuted",AD_PROGRESS:"adprogress",AD_BUFFERING:"adbuffering",AD_WATERFALLING:"adwaterfalling",AD_WATERFALLING_FAILED:"adwaterfallingfailed",AD_AUTOPLAY_FAILED:"adautoplayfailed"},ie={ABORT:"abort",CAN_PLAY:"canplay",CAN_PLAY_THROUGH:"canplaythrough",DURATION_CHANGE:"durationchange",EMPTIED:"emptied",ENDED:"ended",ERROR:"error",LOADED_DATA:"loadeddata",LOADED_METADATA:"loadedmetadata",LOAD_START:"loadstart",PAUSE:"pause",PLAY:"play",PLAYING:"playing",PROGRESS:"progress",RATE_CHANGE:"ratechange",SEEKED:"seeked",SEEKING:"seeking",STALLED:"stalled",SUSPEND:"suspend",TIME_UPDATE:"timeupdate",VOLUME_CHANGE:"volumechange",WAITING:"waiting",ENTER_PICTURE_IN_PICTURE:"enterpictureinpicture",LEAVE_PICTURE_IN_PICTURE:"leavepictureinpicture",PRESENTATION_MODE_CHANGED:"webkitpresentationmodechanged"},ae={MEDIA_LOADED:"medialoaded",PLAYER_RESET:"playerreset",PLAYER_DESTROY:"playerdestroy",ENTER_FULLSCREEN:"enterfullscreen",EXIT_FULLSCREEN:"exitfullscreen",PLAY_FAILED:"playfailed",AUTOPLAY_FAILED:"autoplayfailed",FALLBACK_TO_MUTED_AUTOPLAY:"fallbacktomutedautoplay",CHANGE_SOURCE_STARTED:"changesourcestarted",CHANGE_SOURCE_ENDED:"changesourceended",MUTE_CHANGE:"mutechange",VIDEO_TRACK_CHANGED:"videotrackchanged",AUDIO_TRACK_CHANGED:"audiotrackchanged",TEXT_TRACK_CHANGED:"texttrackchanged",TEXT_CUE_CHANGED:"textcuechanged",TRACKS_CHANGED:"trackschanged",ABR_MODE_CHANGED:"abrmodechanged",PLAYER_STATE_CHANGED:"playerstatechanged",PLAYBACK_START:"playbackstart",FIRST_PLAY:"firstplay",FIRST_PLAYING:"firstplaying",PLAYBACK_ENDED:"playbackended",SOURCE_SELECTED:"sourceselected",TEXT_STYLE_CHANGED:"textstylechanged",MEDIA_RECOVERED:"mediarecovered",VR_STEREO_MODE_CHANGED:"vrstereomodechanged",FPS_DROP:"fpsdrop",BOOKMARK_ERROR:"bookmarkerror",CONCURRENCY_LIMIT:"concurrencylimit",RESIZE:"resize",TIMED_METADATA:"timedmetadata",FRAG_LOADED:"fragloaded",MANIFEST_LOADED:"manifestloaded",USER_GESTURE:"usergesture",DRM_LICENSE_LOADED:"drmlicenseloaded"},oe=Q.merge([ie,ae,re]);function se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ue=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"language",get:function(){var e;return(e=navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.userLanguage?navigator.userLanguage:navigator.language)&&e.match("-")&&(e=e.split("-")[0]),e}}],(n=null)&&se(t.prototype,n),r&&se(t,r),e}();function ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var le=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=t,this._duration=0,this._timestamp=Date.now()/1e3}var t,n,r;return t=e,(n=[{key:"duration",get:function(){return this._duration},set:function(e){this._duration=e-this._timestamp}}])&&ce(t.prototype,n),r&&ce(t,r),e}(),fe={IDLE:"idle",LOADING:"loading",PLAYING:"playing",PAUSED:"paused",BUFFERING:"buffering"};function de(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function he(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ae=function(){function e(t){var n,r,i,a,o,s,u=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),he(this,"_transitions",(he(s={},fe.IDLE,(he(n={},ie.LOAD_START,(function(){u._updateState(fe.LOADING),u._dispatchEvent()})),he(n,ie.PLAY,(function(){u._updateState(fe.BUFFERING),u._dispatchEvent()})),he(n,ie.SEEKED,(function(){u._updateState(fe.PAUSED),u._dispatchEvent()})),n)),he(s,fe.LOADING,(he(r={},ie.LOADED_METADATA,(function(){u._updateState(fe.PAUSED),u._dispatchEvent()})),he(r,ie.ERROR,(function(){u._updateState(fe.IDLE),u._dispatchEvent()})),r)),he(s,fe.PAUSED,(he(i={},ie.PLAY,(function(){u._updateState(fe.PLAYING),u._dispatchEvent()})),he(i,ie.PLAYING,(function(){u._updateState(fe.PLAYING),u._dispatchEvent()})),he(i,ie.ENDED,(function(){u._updateState(fe.IDLE),u._dispatchEvent()})),he(i,ae.PLAYBACK_ENDED,(function(){u._updateState(fe.IDLE),u._dispatchEvent()})),i)),he(s,fe.PLAYING,(he(a={},ie.PAUSE,(function(){u._updateState(fe.PAUSED),u._dispatchEvent()})),he(a,ie.WAITING,(function(){u._updateState(fe.BUFFERING),u._lastWaitingTime=u._player.currentTime,u._dispatchEvent()})),he(a,ie.ENDED,(function(){u._updateState(fe.IDLE),u._dispatchEvent()})),he(a,ae.PLAYBACK_ENDED,(function(){u._updateState(fe.IDLE),u._dispatchEvent()})),he(a,ie.ERROR,(function(){u._updateState(fe.IDLE),u._dispatchEvent()})),a)),he(s,fe.BUFFERING,(he(o={},ie.PLAYING,(function(){u._updateState(fe.PLAYING),u._dispatchEvent()})),he(o,ie.PAUSE,(function(){u._updateState(fe.PAUSED),u._dispatchEvent()})),he(o,ie.SEEKED,(function(){u._prevState&&u._prevState.type===fe.PLAYING&&(u._updateState(fe.PLAYING),u._dispatchEvent())})),he(o,ie.TIME_UPDATE,(function(){u._player.currentTime!==u._lastWaitingTime&&u._prevState&&u._prevState.type===fe.PLAYING&&(u._lastWaitingTime=null,u._updateState(fe.PLAYING),u._dispatchEvent())})),o)),s)),this._player=t,this._logger=F("StateManager"),this._eventManager=new I,this._history=[],this._prevState=null,this._curState=new le(fe.IDLE),this._attachListeners()}var t,n,r;return t=e,(n=[{key:"_attachListeners",value:function(){this._eventManager.listen(this._player,ie.ERROR,this._doTransition.bind(this)),this._eventManager.listen(this._player,ie.ENDED,this._doTransition.bind(this)),this._eventManager.listen(this._player,ie.PLAY,this._doTransition.bind(this)),this._eventManager.listen(this._player,ie.LOAD_START,this._doTransition.bind(this)),this._eventManager.listen(this._player,ie.PLAYING,this._doTransition.bind(this)),this._eventManager.listen(this._player,ie.LOADED_METADATA,this._doTransition.bind(this)),this._eventManager.listen(this._player,ie.PAUSE,this._doTransition.bind(this)),this._eventManager.listen(this._player,ie.WAITING,this._doTransition.bind(this)),this._eventManager.listen(this._player,ie.SEEKED,this._doTransition.bind(this)),this._eventManager.listen(this._player,ie.TIME_UPDATE,this._doTransition.bind(this)),this._eventManager.listen(this._player,ae.PLAYBACK_ENDED,this._doTransition.bind(this))}},{key:"_doTransition",value:function(e){(e.type!==ie.TIME_UPDATE||this._curState===fe.BUFFERING&&e.type===ie.TIME_UPDATE)&&this._logger.debug("Do transition request",e.type);var t=this._transitions[this._curState.type];"function"==typeof t[e.type]&&t[e.type]()}},{key:"_updateState",value:function(e){this._curState.type!==e&&(this._curState.duration=Date.now()/1e3,this._history.push(this._curState),this._prevState=this._curState,this._curState=new le(e),this._logger.debug("Switch player state: from ".concat(this._prevState.type," to ").concat(this._curState.type)))}},{key:"_dispatchEvent",value:function(){var e=new m(ae.PLAYER_STATE_CHANGED,{oldState:this._prevState,newState:this._curState});this._player.dispatchEvent(e)}},{key:"destroy",value:function(){this._history=[],this._eventManager.destroy()}},{key:"reset",value:function(){this._history=[]}},{key:"currentState",get:function(){return this._curState}},{key:"previousState",get:function(){return this._prevState}},{key:"history",get:function(){return this._history}}])&&de(t.prototype,n),r&&de(t,r),e}();function _e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ye=function(){var e,t,n;function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_e(this,r),this._id=e.id,this._active=e.active,this._label=e.label,this._language=e.language,this._index=e.index,this.clone=r.clone.bind(null,this)}return e=r,n=[{key:"langComparer",value:function(e,t){try{return e=e.toLowerCase(),t=t.toLowerCase(),!!e&&(e.startsWith(t)||t.startsWith(e))}catch(e){return!1}}},{key:"clone",value:function(e){return Object.assign(Object.create(Object.getPrototypeOf(e)),e)}}],(t=[{key:"id",get:function(){return this._id}},{key:"active",get:function(){return this._active},set:function(e){this._active=e}},{key:"label",get:function(){return this._label},set:function(e){this._label=e}},{key:"language",get:function(){return this._language}},{key:"index",get:function(){return this._index},set:function(e){this._index=e}}])&&pe(e.prototype,t),n&&pe(e,n),r}();function ge(e){return(ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function me(e,t){return(me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ke(e);if(t){var i=ke(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Te(this,n)}}function Te(e,t){return!t||"object"!==ge(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ke(e){return(ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Se=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&me(e,t)}(a,e);var t,n,r,i=be(a);function a(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ve(this,a),(e=i.call(this,t))._bandwidth=t.bandwidth,e._width=t.width,e._height=t.height,e._label=t.label?t.label:e._height?e._height+"p":void 0,e}return t=a,(n=[{key:"bandwidth",get:function(){return this._bandwidth}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}}])&&Ee(t.prototype,n),r&&Ee(t,r),a}(ye);function we(e){return(we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Re(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ce(e,t){return(Ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ie(e);if(t){var i=Ie(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return De(this,n)}}function De(e,t){return!t||"object"!==we(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ie(e){return(Ie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Pe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ce(e,t)}(n,e);var t=Oe(n);function n(){return Re(this,n),t.apply(this,arguments)}return n}(ye);function Ne(e){return(Ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Le(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Me(e,t){return(Me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=je(e);if(t){var i=je(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Fe(this,n)}}function Fe(e,t){return!t||"object"!==Ne(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function je(e){return(je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Be=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Me(e,t)}(a,e);var t,n,r,i=Ue(a);function a(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Le(this,a),(e=i.call(this,t))._label=e.label||e.language,e._kind=t.kind,e._external=t.external,e}return t=a,(n=[{key:"kind",get:function(){return this._kind}},{key:"external",get:function(){return this._external}}])&&xe(t.prototype,n),r&&xe(t,r),a}(ye);function Ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ge(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var He=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Ge(this,"fontSize","100%"),Ge(this,"fontScale",1),Ge(this,"fontFamily",e.FontFamily.SANS_SERIF),Ge(this,"fontColor",e.StandardColors.WHITE),Ge(this,"fontOpacity",e.StandardOpacities.OPAQUE),Ge(this,"backgroundColor",e.StandardColors.BLACK),Ge(this,"backgroundOpacity",e.StandardOpacities.OPAQUE),Ge(this,"fontEdge",e.EdgeStyles.NONE)}var t,n,r;return t=e,r=[{key:"toRGBA",value:function(e,t){return"rgba("+e.concat(t).join(",")+")"}}],(n=[{key:"getTextShadow",value:function(){for(var t=[],n=0;n<this.fontEdge.length;n++){var r=this.fontEdge[n].slice(0,3),i=this.fontEdge[n].slice(3,6);t.push(e.toRGBA(r,this.fontOpacity)+" "+i.join("px ")+"px")}return t.join(",")}},{key:"toCSS",value:function(){var t=[];return t.push("font-family: "+this.fontFamily),t.push("color: "+e.toRGBA(this.fontColor,this.fontOpacity)),t.push("background-color: "+e.toRGBA(this.backgroundColor,this.backgroundOpacity)),t.push("text-shadow: "+this.getTextShadow()),t.join("!important; ")}},{key:"clone",value:function(){var t=new e;return t.fontEdge=this.fontEdge,t.fontSize=this.fontSize,t.fontScale=this.fontScale,t.fontColor=this.fontColor,t.fontOpacity=this.fontOpacity,t.backgroundColor=this.backgroundColor,t.backgroundOpacity=this.backgroundOpacity,t.fontFamily=this.fontFamily,t}},{key:"isEqual",value:function(e){return e.fontEdge===this.fontEdge&&e.fontSize===this.fontSize&&e.fontColor===this.fontColor&&e.fontOpacity===this.fontOpacity&&e.backgroundColor===this.backgroundColor&&e.backgroundOpacity===this.backgroundOpacity}},{key:"implicitFontScale",get:function(){return.25*this.fontScale+1}}])&&Ve(t.prototype,n),r&&Ve(t,r),e}();Ge(He,"FontFamily",{ARIAL:"Arial",HELVETICA:"Helvetica",VERDANA:"Verdana",SANS_SERIF:"sans-serif"}),Ge(He,"StandardColors",{WHITE:[255,255,255],BLACK:[0,0,0],RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,255,0],MAGENTA:[255,0,255],CYAN:[0,255,255]}),Ge(He,"StandardOpacities",{OPAQUE:1,SEMI_HIGH:.75,SEMI_LOW:.25,TRANSPARENT:0}),Ge(He,"EdgeStyles",{NONE:[],RAISED:[[34,34,34,1,1,0],[34,34,34,2,2,0],[34,34,34,3,3,0]],DEPRESSED:[[204,204,204,1,1,0],[204,204,204,0,1,0],[34,34,34,-1,-1,0],[34,34,34,0,-1,0]],UNIFORM:[[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4]],DROP:[[34,34,34,2,2,3],[34,34,34,2,2,4],[34,34,34,2,2,5]]}),Ge(He,"FontSizes",[{value:-2,label:"50%"},{value:-1,label:"75%"},{value:0,label:"100%"},{value:2,label:"200%"},{value:3,label:"300%"},{value:4,label:"400%"}]);var Ye=He;function We(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ke(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ze={"":!0,up:!0};function Xe(e){return"number"==typeof e&&e>=0&&e<=100}var qe,Qe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Ke(this,"_width",100),Ke(this,"_lines",3),Ke(this,"_regionAnchorX",0),Ke(this,"_regionAnchorY",100),Ke(this,"_viewportAnchorX",0),Ke(this,"_viewportAnchorY",100),Ke(this,"_scroll","")}var t,n,r;return t=e,(n=[{key:"width",get:function(){return this._width},set:function(e){if(!Xe(e))throw new Error("Width must be between 0 and 100.");this._width=e}},{key:"scroll",get:function(){return this._scroll},set:function(e){var t=function(e){return"string"==typeof e&&!!ze[e.toLowerCase()]&&e.toLowerCase()}(e);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");this._scroll=t}},{key:"viewportAnchorY",get:function(){return this._viewportAnchorY},set:function(e){if(!Xe(e))throw new Error("ViewportAnchorY must be between 0 and 100.");this._viewportAnchorY=e}},{key:"viewportAnchorX",get:function(){return this._viewportAnchorX},set:function(e){if(!Xe(e))throw new Error("ViewportAnchorX must be between 0 and 100.");this._viewportAnchorX=e}},{key:"regionAnchorX",get:function(){return this._regionAnchorX},set:function(e){if(!Xe(e))throw new Error("RegionAnchorY must be between 0 and 100.");this._regionAnchorX=e}},{key:"lines",get:function(){return this._lines},set:function(e){if("number"!=typeof e)throw new TypeError("Lines must be set to a number.");this._lines=e}},{key:"regionAnchorY",get:function(){return this._regionAnchorY},set:function(e){if(!Xe(e))throw new Error("RegionAnchorX must be between 0 and 100.");this._regionAnchorY=e}}])&&We(t.prototype,n),r&&We(t,r),e}();function Ze(e){return(Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $e(e,t){return($e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=tt(e);if(t){var i=tt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return et(this,n)}}function et(e,t){return!t||"object"!==Ze(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tt(e){return(tt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function it(e,t,n){return t&&rt(e.prototype,t),n&&rt(e,n),e}qe="undefined"!=typeof window&&window.VTTRegion?window.VTTRegion:Qe;function at(e){function t(e,t,n,r){return 3600*(0|e)+60*(0|t)+(0|n)+(0|r)/1e3}var n=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return n?n[3]?t(n[1],n[2],n[3].replace(":",""),n[4]):n[1]>59?t(n[1],n[2],0,n[4]):t(0,n[1],n[2],n[4]):null}var ot={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"â","&rlm;":"â","&nbsp;":"Â "},st={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},ut={v:"title",lang:"lang"},ct={rt:"ruby"};function lt(){this.values=Et(null)}function ft(e,t,n,r){var i=r?e.split(r):[e];for(var a in i)if("string"==typeof i[a]){var o=i[a].split(n);if(2===o.length)t(o[0],o[1])}}function dt(e,t,n){var r=e;function i(){var t=at(e);if(null===t)throw new mt(mt.Errors.BadTimeStamp,"Malformed timestamp: "+r);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function a(){e=e.replace(/^\s+/,"")}if(a(),t.startTime=i(),a(),"--\x3e"!==e.substr(0,3))throw new mt(mt.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+r);e=e.substr(3),a(),t.endTime=i(),a(),function(e,t){var r=new lt;ft(e,(function(e,t){switch(e){case"region":for(var i=n.length-1;i>=0;i--)if(n[i].id===t){r.set(e,n[i].region);break}break;case"vertical":r.alt(e,t,["rl","lr"]);break;case"line":var a=t.split(","),o=a[0];r.integer(e,o),r.percent(e,o)&&r.set("snapToLines",!1),r.alt(e,o,["auto"]),2===a.length&&r.alt("lineAlign",a[1],["start","center","end"]);break;case"position":a=t.split(","),r.percent(e,a[0]),2===a.length&&r.alt("positionAlign",a[1],["start","center","end"]);break;case"size":r.percent(e,t);break;case"align":r.alt(e,t,["start","center","end","left","right"])}}),/:/,/\s/),t.region=r.get("region",null),t.vertical=r.get("vertical",""),t.line=r.get("line",t.line||"auto"),t.lineAlign=r.get("lineAlign","start"),t.snapToLines=r.get("snapToLines",!0),t.size=r.get("size",100);try{t.align=r.get("align","center")}catch(e){t.align=r.get("align","middle")}t.position=r.get("position",t.position||"auto"),t.positionAlign=r.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},t.align)}(e,t)}function ht(e,t){function n(){if(!t)return null;var e,n=t.match(/^([^<]*)(<[^>]+>?)?/);return e=n[1]?n[1]:n[2],t=t.substr(e.length),e}function r(e){return ot[e]}function i(e){for(var t;t=e.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)e=e.replace(t[0],r);return e}function a(e,t){return!ct[t.localName]||ct[t.localName]===e.localName}function o(t,n){var r=st[t];if(!r)return null;var i=e.document.createElement(r),a=ut[t];return a&&n&&(i[a]=n.trim()),i}for(var s,u=e.document.createElement("div"),c=u,l=[];null!==(s=n());)if("<"!==s[0])c.appendChild(e.document.createTextNode(i(s)));else{if("/"===s[1]){l.length&&l[l.length-1]===s.substr(2).replace(">","")&&(l.pop(),c=c.parentNode);continue}var f=at(s.substr(1,s.length-2)),d=void 0;if(f){d=e.document.createProcessingInstruction("timestamp",f),c.appendChild(d);continue}var h=s.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!h)continue;if(!(d=o(h[1],h[3])))continue;if(!a(c,d))continue;h[2]&&(d.className=h[2].substr(1).replace("."," ")),l.push(h[1]),c.appendChild(d),c=d}return u}lt.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,n){for(var r=0;r<n.length;++r)if(t===n[r]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(e,t),!0)}};var At=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function _t(e){for(var t=0;t<At.length;t++){var n=At[t];if(e>=n[0]&&e<=n[1])return!0}return!1}var pt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$e(e,t)}(n,e);var t=Je(n);function n(e,r,i){var a;nt(this,n),a=t.call(this);var o="undefined"!=typeof navigator&&/MSIE\s8\.0/.test(navigator.userAgent);"undefined"!=typeof WebVTTSet&&(WebVTTSet.fontSet,WebVTTSet.backgroundSet,WebVTTSet.edgeSet),o&&"rgb(255, 255, 255)",a.cue=r,a.cueDiv=ht(e,r.text);var s={color:i.color,backgroundColor:i.backgroundColor,textShadow:i.textShadow,position:"relative",left:0,right:0,top:0,bottom:0,display:"inline"};o||(s.writingMode=""===r.vertical?"horizontal-tb":"lr"===r.vertical?"vertical-lr":"vertical-rl",s.unicodeBidi="plaintext"),a.applyStyles(s,a.cueDiv),a.div=e.document.createElement("div"),s={textAlign:"middle"===r.align?"center":r.align,font:i.font,whiteSpace:"pre-line",position:"absolute"},o||(s.direction=function(e){var t=[],n="";if(!e||!e.childNodes)return"ltr";function r(e,t){for(var n=t.childNodes.length-1;n>=0;n--)e.push(t.childNodes[n])}function i(e){if(!e||!e.length)return null;var t=e.pop(),n=t.textContent||t.innerText;if(n){var a=n.match(/^.*(\n|\r)/);return a?(e.length=0,a[0]):n}return"ruby"===t.tagName?i(e):t.childNodes?(r(e,t),i(e)):void 0}for(r(t,e);n=i(t);)for(var a=0;a<n.length;a++)if(_t(n.charCodeAt(a)))return"rtl";return"ltr"}(a.cueDiv),s.writingMode=""===r.vertical?"horizontal-tb":"lr"===r.vertical?"vertical-lr":"vertical-rl".stylesunicodeBidi="plaintext"),a.applyStyles(s),a.div.appendChild(a.cueDiv);var u=0;switch(r.positionAlign){case"start":u=r.position;break;case"center":u=r.position-r.size/2;break;case"end":u=r.position-r.size}return""===r.vertical?a.applyStyles({left:a.formatStyle(u,"%"),width:a.formatStyle(r.size,"%")}):a.applyStyles({top:a.formatStyle(u,"%"),height:a.formatStyle(r.size,"%")}),a.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})},a}return n}(function(){function e(){nt(this,e)}return it(e,[{key:"applyStyles",value:function(e,t){for(var n in t=t||this.div,e)e.hasOwnProperty(n)&&(t.style[n]=e[n])}},{key:"formatStyle",value:function(e,t){return 0===e?0:e+t}}]),e}()),yt=function(){function e(t){var n,r,i,a;if(nt(this,e),function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"overlaps",(function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top})),t.div){r=t.div.offsetHeight,i=t.div.offsetWidth,a=t.div.offsetTop;var o=(o=t.div.childNodes)&&(o=o[0])&&o.getClientRects&&o.getClientRects();t=t.div.getBoundingClientRect(),n=o?Math.max(o[0]&&o[0].height||0,t.height/o.length):0}this.left=t.left,this.right=t.right,this.top=t.top||a,this.height=t.height||r,this.bottom=t.bottom||a+(t.height||r),this.width=t.width||i,this.lineHeight=n||t.lineHeight||13}return it(e,[{key:"move",value:function(e,t){switch(t=void 0!==t?t:this.lineHeight,e){case"+x":this.left+=t,this.right+=t;break;case"-x":this.left-=t,this.right-=t;break;case"+y":this.top+=t,this.bottom+=t;break;case"-y":this.top-=t,this.bottom-=t}}},{key:"overlapsAny",value:function(e){for(var t=0;t<e.length;t++)if(this.overlaps(e[t]))return!0;return!1}},{key:"within",value:function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right}},{key:"overlapsOppositeAxis",value:function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom}}},{key:"intersectPercentage",value:function(e){return Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left))*Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top))/(this.height*this.width)}},{key:"toCSSCompatValues",value:function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}}}],[{key:"getSimpleBoxPosition",value:function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0,n=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0,r=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;return{left:(e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e).left,right:e.right,top:e.top||r,height:e.height||t,bottom:e.bottom||r+(e.height||t),width:e.width||n}}}]),e}();function gt(e,t,n,r){var i=new yt(t),a=t.cue,o=function(e){if("number"==typeof e.line&&(e.snapToLines||e.line>=0&&e.line<=100))return e.line;if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement)return-1;for(var t=e.track,n=t.textTrackList,r=0,i=0;i<n.length&&n[i]!==t;i++)"showing"===n[i].mode&&r++;return-1*++r}(a),s=[];if(a.snapToLines){var u;switch(a.vertical){case"":s=["+y","-y"],u="height";break;case"rl":s=["+x","-x"],u="width";break;case"lr":s=["-x","+x"],u="width"}var c=i.lineHeight,l=c*Math.round(o),f=n[u]+c,d=s[0];Math.abs(l)>f&&(l=l<0?-1:1,l*=Math.ceil(f/c)*c),o<0&&(l+=""===a.vertical?n.height:n.width,s=s.reverse()),i.move(d,l)}else{var h=i.lineHeight/n.height*100;switch(a.lineAlign){case"center":o-=h/2;break;case"end":o-=h}switch(a.vertical){case"":t.applyStyles({top:t.formatStyle(o,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(o,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(o,"%")})}s=["+y","-x","+x","-y"],i=new yt(t)}var A=function(e,t){for(var i,a=new yt(e),o=1,s=0;s<t.length;s++){for(;e.overlapsOppositeAxis(n,t[s])||e.within(n)&&e.overlapsAny(r);)e.move(t[s]);if(e.within(n))return e;var u=e.intersectPercentage(n);o>u&&(i=new yt(e),o=u),e=new yt(a)}return i||a}(i,s);t.move(A.toCSSCompatValues(n))}var vt=function(e,t){this.window=e,this.state="INITIAL",this.buffer="",this.decoder=t||new TextDecoder("utf8"),this.regionList=[]},Et=Object.create||function(){function e(){}return function(t){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return e.prototype=t,new e}}();function mt(e,t){this.name="ParsingError",this.code=e.code,this.message=t||e.message}function bt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}mt.prototype=Et(Error.prototype),mt.prototype.constructor=mt,mt.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},vt.prototype={reportOrThrowError:function(e){if(!(e instanceof mt))throw e;this.onparsingerror&&this.onparsingerror(e)},parse:function(e){var t=this;function n(){for(var e=t.buffer,n=0;n<e.length&&"\r"!==e[n]&&"\n"!==e[n];)++n;var r=e.substr(0,n);return"\r"===e[n]&&++n,"\n"===e[n]&&++n,t.buffer=e.substr(n),r}function r(e){ft(e,(function(e,n){switch(e){case"Region":!function(e){var n=new lt;if(ft(e,(function(e,t){switch(e){case"id":n.set(e,t);break;case"width":n.percent(e,t);break;case"lines":n.integer(e,t);break;case"regionanchor":case"viewportanchor":var r=t.split(",");if(2!==r.length)break;var i=new lt;if(i.percent("x",r[0]),i.percent("y",r[1]),!i.has("x")||!i.has("y"))break;n.set(e+"X",i.get("x")),n.set(e+"Y",i.get("y"));break;case"scroll":n.alt(e,t,["up"])}}),/=/,/\s/),n.has("id")){var r=new qe;r.width=n.get("width",100),r.lines=n.get("lines",3),r.regionAnchorX=n.get("regionanchorX",0),r.regionAnchorY=n.get("regionanchorY",100),r.viewportAnchorX=n.get("viewportanchorX",0),r.viewportAnchorY=n.get("viewportanchorY",100),r.scroll=n.get("scroll",""),t.onregion&&t.onregion(r),t.regionList.push({id:n.get("id"),region:r})}}(n)}}),/:/)}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var i;if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var a=(i=n()).match(/^WEBVTT([ \t].*)?$/);if(!a||!a[0])throw new mt(mt.Errors.BadSignature);t.state="HEADER"}for(var o=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(o?o=!1:i=n(),t.state){case"HEADER":/:/.test(i)?r(i):i||(t.state="ID");continue;case"NOTE":i||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){t.state="NOTE";break}if(!i)continue;if(t.cue=new Rt(0,0,""),t.state="CUE",-1===i.indexOf("--\x3e")){t.cue.id=i;continue}case"CUE":try{dt(i,t.cue,t.regionList)}catch(e){t.reportOrThrowError(e),t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var s=-1!==i.indexOf("--\x3e");if(!i||s&&(o=!0)){t.oncue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}t.cue.text&&(t.cue.text+="\n"),t.cue.text+=i;continue;case"BADCUE":i||(t.state="ID");continue}}}catch(e){t.reportOrThrowError(e),"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),(this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new mt(mt.Errors.BadSignature)}catch(e){this.reportOrThrowError(e)}return this.onflush&&this.onflush(),this}};var kt={"":!0,lr:!0,rl:!0},St={start:!0,center:!0,end:!0,left:!0,right:!0};function wt(e){return"string"==typeof e&&(!!St[e.toLowerCase()]&&e.toLowerCase())}var Rt,Ct=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Tt(this,"hasBeenReset",!1),Tt(this,"displayState",void 0),Tt(this,"_id",""),Tt(this,"_pauseOnExit",!1),Tt(this,"_region",null),Tt(this,"_vertical",""),Tt(this,"_snapToLines",!0),Tt(this,"_line","auto"),Tt(this,"_lineAlign","start"),Tt(this,"_position",50),Tt(this,"_positionAlign","center"),Tt(this,"_size",50),Tt(this,"_align","center"),this._startTime=t,this._endTime=n,this._text=r}var t,n,r;return t=e,(n=[{key:"resetCue",value:function(){this.hasBeenReset=!0}},{key:"getCueAsHTML",value:function(){return function(e,t){return e&&t?ht(e,t):null}(window,this.text)}},{key:"id",get:function(){return this._id},set:function(e){this._id=""+e}},{key:"pauseOnExit",get:function(){return this._pauseOnExit},set:function(e){this._pauseOnExit=e}},{key:"startTime",get:function(){return this._startTime},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");this._startTime=e,this.resetCue()}},{key:"endTime",get:function(){return this._endTime},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");this._endTime=e,this.resetCue()}},{key:"text",get:function(){return this._text},set:function(e){this._text=""+e,this.resetCue()}},{key:"region",get:function(){return this._region},set:function(e){this._region=e,this.resetCue()}},{key:"vertical",get:function(){return this._vertical},set:function(e){var t=function(e){return"string"==typeof e&&!!kt[e.toLowerCase()]&&e.toLowerCase()}(e);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");"string"==typeof t&&(this._vertical=t,this.resetCue())}},{key:"snapToLines",get:function(){return this._snapToLines},set:function(e){this._snapToLines=e,this.resetCue()}},{key:"line",get:function(){return this._line},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");this._line=e,this.resetCue()}},{key:"lineAlign",get:function(){return this._lineAlign},set:function(e){var t=wt(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");"string"==typeof t&&(this._lineAlign=t,this.resetCue())}},{key:"position",get:function(){return this._position},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");this._position=e,this.resetCue()}},{key:"positionAlign",get:function(){return this._positionAlign},set:function(e){var t=wt(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");"string"==typeof t&&(this._positionAlign=t,this.resetCue())}},{key:"size",get:function(){return this._size},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");this._size=e,this.resetCue()}},{key:"align",get:function(){return this._align},set:function(e){var t=wt(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");"string"==typeof t&&(this._align=t,this.resetCue())}}])&&bt(t.prototype,n),r&&bt(t,r),e}();Rt="undefined"!=typeof window&&window.VTTCue?window.VTTCue:Ct;var Ot=Object.freeze({VIDEO:"video",AUDIO:"audio",TEXT:"text"}),Dt={DASH:"dash",HLS:"hls",PROGRESSIVE:"progressive"},It={HTML5:"html5",FLASH:"flash",SILVERLIGHT:"silverlight",CAST:"cast"},Pt={VOD:"Vod",LIVE:"Live",AUDIO:"Audio",UNKNOWN:"Unknown"},Nt={MANUAL:"manual",AUTO:"auto"},Lt={ANONYMOUS:"anonymous",USE_CREDENTIALS:"use-credentials"};function xt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Mt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"callNext",value:function(e){e&&e()}}])&&xt(t.prototype,n),r&&xt(t,r),e}();function Ut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ft=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._actions=t,this._middlewares=new v,this._logger=F("Middleware")}var t,n,r;return t=e,(n=[{key:"use",value:function(e){for(var t in this._actions){var n=this._actions[t];"function"==typeof e[n]&&(this._logger.debug("Register <".concat(e.id,"> for action ").concat(n)),this._middlewares.push(n,e[n].bind(e)))}}},{key:"run",value:function(e,t){var n=this;this._logger.debug("Start middleware chain for action "+e);var r=this._middlewares.get(e);this._executeMiddleware(r,(function(){n._logger.debug("Finish middleware chain for action "+e),t()}))}},{key:"_executeMiddleware",value:function(e,t){e.reduceRight((function(e,t){return function(n){t(e)}}),t)()}}])&&Ut(t.prototype,n),r&&Ut(t,r),e}();function jt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Bt,Vt,Gt,Ht=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._middleware=new Ft(e.Actions)}var t,n,r;return t=e,(n=[{key:"use",value:function(e){this._middleware.use(e)}},{key:"load",value:function(t){this._middleware.run(e.Actions.LOAD,t)}},{key:"play",value:function(t){this._middleware.run(e.Actions.PLAY,t)}},{key:"pause",value:function(t){this._middleware.run(e.Actions.PAUSE,t)}}])&&jt(t.prototype,n),r&&jt(t,r),e}();Gt={LOAD:"load",PLAY:"play",PAUSE:"pause"},(Vt="Actions")in(Bt=Ht)?Object.defineProperty(Bt,Vt,{value:Gt,enumerable:!0,configurable:!0,writable:!0}):Bt[Vt]=Gt;var Yt={log:{level:"ERROR"},sources:{options:{forceRedirectExternalStreams:!1},metadata:{}},playback:{audioLanguage:"",textLanguage:"",useNativeTextTrack:!1,enableCEA708Captions:!1,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",volume:1,startTime:-1,playsinline:!0,preload:"none",autoplay:!1,loop:!1,allowMutedAutoPlay:!0,muted:!1,pictureInPicture:!0,options:{html5:{hls:{},dash:{},native:{}}},preferNative:{hls:!1,dash:!1},inBrowserFullscreen:!1,playAdsWithMSE:!1,streamPriority:[{engine:"html5",format:"hls"},{engine:"html5",format:"dash"},{engine:"html5",format:"progressive"},{engine:"flash",format:"hls"}]},abr:{enabled:!0,fpsDroppedFramesInterval:5e3,fpsDroppedMonitoringThreshold:.2,capLevelOnFPSDrop:!0,capLevelToPlayerSize:!1,defaultBandwidthEstimate:5e5,restrictions:{minBitrate:0,maxBitrate:1/0}},drm:{keySystem:""},network:{}},Wt=(n(4),{MANIFEST:0,SEGMENT:1,LICENSE:2});function Kt(e){return(Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qt(e,t,n){return t&&Xt(e.prototype,t),n&&Xt(e,n),e}function Qt(e,t){return(Qt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=en(e);if(t){var i=en(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return $t(this,n)}}function $t(e,t){return!t||"object"!==Kt(t)&&"function"!=typeof t?Jt(e):t}function Jt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function en(e){return(en=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var nn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qt(e,t)}(n,e);var t=Zt(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return zt(this,n),tn(Jt(i=t.call(this)),"_capabilities",{fpsControl:!1}),i._videoElement=e,i._sourceObj=r,i._config=a,i._onDurationChanged=function(){i.isLive()&&i._videoElement.paused&&i._trigger(ie.TIME_UPDATE)},i._eventManager=new I,i._handleLiveTimeUpdate(),i}return qt(n,null,[{key:"isSupported",value:function(){return!0}},{key:"isMSESupported",value:function(){var e=window.MediaSource||window.WebKitMediaSource;return!!e&&"function"==typeof e.isTypeSupported}}]),qt(n,[{key:"destroy",value:function(){return this._sourceObj=null,this._config={},this._videoElement.removeEventListener(ie.DURATION_CHANGE,this._onDurationChanged),this._eventManager.destroy(),Promise.resolve()}},{key:"_onTrackChanged",value:function(e){e instanceof Se?this._trigger(ae.VIDEO_TRACK_CHANGED,{selectedVideoTrack:e}):e instanceof Pe?this._trigger(ae.AUDIO_TRACK_CHANGED,{selectedAudioTrack:e}):e instanceof Be&&this._trigger(ae.TEXT_TRACK_CHANGED,{selectedTextTrack:e})}},{key:"_trigger",value:function(e,t){this.dispatchEvent(new m(e,t))}},{key:"load",value:function(){return n._throwNotImplementedError("load")}},{key:"selectVideoTrack",value:function(e){return n._throwNotImplementedError("selectVideoTrack")}},{key:"selectAudioTrack",value:function(e){n._throwNotImplementedError("selectAudioTrack")}},{key:"selectTextTrack",value:function(e){n._throwNotImplementedError("selectTextTrack")}},{key:"hideTextTrack",value:function(){n._throwNotImplementedError("hideTextTrack")}},{key:"enableAdaptiveBitrate",value:function(){n._throwNotImplementedError("enableAdaptiveBitrate")}},{key:"isAdaptiveBitrateEnabled",value:function(){return n._throwNotImplementedError("isAdaptiveBitrateEnabled")}},{key:"_getLiveEdge",value:function(){return n._throwNotImplementedError("_getLiveEdge")}},{key:"seekToLiveEdge",value:function(){n._throwNotImplementedError("seekToLiveEdge")}},{key:"isLive",value:function(){return n._throwNotImplementedError("isLive")}},{key:"setMaxBitrate",value:function(e){}},{key:"attachMediaSource",value:function(){}},{key:"detachMediaSource",value:function(){}},{key:"_handleLiveTimeUpdate",value:function(){this._videoElement.addEventListener(ie.DURATION_CHANGE,this._onDurationChanged)}},{key:"handleMediaError",value:function(e){return!1}},{key:"getStartTimeOfDvrWindow",value:function(){return n._throwNotImplementedError("getStartTimeOfDvrWindow")}},{key:"currentTime",get:function(){return this.isLive()?this._videoElement.currentTime-this.getStartTimeOfDvrWindow():this._videoElement.currentTime},set:function(e){this.isLive()&&(e+=this.getStartTimeOfDvrWindow()),this._videoElement.currentTime=e}},{key:"duration",get:function(){return this.isLive()?this._getLiveEdge()-this.getStartTimeOfDvrWindow():this._videoElement.duration}},{key:"src",get:function(){return this._loadPromise&&this._sourceObj?this._sourceObj.url:""},set:function(e){!this._loadPromise&&this._sourceObj&&(this._sourceObj.url=e)}},{key:"capabilities",get:function(){return this._capabilities}},{key:"targetBuffer",get:function(){return NaN}}],[{key:"canPlayType",value:function(e,t){return n._throwNotImplementedError("static canPlayType")}},{key:"_throwNotImplementedError",value:function(e){throw new G(G.Severity.CRITICAL,G.Category.PLAYER,G.Code.RUNTIME_ERROR_METHOD_NOT_IMPLEMENTED,e)}}]),n}(T);function rn(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return an(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return an(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function an(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}tn(nn,"getLogger",F);var on={WIDEVINE:"com.widevine.alpha",PLAYREADY:"com.microsoft.playready",FAIRPLAY:"com.apple.fairplay"};function sn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var un=F("FairPlay"),cn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"isConfigured",value:function(e,t){return on.FAIRPLAY===t.keySystem&&!!e.find((function(e){return e.scheme===t.keySystem}))}},{key:"canPlayDrm",value:function(e){un.debug("Can play DRM scheme of: "+on.FAIRPLAY);var t=_.browser.name&&_.browser.name.includes("Safari");return!!e.find((function(e){return e.scheme===on.FAIRPLAY}))&&t}},{key:"setDrmPlayback",value:function(e,t){un.debug("Sets drm playback");var n=t.find((function(e){return e.scheme===on.FAIRPLAY}));n&&(e.licenseUrl=n.licenseUrl,e.certificate=n.certificate)}}],(n=null)&&sn(t.prototype,n),r&&sn(t,r),e}(),ln=n(2);function fn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return dn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function hn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function An(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _n={NEED_KEY:"webkitneedkey",KEY_MESSAGE:"webkitkeymessage",KEY_ADDED:"webkitkeyadded",KEY_ERROR:"webkitkeyerror"},pn=function(){function e(t,n,r,i){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),An(this,"_logger",F("FairPlayDrmHandler")),An(this,"_retryLicenseRequest",4),An(this,"_defaultConfig",{licenseUrl:"",certificate:"",network:{responseFilter:function(t,n){var r={};try{var i=new DataView(n.data),o=(new TextDecoder).decode(i).trim();r=JSON.parse(o)}catch(e){return void a._onError(G.Code.BAD_FAIRPLAY_RESPONSE,{error:e,responseText:n.data})}var s=e._validateResponse(r);s.valid?n.data=e._base64DecodeUint8Array(r.ckc):a._onError(G.Code.BAD_FAIRPLAY_RESPONSE,s)}}}),this._config=Q.mergeDeep({},this._defaultConfig,n),this._errorCallback=r,this._drmResponseCallback=i,this._videoElement=t,this._onWebkitNeedKeyHandler=function(e){return a._onWebkitNeedKey(e)},this._eventManager=new I,this._eventManager.listen(this._videoElement,_n.NEED_KEY,this._onWebkitNeedKeyHandler)}var t,n,r;return t=e,r=[{key:"_validateResponse",value:function(e){return e.message&&e.message.indexOf("error")>0||null===e.reference||500===e.status_code?{valid:!1,details:"internal server error"}:""===e.ckc?{valid:!1,details:"ckc is missing"}:{valid:!0}}},{key:"_extractContentId",value:function(t){var n=document.createElement("a");return n.href=e._arrayToString(t),n.hostname}},{key:"_arrayToString",value:function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))}},{key:"_base64DecodeUint8Array",value:function(e){for(var t=window.atob(e),n=t.length,r=new Uint8Array(new ArrayBuffer(n)),i=0;i<n;i++)r[i]=t.charCodeAt(i);return r}},{key:"_concatInitDataIdAndCertificate",value:function(t,n,r){"string"==typeof n&&(n=e._stringToArray(n));var i=0,a=new ArrayBuffer(t.byteLength+4+n.byteLength+4+r.byteLength),o=new DataView(a);new Uint8Array(a,i,t.byteLength).set(t),i+=t.byteLength,o.setUint32(i,n.byteLength,!0),i+=4;var s=new Uint8Array(a,i,n.byteLength);return s.set(n),i+=s.byteLength,o.setUint32(i,r.byteLength,!0),i+=4,new Uint8Array(a,i,r.byteLength).set(r),new Uint8Array(a,0,a.byteLength)}},{key:"_stringToArray",value:function(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),r=0,i=e.length;r<i;r++)n[r]=e.charCodeAt(r);return n}},{key:"_base64EncodeUint8Array",value:function(e){for(var t,n,r,i,a,o,s,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="",l=0;l<e.length;)i=(t=e[l++])>>2,a=(3&t)<<4|(n=l<e.length?e[l++]:Number.NaN)>>4,o=(15&n)<<2|(r=l<e.length?e[l++]:Number.NaN)>>6,s=63&r,isNaN(n)?o=s=64:isNaN(r)&&(s=64),c+=u.charAt(i)+u.charAt(a)+u.charAt(o)+u.charAt(s);return c}}],(n=[{key:"_onWebkitNeedKey",value:function(t){var n=this;this._logger.debug("Webkit need key triggered");var r=t.target,i=t.initData,a=e._extractContentId(i),o=e._base64DecodeUint8Array(this._config.certificate);if(i=e._concatInitDataIdAndCertificate(i,a,o),!r.webkitKeys){var s=this._selectKeySystem();this._logger.debug("Sets media keys"),r.webkitSetMediaKeys(new window.WebKitMediaKeys(s))}r.webkitKeys||this._onError(G.Code.COULD_NOT_CREATE_MEDIA_KEYS),this._logger.debug("Creates session"),this._keySession=r.webkitKeys.createSession("video/mp4",i),this._keySession||this._onError(G.Code.COULD_NOT_CREATE_KEY_SESSION),this._keySession.contentId=a,this._eventManager.listen(this._keySession,_n.KEY_MESSAGE,(function(e){return n._onWebkitKeyMessage(e)})),this._eventManager.listen(this._keySession,_n.KEY_ADDED,(function(){return n._onWebkitKeyAdded()})),this._eventManager.listen(this._keySession,_n.KEY_ERROR,(function(e){return n._onWebkitKeyError(e)}))}},{key:"destroy",value:function(){this._eventManager.destroy(),this._keySession.close(),this._keySession=null}},{key:"_onWebkitKeyMessage",value:function(t){var n=this;this._logger.debug("Webkit key message triggered");var r=t.message,i=new XMLHttpRequest;i.responseType="arraybuffer",this._eventManager.listenOnce(i,"load",(function(e){return n._licenseRequestLoaded(e)}));var a,o={url:this._config.licenseUrl,body:e._base64EncodeUint8Array(r),headers:{}},s=this._config.network.requestFilter;if(s){this._logger.debug("Apply request filter");try{a=s(Wt.LICENSE,o)}catch(e){a=Promise.reject(e)}}(a=a||Promise.resolve(o)).then((function(e){i.open("POST",e.url,!0);var t=!0;e.headers&&Object.entries(e.headers).forEach((function(e){var n=fn(e,2),r=n[0],a=n[1];"string"==typeof a&&i.setRequestHeader(r,a),t&&(t="content-type"!==r.toLowerCase())})),t&&i.setRequestHeader("Content-type","application/json"),n._logger.debug("Ready for license request"),i.onerror=function(){n._onError(G.Code.LICENSE_REQUEST_FAILED,{status:i.status,responseText:i.responseText})},n._licenseRequestTime=Date.now(),i.send(e.body)})).catch((function(e){n._errorCallback(new G(G.Severity.CRITICAL,G.Category.NETWORK,G.Code.REQUEST_FILTER_ERROR,e)),n.destroy()}))}},{key:"_onWebkitKeyAdded",value:function(){this._logger.debug("Decryption key was added to session")}},{key:"_onWebkitKeyError",value:function(e){this._logger.error("A decryption key error was encountered",e),this._retryLicenseRequest<=0&&this._onError(G.Code.LICENSE_REQUEST_FAILED,e.target.error),this._retryLicenseRequest--}},{key:"_licenseRequestLoaded",value:function(e){var t=this;this._logger.debug("License request loaded");var n=e.target;if(n.status>299)this._onError(G.Code.LICENSE_REQUEST_FAILED,{status:n.status,error:n.responseText});else{if(this._drmResponseCallback){var r=Date.now()-this._licenseRequestTime;this._drmResponseCallback({licenseTime:r/1e3,scheme:on.FAIRPLAY})}var i,a=n.responseURL,o=n.response,s={url:a,originalUrl:this._config.licenseUrl,data:o,headers:J.convertHeadersToDictionary(n.getAllResponseHeaders())};this._logger.debug("Apply response filter");try{i=this._config.network.responseFilter(Wt.LICENSE,s)}catch(e){i=Promise.reject(e)}(i=i||Promise.resolve(s)).then((function(e){t._keySession.update(e.data)})).catch((function(e){t._errorCallback(new G(G.Severity.CRITICAL,G.Category.NETWORK,G.Code.RESPONSE_FILTER_ERROR,e)),t.destroy()}))}}},{key:"_onError",value:function(e,t){this._errorCallback(new G(G.Severity.CRITICAL,G.Category.DRM,e,t))}},{key:"_selectKeySystem",value:function(){var e=null;return window.WebKitMediaKeys.isTypeSupported("com.apple.fps.1_0","video/mp4")?e="com.apple.fps.1_0":this._logger.warn("Key System not supported"),e}}])&&hn(t.prototype,n),r&&hn(t,r),e}();function yn(e){return(yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gn(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return vn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function vn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function En(e,t,n){return(En="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Rn(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function mn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bn(e,t,n){return t&&mn(e.prototype,t),n&&mn(e,n),e}function Tn(e,t){return(Tn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function kn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Rn(e);if(t){var i=Rn(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Sn(this,n)}}function Sn(e,t){return!t||"object"!==yn(t)&&"function"!=typeof t?wn(e):t}function wn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rn(e){return(Rn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Cn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}An(pn,"WebkitEvents",_n),pn.WebkitEvents=_n;var On=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tn(e,t)}(n,e);var t=kn(n);function n(e,r,i){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),n._logger.debug("Creating adapter"),Cn(wn(a=t.call(this,e,r,i)),"_lastTimeUpdate",0),Cn(wn(a),"_waitingEventTriggered",!1),Cn(wn(a),"_mediaErrorRecoveryAttempts",0),Cn(wn(a),"_lastTimeDetach",NaN),Cn(wn(a),"_startTimeAttach",NaN),a._config=Q.mergeDeep({},ln,a._config),a._progressiveSources=i.progressiveSources,a._liveEdge=0,a}return bn(n,null,[{key:"canPlayType",value:function(e){var t=!1;return"string"==typeof e&&(t=!!n.TEST_VIDEO.canPlayType(e.toLowerCase())),n._logger.debug("canPlayType result for mimeType:"+e+" is "+t.toString()),t}},{key:"canPlayDrm",value:function(e,t){n._drmProtocol=null;var r,i=gn(n._drmProtocols);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.isConfigured(e,t)){n._drmProtocol=a;break}}}catch(e){i.e(e)}finally{i.f()}if(!n._drmProtocol){var o,s=gn(n._drmProtocols);try{for(s.s();!(o=s.n()).done;){var u=o.value;u.canPlayDrm(e)&&(n._drmProtocol=u)}}catch(e){s.e(e)}finally{s.f()}}return!!n._drmProtocol}},{key:"createAdapter",value:function(e,t,n){var r={displayTextTrack:!1,progressiveSources:[]};return Q.hasPropertyPath(n,"playback.useNativeTextTrack")&&(r.displayTextTrack=Q.getPropertyPath(n,"playback.useNativeTextTrack")),Q.hasPropertyPath(n,"sources.progressive")&&(r.progressiveSources=Q.getPropertyPath(n,"sources.progressive")),n.playback&&(r.enableCEA708Captions=n.playback.enableCEA708Captions,r.captionsTextTrack1Label=n.playback.captionsTextTrack1Label,r.captionsTextTrack1LanguageCode=n.playback.captionsTextTrack1LanguageCode,r.captionsTextTrack2Label=n.playback.captionsTextTrack2Label,r.captionsTextTrack2LanguageCode=n.playback.captionsTextTrack2LanguageCode,Q.hasPropertyPath(n.playback,"options.html5.native")&&Q.mergeDeep(r,n.playback.options.html5.native)),r.network=n.network,new this(e,t,r)}}]),bn(n,[{key:"_dispatchErrorCallback",value:function(e){this._trigger(ie.ERROR,e)}},{key:"_dispatchDRMLicenseLoaded",value:function(e){this._trigger(ae.DRM_LICENSE_LOADED,e)}},{key:"_maybeSetDrmPlayback",value:function(){var e=this;if(n._drmProtocol&&this._sourceObj&&this._sourceObj.drmData){var t={licenseUrl:"",certificate:"",network:this._config.network};n._drmProtocol.setDrmPlayback(t,this._sourceObj.drmData),this._drmHandler=new pn(this._videoElement,t,(function(t){return e._dispatchErrorCallback(t)}),(function(t){return e._dispatchDRMLicenseLoaded(t)}))}}},{key:"_setProgressiveSource",value:function(){var e=function(e,t,n){var r=null;if(n&&e){var i,a=[],o=1/0,s=rn(e);try{for(s.s();!(i=s.n()).done;){var u=i.value,c=Math.abs(u.width-t);c<o?(o=c,a=[u]):c===o&&a.push(u)}}catch(e){s.e(e)}finally{s.f()}for(var l=t/n,f=a,d=1/0,h=0,A=a;h<A.length;h++){var _=A[h];if(_.height){var p=Math.abs(_.width/_.height-l);p<d?(d=p,f=[_]):p===d&&f.push(_)}}for(var y=0,g=0,v=f;g<v.length;g++){var E=v[g];(E.bandwidth>y||!E.bandwidth)&&(y=E.bandwidth||y,r=E)}}return r}(this._progressiveSources,this._videoElement.offsetWidth,this._videoElement.offsetHeight);e&&(this._sourceObj=e)}},{key:"_isProgressivePlayback",value:function(){return!!this._sourceObj&&"video/mp4"===this._sourceObj.mimetype}},{key:"load",value:function(e){var t=this;return this._maybeSetDrmPlayback(),this._loadPromise||(this._loadPromise=new Promise((function(n,r){t._lastTimeUpdate=e||0;var i=t._startTimeAttach||e||0;t._loadPromiseReject=r,t._eventManager.listenOnce(t._videoElement,ie.LOADED_DATA,(function(){return t._onLoadedData(n,i)})),t._eventManager.listen(t._videoElement,ie.TIME_UPDATE,(function(){return t._onTimeUpdate()})),t._eventManager.listen(t._videoElement,ie.PLAY,(function(){return t._resetHeartbeatTimeout()})),t._eventManager.listen(t._videoElement,ie.PAUSE,(function(){return t._clearHeartbeatTimeout()})),t._eventManager.listen(t._videoElement,ie.ENDED,(function(){return t._clearHeartbeatTimeout()})),t._eventManager.listen(t._videoElement,ie.ABORT,(function(){return t._clearHeartbeatTimeout()})),t._eventManager.listen(t._videoElement,ie.SEEKED,(function(){return t._syncCurrentTime()})),t._eventManager.listen(window,"focus",(function(){return setTimeout((function(){t._videoElement.currentTime=t._videoElement.currentTime>.1?t._videoElement.currentTime-.1:0,t._syncCurrentTime()}),1e3)})),t._isProgressivePlayback()&&t._setProgressiveSource(),t._sourceObj&&t._sourceObj.url?t._setSrc().then((function(){t._trigger(ae.ABR_MODE_CHANGED,{mode:t._isProgressivePlayback()?"manual":"auto"}),t._videoElement.load()})):t._videoElement.load()}))),this._loadPromise}},{key:"_handleDecodeError",value:function(e){var t=this;n._logger.debug("handleDecodeError",e);var r=this._videoElement.currentTime,i=this._getActivePKAudioTrack(),a=this._getActivePKTextTrack();this._videoElement.load(),this._eventManager.listenOnce(this._videoElement,ie.PLAYING,(function(){t._mediaErrorRecoveryAttempts=0})),this._eventManager.listenOnce(this._videoElement,ie.CAN_PLAY,(function(){t._videoElement.currentTime=r,t._videoElement.play(),t._videoElement.pause(),i&&t.selectAudioTrack(i),a?t.selectTextTrack(a):t._disableTextTracks()}))}},{key:"handleMediaError",value:function(e){return this._loadPromiseReject?(this._loadPromiseReject(new G(G.Severity.CRITICAL,G.Category.MEDIA,G.Code.NATIVE_ADAPTER_LOAD_FAILED,e)),!0):!!(e&&e.code===window.MediaError.MEDIA_ERR_DECODE&&(this._mediaErrorRecoveryAttempts++,this._mediaErrorRecoveryAttempts<=3))&&(this._handleDecodeError(e),!0)}},{key:"attachMediaSource",value:function(){this._startTimeAttach=this._lastTimeDetach,this._lastTimeDetach=NaN}},{key:"detachMediaSource",value:function(){this._lastTimeDetach=this.currentTime,this._videoElement&&this._videoElement.src&&($.setAttribute(this._videoElement,"src",""),$.removeAttribute(this._videoElement,"src")),this._loadPromise=null}},{key:"_setSrc",value:function(){var e,t=this,r={url:this._sourceObj?this._sourceObj.url:"",body:null,headers:{}};if("function"==typeof Q.getPropertyPath(this._config,"network.requestFilter"))try{n._logger.debug("Apply request filter"),e=this._config.network.requestFilter(Wt.MANIFEST,r)}catch(t){e=Promise.reject(t)}return(e=e||Promise.resolve(r)).then((function(e){t._videoElement.src=e.url})).catch((function(e){t._trigger(ie.ERROR,new G(G.Severity.CRITICAL,G.Category.NETWORK,G.Code.REQUEST_FILTER_ERROR,e))})),e}},{key:"_onLoadedData",value:function(e,t){var r=this,i=function(){r._playerTracks=r._getParsedTracks(),r._addNativeAudioTrackChangeListener(),r._addNativeTextTrackChangeListener(),r._addNativeTextTrackAddedListener(),n._logger.debug("The source has been loaded successfully"),r._loadPromiseReject=null,e({tracks:r._playerTracks}),r.isLive()&&r._handleLiveDurationChange()};t&&t>-1&&(this._videoElement.currentTime=t),this._videoElement.textTracks.length>0?i():this._eventManager.listenOnce(this._videoElement,ie.CAN_PLAY,i.bind(this)),this._startTimeAttach=NaN}},{key:"_onTimeUpdate",value:function(){this._videoElement.paused||(this._videoElement.currentTime>this._lastTimeUpdate?(this._waitingEventTriggered&&(this._waitingEventTriggered=!1,this._trigger(ie.PLAYING)),this._resetHeartbeatTimeout()):this._videoElement.currentTime<this._lastTimeUpdate?this._syncCurrentTime():(this._waitingEventTriggered=!0,this._trigger(ie.WAITING)))}},{key:"_syncCurrentTime",value:function(){this._lastTimeUpdate=this._videoElement.currentTime}},{key:"_resetHeartbeatTimeout",value:function(){var e=this;this._lastTimeUpdate=this._videoElement.currentTime,this._clearHeartbeatTimeout();this._heartbeatTimeoutId=setTimeout((function(){e._clearHeartbeatTimeout(),e._trigger(ie.ERROR,new G(G.Severity.CRITICAL,G.Category.NETWORK,G.Code.TIMEOUT,"The player exceeded max buffer time of ".concat(e._config.heartbeatTimeout," ms. No progress has been done during this time.")))}),this._config.heartbeatTimeout)}},{key:"_clearHeartbeatTimeout",value:function(){this._heartbeatTimeoutId&&(clearTimeout(this._heartbeatTimeoutId),this._heartbeatTimeoutId=null)}},{key:"destroy",value:function(){var e=this;return n._logger.debug("destroy"),En(Rn(n.prototype),"destroy",this).call(this).then((function(){e._drmHandler&&e._drmHandler.destroy(),e._waitingEventTriggered=!1,e._progressiveSources=[],e._loadPromise=null,e._loadPromiseReject=null,e._liveEdge=0,e._lastTimeUpdate=0,e._lastTimeDetach=NaN,e._startTimeAttach=NaN,e._clearHeartbeatTimeout(),e._liveDurationChangeInterval&&(clearInterval(e._liveDurationChangeInterval),e._liveDurationChangeInterval=null)}))}},{key:"_getParsedTracks",value:function(){var e=this._getParsedVideoTracks(),t=this._getParsedAudioTracks(),n=this._getParsedTextTracks();return e.concat(t).concat(n)}},{key:"_getParsedVideoTracks",value:function(){return this._isProgressivePlayback()?this._getParsedProgressiveVideoTracks():this._getParsedAdaptiveVideoTracks()}},{key:"_getParsedProgressiveVideoTracks",value:function(){var e=this._progressiveSources,t=[];if(e)for(var n=0;n<e.length;n++){var r={id:e[n].id,bandwidth:e[n].bandwidth,width:e[n].width,height:e[n].height,active:!!this._sourceObj&&e[n].id===this._sourceObj.id,index:n};t.push(new Se(r))}return t}},{key:"_getParsedAdaptiveVideoTracks",value:function(){var e=this._videoElement.videoTracks,t=[];if(e)for(var n=0;n<e.length;n++){var r={id:e[n].id,active:e[n].selected,label:e[n].label,language:e[n].language,index:n};t.push(new Se(r))}return t}},{key:"_getParsedAudioTracks",value:function(){var e=this._videoElement.audioTracks,t=[];if(e)for(var n=0;n<e.length;n++){var r={id:e[n].id,active:e[n].enabled,label:e[n].label,language:e[n].language,index:n};t.push(new Pe(r))}return t}},{key:"_getParsedTextTracks",value:function(){var e=[this._config.captionsTextTrack1Label,this._config.captionsTextTrack2Label],t=[this._config.captionsTextTrack1LanguageCode,this._config.captionsTextTrack2LanguageCode],n=this._videoElement.textTracks,r=[];if(n)for(var i=0;i<n.length;i++){var a={kind:n[i].kind,active:"showing"===n[i].mode,label:n[i].label,language:n[i].language,index:i};"subtitles"===a.kind?r.push(new Be(a)):"captions"===a.kind&&this._config.enableCEA708Captions&&(a.label=a.label||e.shift(),a.language=a.language||t.shift(),r.push(new Be(a)))}return r}},{key:"selectVideoTrack",value:function(e){this._isProgressivePlayback()?this._selectProgressiveVideoTrack(e):this.selectAdaptiveVideoTrack(e)}},{key:"_selectProgressiveVideoTrack",value:function(e){var t=this,n=this._progressiveSources;if(e instanceof Se&&n&&n[e.index]){var r=this._videoElement.currentTime,i=this._videoElement.paused;this._sourceObj=n[e.index],this._eventManager.listenOnce(this._videoElement,ie.LOADED_DATA,(function(){"Android Browser"===_.browser.name?(t._eventManager.listenOnce(t._videoElement,ie.DURATION_CHANGE,(function(){t._videoElement.currentTime=r})),t._eventManager.listenOnce(t._videoElement,ie.SEEKED,(function(){t._onTrackChanged(e),i&&t._videoElement.pause()})),t._videoElement.play()):(t._eventManager.listenOnce(t._videoElement,ie.SEEKED,(function(){t._onTrackChanged(e)})),t._videoElement.currentTime=r,i||t._videoElement.play())})),this._setSrc()}}},{key:"selectAdaptiveVideoTrack",value:function(e){var t=this._videoElement.videoTracks;e instanceof Se&&t&&t[e.index]&&(this._disableVideoTracks(),t[e.index].selected=!0,this._onTrackChanged(e))}},{key:"selectAudioTrack",value:function(e){var t=this._videoElement.audioTracks;e instanceof Pe&&t&&t[e.index]&&(this._removeNativeAudioTrackChangeListener(),this._disableAudioTracks(),t[e.index].enabled=!0,this._onTrackChanged(e),this._addNativeAudioTrackChangeListener())}},{key:"_removeNativeAudioTrackChangeListener",value:function(){this._videoElement.audioTracks&&this._eventManager.unlisten(this._videoElement.audioTracks,"change")}},{key:"_addNativeAudioTrackChangeListener",value:function(){var e=this;this._videoElement.audioTracks&&this._eventManager.listen(this._videoElement.audioTracks,"change",(function(){return e._onNativeAudioTrackChange()}))}},{key:"_getPKAudioTracks",value:function(){return this._playerTracks.filter((function(e){return e instanceof Pe}))}},{key:"_getActivePKAudioTrack",value:function(){return this._getPKAudioTracks().find((function(e){return!0===e.active}))}},{key:"_onNativeAudioTrackChange",value:function(){var e=this;n._logger.debug("Video element audio track change");var t=function(){for(var t=0;t<e._videoElement.audioTracks.length;t++){if(e._videoElement.audioTracks[t].enabled)return t}return-1}(),r=this._getActivePKAudioTrack(),i=r?r.index:-1;if(t!==i){var a=this._getPKAudioTracks().find((function(e){return e.index===t}));a&&(n._logger.debug("Native selection of track, update the player audio track ("+i+" -> "+t+")"),this._onTrackChanged(a))}}},{key:"selectTextTrack",value:function(e){var t=this._videoElement.textTracks;if(e instanceof Be&&("subtitles"===e.kind||"captions"===e.kind)&&t){this._removeNativeTextTrackChangeListener();var r=Array.from(t).find((function(t,n){return e.index===n&&t&&("subtitles"===t.kind||"captions"===t.kind)}));r&&(this._disableTextTracks(),r.mode=this._getDisplayTextTrackModeString(),n._logger.debug("Text track changed",r),this._onTrackChanged(e),this._addNativeTextTrackChangeListener())}}},{key:"_removeNativeTextTrackChangeListener",value:function(){this._videoElement.textTracks&&this._eventManager.unlisten(this._videoElement.textTracks,"change")}},{key:"_addNativeTextTrackChangeListener",value:function(){var e=this;this._videoElement.textTracks&&this._eventManager.listen(this._videoElement.textTracks,"change",(function(){return e._onNativeTextTrackChange()}))}},{key:"_getPKTextTracks",value:function(){return this._playerTracks.filter((function(e){return e instanceof Be}))}},{key:"_getActivePKTextTrack",value:function(){return this._getPKTextTracks().find((function(e){return!0===e.active}))}},{key:"_onNativeTextTrackChange",value:function(){var e=this,t=this._getPKTextTracks(),r=t.find((function(e){return"off"===e.language}));n._logger.debug("Video element text track change");var i=function(){for(var t=0;t<e._videoElement.textTracks.length;t++){var n=e._videoElement.textTracks[t];if(e._getDisplayTextTrackModeString()===n.mode)return t}return-1}(),a=this._getActivePKTextTrack(),o=a?a.index:-1;if(i!==o)if(-1==i)r&&(n._logger.debug("Native selection of track, update the player text track ("+o+" -> off)"),this._onTrackChanged(r));else{var s=t.find((function(e){return e.index===i}));s&&(n._logger.debug("Native selection of track, update the player text track ("+o+" -> "+i+")"),this._onTrackChanged(s))}}},{key:"_getDisplayTextTrackModeString",value:function(){return this._config.displayTextTrack?"showing":"hidden"}},{key:"_addNativeTextTrackAddedListener",value:function(){var e=this;!this._config.displayTextTrack&&this._videoElement.textTracks&&this._eventManager.listen(this._videoElement.textTracks,"addtrack",(function(){return e._onNativeTextTrackAdded()}))}},{key:"_onNativeTextTrackAdded",value:function(){this._playerTracks=this._getParsedTracks(),this._trigger(ae.TRACKS_CHANGED,{tracks:this._playerTracks})}},{key:"hideTextTrack",value:function(){this._disableTextTracks()}},{key:"enableAdaptiveBitrate",value:function(){n._logger.warn("Enabling adaptive bitrate is not supported for native playback")}},{key:"isAdaptiveBitrateEnabled",value:function(){return!this._isProgressivePlayback()}},{key:"_disableVideoTracks",value:function(){var e=this._videoElement.videoTracks;if(e)for(var t=0;t<e.length;t++)e[t].selected=!1}},{key:"_disableAudioTracks",value:function(){var e=this._videoElement.audioTracks;if(e)for(var t=0;t<e.length;t++)e[t].enabled=!1}},{key:"_disableTextTracks",value:function(){var e=this._videoElement.textTracks;if(e)for(var t=0;t<e.length;t++)("subtitles"===e[t].kind||"captions"===e[t].kind)&&(e[t].mode="disabled")}},{key:"_getLiveEdge",value:function(){return this._videoElement.seekable.length?this._videoElement.seekable.end(this._videoElement.seekable.length-1):this._videoElement.buffered.length?this._videoElement.buffered.end(this._videoElement.buffered.length-1):this._videoElement.duration}},{key:"seekToLiveEdge",value:function(){try{this._videoElement.currentTime=this._getLiveEdge()}catch(e){return}}},{key:"isLive",value:function(){return this._videoElement.duration===1/0}},{key:"_handleLiveDurationChange",value:function(){var e=this;this._liveDurationChangeInterval=setInterval((function(){var t=e._getLiveEdge();e._liveEdge!==t&&(e._liveEdge=t,e._videoElement.dispatchEvent(new window.Event(ie.DURATION_CHANGE)))}),2e3)}},{key:"getStartTimeOfDvrWindow",value:function(){return this.isLive()&&this._videoElement.seekable.length?this._videoElement.seekable.start(0):0}}]),n}(nn);function Dn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function In(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Cn(On,"id","NativeAdapter"),Cn(On,"_logger",nn.getLogger(On.id)),Cn(On,"TEST_VIDEO",$.createElement("video")),Cn(On,"_drmProtocols",[cn]),Cn(On,"_drmProtocol",null);var Pn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"register",value:function(t){t&&(e._mediaSourceAdapters.includes(t)?e._logger.debug("Adapter <".concat(t.id,"> is already registered, do not register again")):(e._logger.debug("Adapter <".concat(t.id,"> has been registered successfully")),e._mediaSourceAdapters.push(t)))}},{key:"unRegister",value:function(t){var n=e._mediaSourceAdapters.indexOf(t);n>-1&&(e._logger.debug("Unregistered <".concat(t.id,"> adapter")),e._mediaSourceAdapters.splice(n,1))}},{key:"canPlaySource",value:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0;e._orderMediaSourceAdapters(n);var i=e._mediaSourceAdapters;if(t&&t.mimetype)for(var a=0;a<i.length;a++)if(i[a].canPlayType(t.mimetype)&&(!t.drmData||i[a].canPlayDrm(t.drmData,r)))return e._selectedAdapter=i[a],e._logger.debug("Selected adapter is <".concat(e._selectedAdapter.id,">")),!0;return!1}},{key:"_orderMediaSourceAdapters",value:function(t){e._mediaSourceAdapters=e._mediaSourceAdapters.filter((function(e){return"NativeAdapter"!==e.id})),t?e._mediaSourceAdapters.unshift(On):e._mediaSourceAdapters.push(On)}},{key:"getMediaSourceAdapter",value:function(t,n,r){return t&&n&&r?(e._selectedAdapter||e.canPlaySource(n,!0,r.drm),e._selectedAdapter?e._selectedAdapter.createAdapter(t,n,r):null):null}},{key:"destroy",value:function(){e._selectedAdapter=null}}],(n=null)&&Dn(t.prototype,n),r&&Dn(t,r),e}();In(Pn,"_logger",F("MediaSourceProvider")),In(Pn,"_mediaSourceAdapters",[On]),In(Pn,"_selectedAdapter",null);var Nn,Ln,xn=Pn.register,Mn=n(3);function Un(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var jn=(Ln=Nn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"runCapability",value:function(){e._capabilities.autoplay||"boolean"==typeof e._capabilities.autoplay&&"boolean"==typeof e._capabilities.mutedAutoPlay?e._playPromiseResult=Promise.resolve(e._capabilities):(e._vid||(e._vid=$.createElement("video"),e._vid.src=Mn.a,e._vid.setAttribute("playsinline","")),e._playPromiseResult=new Promise((function(t){e._setMuted(!1),e._getPlayPromise().then((function(){return t({autoplay:!0,mutedAutoPlay:!0})})).catch((function(){e._setMuted(!0),e._getPlayPromise().then((function(){return t({autoplay:!1,mutedAutoPlay:!0})})).catch((function(){return t({autoplay:!1,mutedAutoPlay:!1})}))}))})))}},{key:"getCapability",value:function(){return e._playPromiseResult.then((function(t){var n;return t.autoplay?n=Promise.resolve(t):(e.runCapability(),n=e._playPromiseResult),n.then((function(t){return Q.mergeDeep(t,e._capabilities)}))}))}},{key:"setCapabilities",value:function(t){e._logger.debug("Set player capabilities",t);var n=t.autoplay,r=t.mutedAutoPlay;"boolean"==typeof n&&(e._capabilities.autoplay=n),"boolean"==typeof r&&(e._capabilities.mutedAutoPlay=r)}},{key:"_getPlayPromise",value:function(){return e._vid.play()||e._forcePromiseReturnValue()}},{key:"_setMuted",value:function(t){t?(e._vid.muted=!0,e._vid.setAttribute("muted","")):(e._vid.muted=!1,e._vid.removeAttribute("muted"))}},{key:"_forcePromiseReturnValue",value:function(){return new Promise((function(t,n){e._vid.addEventListener(ie.ERROR,(function(){n()}));var r=setTimeout((function(){e._logger.debug("Timeout ".concat(500," ms has been reached")),n()}),500);!0===e._vid.paused?(clearTimeout(r),n()):(clearTimeout(r),t())}))}}],(n=null)&&Un(t.prototype,n),r&&Un(t,r),e}(),Fn(Nn,"_logger",F("Html5AutoPlayCapability")),Fn(Nn,"_capabilities",{}),Ln);function Bn(e){return(Bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Gn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Gn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Hn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yn(e,t){return(Yn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Xn(e);if(t){var i=Xn(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Kn(this,n)}}function Kn(e,t){return!t||"object"!==Bn(t)&&"function"!=typeof t?zn(e):t}function zn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xn(e){return(Xn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Qn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yn(e,t)}(a,e);var t,n,r,i=Wn(a);function a(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),qn(zn(r=i.call(this)),"_droppedFramesInterval",null),qn(zn(r),"_lastDroppedFrames",0),qn(zn(r),"_lastDecodedFrames",0),qn(zn(r),"_lastTime",0),qn(zn(r),"_currentBitrate",0),r._eventManager=new I,r._mediaSourceAdapter=e,r._config=t,r._videoElement=n,r._mediaSourceAdapter.capabilities.fpsControl?(r._eventManager.listen(r._mediaSourceAdapter,ae.FPS_DROP,(function(e){return r._triggerFPSDrop(e.payload.data)})),Kn(r)):(-1===r._getDroppedAndDecodedFrames()[0]?a._logger.debug("Dropped frame watcher is not supported"):r._config.capLevelOnFPSDrop&&r._init(),r)}return t=a,(n=[{key:"_init",value:function(){var e=this;this._eventManager.listen(this._mediaSourceAdapter,ae.VIDEO_TRACK_CHANGED,(function(t){return e._currentBitrate=t.payload.selectedVideoTrack.bandwidth})),this._droppedFramesInterval=setInterval((function(){return e._checkFPS()}),this._config.fpsDroppedFramesInterval)}},{key:"_triggerFPSDrop",value:function(e){this.dispatchEvent(new m(ae.FPS_DROP,e))}},{key:"_getDroppedAndDecodedFrames",value:function(){if("function"==typeof this._videoElement.getVideoPlaybackQuality){var e=this._videoElement.getVideoPlaybackQuality();return[e.droppedVideoFrames,e.totalVideoFrames]}return"number"==typeof this._videoElement.webkitDroppedFrameCount&&"number"==typeof this._videoElement.webkitDecodedFrameCount?[this._videoElement.webkitDroppedFrameCount,this._videoElement.webkitDecodedFrameCount]:[-1,-1]}},{key:"_checkFPS",value:function(){var e=Vn(this._getDroppedAndDecodedFrames(),2),t=e[0],n=e[1];try{var r=performance.now();if(n){if(this._lastTime){var i=r-this._lastTime,o=t-this._lastDroppedFrames,s=n-this._lastDecodedFrames,u=1e3*o/i;u>0&&(a._logger.debug("checkFPS : droppedFPS/decodedFPS:"+u/(1e3*s/i)),o>this._config.fpsDroppedMonitoringThreshold*s&&(this._mediaSourceAdapter.setMaxBitrate(this._currentBitrate-1),this._triggerFPSDrop({currentDropped:o,currentDecoded:s,totalDroppedFrames:u})))}this._lastTime=r,this._lastDroppedFrames=t,this._lastDecodedFrames=n}}catch(e){a._logger.error("Error occur while trying to check dropFrames: ",e)}}},{key:"destroy",value:function(){this._droppedFramesInterval&&clearInterval(this._droppedFramesInterval),this._droppedFramesInterval=null,this._eventManager.destroy()}}])&&Hn(t.prototype,n),r&&Hn(t,r),a}(T);function Zn(e){return(Zn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $n(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Jn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Jn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Jn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function er(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tr(e,t,n){return t&&er(e.prototype,t),n&&er(e,n),e}function nr(e,t){return(nr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ar(e);if(t){var i=ar(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ir(this,n)}}function ir(e,t){return!t||"object"!==Zn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ar(e){return(ar=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function or(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}qn(Qn,"_logger",F("droppedFramesWatcher"));var sr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nr(e,t)}(n,e);var t=rr(n);function n(e,r,i){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this))._eventManager=new I,a._canLoadMediaSourceAdapterPromise=Promise.resolve(),a._createVideoElement(i),a._init(e,r),a}return tr(n,null,[{key:"isSupported",value:function(){try{var e=$.createElement("video");return e.volume=.5,!!e.canPlayType}catch(e){return!1}}},{key:"createEngine",value:function(e,t,n){return new this(e,t,n)}},{key:"canPlaySource",value:function(e,t,n){return Pn.canPlaySource(e,t,n)}},{key:"runCapabilities",value:function(){n._capabilities.forEach((function(e){return e.runCapability()}))}},{key:"getCapabilities",value:function(){var e=[];return n._capabilities.forEach((function(t){return e.push(t.getCapability())})),Promise.all(e).then((function(e){var t={};return e.forEach((function(e){return Object.assign(t,e)})),or({},n.id,t)}))}},{key:"setCapabilities",value:function(e){n._capabilities.forEach((function(t){return t.setCapabilities(e)}))}},{key:"prepareVideoElement",value:function(e){if(!n.videoElementStore[e]){n._logger.debug("Create the video element for playing ".concat(e));var t=$.createElement("video");n.videoElementStore[e]=t}n._logger.debug("Prepare the video element for playing ".concat(e)),n.videoElementStore[e].load()}}]),tr(n,[{key:"restore",value:function(e,t){this.reset(),this._init(e,t)}},{key:"reset",value:function(){this._eventManager.removeAll(),this._droppedFramesWatcher&&(this._droppedFramesWatcher.destroy(),this._droppedFramesWatcher=null),this._mediaSourceAdapter&&(this._canLoadMediaSourceAdapterPromise=this._mediaSourceAdapter.destroy(),this._mediaSourceAdapter=null),this._el&&this._el.src&&($.setAttribute(this._el,"src",""),$.removeAttribute(this._el,"src"))}},{key:"destroy",value:function(){this.detach(),this._el&&(this.pause(),$.removeAttribute(this._el,"src"),$.removeChild(this._el.parentNode,this._el)),this._eventManager.destroy(),Pn.destroy(),this._droppedFramesWatcher&&(this._droppedFramesWatcher.destroy(),this._droppedFramesWatcher=null),this._mediaSourceAdapter&&(this._mediaSourceAdapter.destroy(),this._mediaSourceAdapter=null)}},{key:"attachMediaSource",value:function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.attachMediaSource()}},{key:"detachMediaSource",value:function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.detachMediaSource()}},{key:"attach",value:function(){var e=this;Object.keys(ie).forEach((function(t){e._eventManager.listen(e._el,ie[t],(function(){ie[t]===ie.ERROR?e._handleVideoError():e.dispatchEvent(new m(ie[t]))}))})),this._handleMetadataTrackEvents();var t=this._mediaSourceAdapter;t&&(this._eventManager.listen(t,ae.VIDEO_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,ae.AUDIO_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,ae.TEXT_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,ae.ABR_MODE_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,ae.TEXT_CUE_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,ae.TRACKS_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,ae.FRAG_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,ae.DRM_LICENSE_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,ae.MANIFEST_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,ie.ERROR,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,ie.TIME_UPDATE,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,ie.PLAYING,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,ie.WAITING,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,ae.MEDIA_RECOVERED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,"hlsFragParsingMetadata",(function(t){return e.dispatchEvent(t)})),this._droppedFramesWatcher&&this._eventManager.listen(this._droppedFramesWatcher,ae.FPS_DROP,(function(t){return e.dispatchEvent(t)})))}},{key:"detach",value:function(){var e=this;Object.keys(ie).forEach((function(t){e._eventManager.unlisten(e._el,ie[t])})),this._mediaSourceAdapter&&(this._eventManager.unlisten(this._mediaSourceAdapter,ae.VIDEO_TRACK_CHANGED),this._eventManager.unlisten(this._mediaSourceAdapter,ae.AUDIO_TRACK_CHANGED),this._eventManager.unlisten(this._mediaSourceAdapter,ae.TEXT_TRACK_CHANGED),this._eventManager.unlisten(this._mediaSourceAdapter,ae.TEXT_CUE_CHANGED))}},{key:"getVideoElement",value:function(){return this._el}},{key:"selectVideoTrack",value:function(e){this._mediaSourceAdapter&&this._mediaSourceAdapter.selectVideoTrack(e)}},{key:"selectAudioTrack",value:function(e){this._mediaSourceAdapter&&this._mediaSourceAdapter.selectAudioTrack(e)}},{key:"selectTextTrack",value:function(e){this._removeCueChangeListeners(),this._mediaSourceAdapter&&this._mediaSourceAdapter.selectTextTrack(e),this.resetAllCues(),this._addCueChangeListener()}},{key:"hideTextTrack",value:function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.hideTextTrack(),this._removeCueChangeListeners()}},{key:"enableAdaptiveBitrate",value:function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.enableAdaptiveBitrate()}},{key:"isAdaptiveBitrateEnabled",value:function(){return!!this._mediaSourceAdapter&&this._mediaSourceAdapter.isAdaptiveBitrateEnabled()}},{key:"seekToLiveEdge",value:function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.seekToLiveEdge()}},{key:"getStartTimeOfDvrWindow",value:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.getStartTimeOfDvrWindow():0}},{key:"isLive",value:function(){return!!this._mediaSourceAdapter&&this._mediaSourceAdapter.isLive()}},{key:"play",value:function(){var e=this,t=this._el.play();return t&&t.catch((function(t){return e.dispatchEvent(new m(ae.PLAY_FAILED,{error:t}))})),t}},{key:"pause",value:function(){return this._el.pause()}},{key:"load",value:function(e){var t=this;return this._el.load(),this._canLoadMediaSourceAdapterPromise.then((function(){return t._mediaSourceAdapter?t._mediaSourceAdapter.load(e).catch((function(e){return Promise.reject(e)})):Promise.resolve({})})).catch((function(e){return Promise.reject(e)}))}},{key:"enterPictureInPicture",value:function(){var e=this;try{document.pictureInPictureEnabled&&"function"==typeof this._el.requestPictureInPicture?this._el.requestPictureInPicture().catch((function(t){e.dispatchEvent(new m(ie.ERROR,new G(G.Severity.RECOVERABLE,G.Category.PLAYER,G.Code.ENTER_PICTURE_IN_PICTURE_FAILED,t)))})):"function"==typeof this._el.webkitSetPresentationMode&&(this._el.webkitSetPresentationMode("picture-in-picture"),setTimeout((function(){return e.dispatchEvent(new m(ie.ENTER_PICTURE_IN_PICTURE))}),0))}catch(e){this.dispatchEvent(new m(ie.ERROR,new G(G.Severity.RECOVERABLE,G.Category.PLAYER,G.Code.ENTER_PICTURE_IN_PICTURE_FAILED,e)))}}},{key:"exitPictureInPicture",value:function(){var e=this;try{document.pictureInPictureEnabled&&"function"==typeof document.exitPictureInPicture?document.exitPictureInPicture().catch((function(t){e.dispatchEvent(new m(ie.ERROR,new G(G.Severity.RECOVERABLE,G.Category.PLAYER,G.Code.EXIT_PICTURE_IN_PICTURE_FAILED,t)))})):"function"==typeof this._el.webkitSetPresentationMode&&(this._el.webkitSetPresentationMode("inline"),setTimeout((function(){return e.dispatchEvent(new m(ie.LEAVE_PICTURE_IN_PICTURE))}),0))}catch(e){this.dispatchEvent(new m(ie.ERROR,new G(G.Severity.RECOVERABLE,G.Category.PLAYER,G.Code.EXIT_PICTURE_IN_PICTURE_FAILED,e)))}}},{key:"isPictureInPictureSupported",value:function(){return"function"==typeof this._el.webkitSupportsPresentationMode?this._el.webkitSupportsPresentationMode("picture-in-picture"):!!document.pictureInPictureEnabled}},{key:"_init",value:function(e,t){this._config=t,this._loadMediaSourceAdapter(e),this.attach()}},{key:"_createVideoElement",value:function(e){this._el=n.videoElementStore[e]||$.createElement("video"),this._el.id=Z.uniqueId(5),this._el.controls=!1}},{key:"_loadMediaSourceAdapter",value:function(e){this._mediaSourceAdapter=Pn.getMediaSourceAdapter(this.getVideoElement(),e,this._config),this._mediaSourceAdapter&&(this._droppedFramesWatcher=new Qn(this._mediaSourceAdapter,this._config.abr,this._el))}},{key:"_addCueChangeListener",value:function(){var e=this,t=Array.from(this._el.textTracks).find((function(e){return e&&"disabled"!==e.mode}));t&&this._eventManager.listen(t,"cuechange",(function(t){return e._onCueChange(t)}))}},{key:"_removeCueChangeListeners",value:function(){for(var e=0;e<this._el.textTracks.length;e++)this._eventManager.unlisten(this._el.textTracks[e],"cuechange")}},{key:"_onCueChange",value:function(e){var t,n=[],r=$n(e.currentTarget.activeCues);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(window.VTTCue&&i instanceof window.VTTCue)n.push(i);else if(window.TextTrackCue&&i instanceof window.TextTrackCue)try{n.push(new Rt(i.startTime,i.endTime,i.text))}catch(e){new G(G.Severity.RECOVERABLE,G.Category.TEXT,G.Code.UNABLE_TO_CREATE_TEXT_CUE,e)}}}catch(e){r.e(e)}finally{r.f()}this.dispatchEvent(new m(ae.TEXT_CUE_CHANGED,{cues:n}))}},{key:"resetAllCues",value:function(){var e=Array.from(this._el.textTracks).find((function(e){return e&&"disabled"!==e.mode}));if(e)for(var t=0;t<e.cues.length;t++)e.cues[t].hasBeenReset=!0}},{key:"_handleVideoError",value:function(){if(this._el.error){var e=this._el.error.code;if(e!==window.MediaError.MEDIA_ERR_ABORTED){var t=this._getMsExtendedError(),n=this._el.error.message;if(this._mediaSourceAdapter&&!this._mediaSourceAdapter.handleMediaError(this._el.error)){var r=new G(G.Severity.CRITICAL,G.Category.MEDIA,G.Code.VIDEO_ERROR,{code:e,extended:t,message:n});this.dispatchEvent(new m(ie.ERROR,r))}}}}},{key:"_getMsExtendedError",value:function(){var e=this._el.error.msExtendedCode;return e&&(e<0&&(e+=Math.pow(2,32)),e=e.toString(16)),e}},{key:"_handleMetadataTrackEvents",value:function(){var e=this,t=function(t){t.mode="hidden",e._eventManager.listen(t,"cuechange",(function(){e.dispatchEvent(new m(ae.TIMED_METADATA,{cues:Array.from(t.activeCues)}))}))},n=Array.from(this._el.textTracks).find((function(e){return"metadata"===e.kind}));n?t(n):this._eventManager.listen(this._el.textTracks,"addtrack",(function(n){"metadata"===n.track.kind?t(n.track):Array.from(e._el.textTracks).forEach((function(e){"metadata"===e.kind&&setTimeout((function(){return e.mode="hidden"}),100)}))}))}},{key:"id",get:function(){return n.id}},{key:"src",set:function(e){this._mediaSourceAdapter&&(this._mediaSourceAdapter.src=e)},get:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.src:""}},{key:"currentTime",get:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.currentTime:0},set:function(e){this._mediaSourceAdapter&&(this._mediaSourceAdapter.currentTime=e)}},{key:"duration",get:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.duration:NaN}},{key:"volume",set:function(e){this._el.volume=e},get:function(){return this._el.volume}},{key:"paused",get:function(){return this._el.paused}},{key:"seeking",get:function(){return this._el.seeking}},{key:"seekable",get:function(){return this._el.seekable}},{key:"played",get:function(){return this._el.played}},{key:"buffered",get:function(){return this._el.buffered}},{key:"muted",set:function(e){this._el.muted=e},get:function(){return this._el.muted}},{key:"defaultMuted",get:function(){return this._el.defaultMuted}},{key:"poster",set:function(e){this._el.poster=e},get:function(){return this._el.poster}},{key:"preload",set:function(e){this._el.preload=e},get:function(){return this._el.preload}},{key:"autoplay",set:function(e){this._el.autoplay=e},get:function(){return this._el.autoplay}},{key:"loop",set:function(e){this._el.loop=e},get:function(){return this._el.loop}},{key:"controls",set:function(e){this._el.controls=e},get:function(){return this._el.controls}},{key:"playbackRate",set:function(e){this._el.playbackRate=e},get:function(){return this._el.playbackRate}},{key:"defaultPlaybackRate",set:function(e){this._el.defaultPlaybackRate=e},get:function(){return this._el.defaultPlaybackRate}},{key:"ended",get:function(){return this._el.ended}},{key:"error",get:function(){return this._el.error}},{key:"networkState",get:function(){return this._el.networkState}},{key:"readyState",get:function(){return this._el.readyState}},{key:"videoHeight",get:function(){return this._el.videoHeight}},{key:"videoWidth",get:function(){return this._el.videoWidth}},{key:"playsinline",set:function(e){e?this._el.setAttribute("playsinline",""):this._el.removeAttribute("playsinline")},get:function(){return""===this._el.getAttribute("playsinline")}},{key:"crossOrigin",set:function(e){"string"==typeof e?this._el.setAttribute("crossorigin",e):this._el.removeAttribute("crossorigin")},get:function(){return this._el.getAttribute("crossorigin")}},{key:"playbackRates",get:function(){return n.PLAYBACK_RATES}},{key:"isInPictureInPicture",get:function(){return!!document.pictureInPictureElement&&null!=document.pictureInPictureElement&&this._el===document.pictureInPictureElement||!!this._el.webkitPresentationMode&&"picture-in-picture"===this._el.webkitPresentationMode}},{key:"targetBuffer",get:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.targetBuffer:NaN}},{key:"availableBuffer",get:function(){var e=0;if(this.buffered)for(var t=0;t<this.buffered.length;t++)this.buffered.start(t)<=this._el.currentTime&&this._el.currentTime<=this.buffered.end(t)&&(e=this.buffered.end(t)-this._el.currentTime);return e}}]),n}(T);function ur(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}or(sr,"_logger",F("Html5")),or(sr,"_capabilities",[jn]),or(sr,"id","html5"),or(sr,"videoElementStore",{}),or(sr,"PLAYBACK_RATES",[.5,1,2,4]);var lr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"register",value:function(t,n){t&&!e._engineProviders[t]?(e._logger.debug("Engine <".concat(t,"> has been registered successfully")),e._engineProviders[t]=n):e._logger.debug("Engine <".concat(t,"> is already registered, do not register again"))}},{key:"unRegister",value:function(t){e._engineProviders[t]&&(e._logger.debug("Unregistered <".concat(t,"> Engine")),delete e._engineProviders[t])}},{key:"getEngines",value:function(){return Object.keys(e._engineProviders).map((function(t){return e._engineProviders[t]}))}},{key:"destroy",value:function(){e._engineProviders={}}}],(n=null)&&ur(t.prototype,n),r&&ur(t,r),e}();cr(lr,"_logger",F("EngineProvider")),cr(lr,"_engineProviders",{}),sr.isSupported()&&lr.register(sr.id,sr);var fr=lr.register,dr=lr.unRegister;function hr(e){return(hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ar(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _r(e,t){return(_r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vr(e);if(t){var i=vr(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return yr(this,n)}}function yr(e,t){return!t||"object"!==hr(t)&&"function"!=typeof t?gr(e):t}function gr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vr(e){return(vr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Er(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var mr=1,br=2,Tr=3,kr="srt",Sr="vtt",wr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_r(e,t)}(a,e);var t,n,r,i=pr(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),Er(gr(t=i.call(this)),"_externalCueIndex",0),Er(gr(t),"_textTrackModel",{}),Er(gr(t),"_activeTextCues",[]),Er(gr(t),"_isTextTrackActive",!1),Er(gr(t),"_lastTimeUpdate",0),t._player=e,t._eventManager=new I,t}return t=a,(n=[{key:"hideTextTrack",value:function(){this._isTextTrackActive&&(this._eventManager.unlisten(this._player,ie.TIME_UPDATE),this.dispatchEvent(new m(ae.TEXT_CUE_CHANGED,{cues:[]})),this._resetCurrentTrack())}},{key:"getExternalTracks",value:function(e){var t=this,n=this._player.config.sources.captions;if(!n)return[];var r=e.filter((function(e){return e instanceof Be})),i=r.length||0,a=[];return n.forEach((function(e){if(e.language){var n=t._createTextTrack(e,i++);t._maybeAddTrack(n,e,r,a)}else{var o=new G(G.Severity.RECOVERABLE,G.Category.TEXT,G.Code.UNKNOWN_LANGUAGE,{caption:e});t.dispatchEvent(new m(ie.ERROR,o))}})),a}},{key:"_maybeAddTrack",value:function(e,t,n,r){var i=n.find((function(e){return ye.langComparer(t.language,e.language)}));i?a._logger.warn("duplicated language, taking the inband option. Language: ",i.language):(this._player.config.playback.useNativeTextTrack&&this._addNativeTextTrack(e),r.push(e),this._updateTextTracksModel(t))}},{key:"_createTextTrack",value:function(e,t){return new Be({active:!!e.default,index:t,kind:"subtitles",label:e.label,language:e.language,external:!0})}},{key:"_updateTextTracksModel",value:function(e){this._textTrackModel[e.language]={cuesStatus:mr,cues:[],url:e.url,type:e.type}}},{key:"selectTextTrack",value:function(e){var t=this;this._textTrackModel[e.language]&&(this._textTrackModel[e.language].cuesStatus!==Tr||this._player.config.playback.useNativeTextTrack?this._textTrackModel[e.language].cuesStatus===mr&&(e.active=!0,this._player.config.playback.useNativeTextTrack||this.dispatchEvent(new m(ae.TEXT_TRACK_CHANGED,{selectedTextTrack:e})),this._downloadAndParseCues(e).then((function(){t._textTrackModel[e.language].cuesStatus=Tr,t._player.config.playback.useNativeTextTrack?t._addCuesToNativeTextTrack(e,t._textTrackModel[e.language].cues):(t.hideTextTrack(),t._setTextTrack(e))})).catch((function(e){return t.dispatchEvent(new m(ie.ERROR,e))}))):(e.active=!0,this.dispatchEvent(new m(ae.TEXT_TRACK_CHANGED,{selectedTextTrack:e})),this.hideTextTrack(),this._setTextTrack(e)))}},{key:"resetAllCues",value:function(){for(var e in this._textTrackModel)this._textTrackModel[e].cues.forEach((function(e){e.hasBeenReset=!0}))}},{key:"reset",value:function(){this._resetCurrentTrack(),this._textTrackModel={},this._eventManager.removeAll()}},{key:"destroy",value:function(){this._textTrackModel={},this._eventManager.destroy(),this._activeTextCues=[]}},{key:"_resetCurrentTrack",value:function(){this._activeTextCues=[],this._isTextTrackActive=!1,this._maybeSetExternalCueIndex()}},{key:"_getCuesString",value:function(e){var t=this;return new Promise((function(n,r){var i=t._textTrackModel[e.language],a=i.type||t._getFileType(i.url);[kr,Sr].includes(a)||(t._textTrackModel[e.language].cuesStatus=mr,r(new G(G.Severity.RECOVERABLE,G.Category.TEXT,G.Code.UNKNOWN_FILE_TYPE,{captionType:a}))),J.execute(i.url,{},"GET").then((function(e){n(a===kr?t._convertSrtToVtt(e):e)})).catch((function(){t._textTrackModel[e.language].cuesStatus=mr,r(new G(G.Severity.RECOVERABLE,G.Category.TEXT,G.Code.HTTP_ERROR,{url:i.url}))}))}))}},{key:"_parseCues",value:function(e){return new Promise((function(t,n){var r=new vt(window,{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}),i=[];r.oncue=function(e){return i.push(e)},r.onflush=function(){a._logger.debug("finished parsing external cues"),t(i)},r.parse(e),r.flush(),r.onparsingerror((function(e){return n(e)}))}))}},{key:"_convertSrtToVtt",value:function(e){var t=e.replace(/(\d\d:\d\d:\d\d),(\d\d\d) --> (\d\d:\d\d:\d\d),(\d\d\d)/g,(function(e,t,n,r,i){return"".concat(t,".").concat(n," --\x3e ").concat(r,".").concat(i)}));return"WEBVTT\n\n".concat(t)}},{key:"_downloadAndParseCues",value:function(e){var t=this;return this._textTrackModel[e.language].cuesStatus=br,new Promise((function(n,r){t._getCuesString(e).then((function(e){return t._parseCues(e)})).then((function(r){t._textTrackModel[e.language].cues=r,n()})).catch((function(e){return r(e)}))}))}},{key:"_getFileType",value:function(e){return e.split(/[#?]/)[0].split(".").pop().trim()}},{key:"_handleCaptionOnTimeUpdate",value:function(e){var t=this._player.currentTime;if(t){var n=!1;this._hadSeeked()&&(this._activeTextCues=[],n=this._maybeSetExternalCueIndex());var r=this._maybeRemoveActiveCues(),i=this._maybeAddToActiveCues(e);(n||i||r)&&this.dispatchEvent(new m(ae.TEXT_CUE_CHANGED,{cues:this._activeTextCues})),this._lastTimeUpdate=t}}},{key:"_hadSeeked",value:function(){return!!this._player.currentTime&&Math.abs(this._player.currentTime-this._lastTimeUpdate)>1}},{key:"_maybeRemoveActiveCues",value:function(){var e=this._player.currentTime;if(!e)return!1;for(var t=!1,n=0;n<this._activeTextCues.length;n++){var r=this._activeTextCues[n];(e<r.startTime||r.endTime<e)&&(this._activeTextCues.splice(n,1),t=!0)}return t}},{key:"_maybeAddToActiveCues",value:function(e){var t=this._player.currentTime;if(!t)return!1;for(var n=!1,r=this._textTrackModel[e.language].cues;this._externalCueIndex<r.length&&t>r[this._externalCueIndex].startTime;)this._activeTextCues.push(r[this._externalCueIndex]),this._externalCueIndex++,n=!0;return n}},{key:"_maybeSetExternalCueIndex",value:function(){var e=this._player._getTextTracks().find((function(e){return e.active&&e.external}));if(e&&e.external){for(var t=this._textTrackModel[e.language]?this._textTrackModel[e.language].cues:[],n=0;n<t.length&&!(t[n].startTime<this._player.currentTime&&this._player.currentTime<t[n].endTime)&&!(t[n].endTime>this._player.currentTime&&t[n].startTime>this._player.currentTime);n++);return this._externalCueIndex=n,!0}return!1}},{key:"_addCuesToNativeTextTrack",value:function(e,t){var n=this._player.getVideoElement();if(n){var r=Array.from(n.textTracks).find((function(t){return!!t&&t.language===e.language}));r&&t.forEach((function(e){return r.addCue(e)}))}}},{key:"_addNativeTextTrack",value:function(e){var t=this._player.getVideoElement();if(t){var n=Array.from(t.textTracks).findIndex((function(t){return!!t&&t.language===e.language}));if(n>-1){var r=t.textTracks[n];r.cues&&Object.values(r.cues).forEach((function(e){return r.removeCue(e)}))}else t.addTextTrack("subtitles",e.label||e.language,e.language)}}},{key:"_setTextTrack",value:function(e){var t=this;this._player.config.playback.useNativeTextTrack||(this._isTextTrackActive=!0,a._logger.debug("External text track changed",e),this._activeTextCues=[],this.dispatchEvent(new m(ae.TEXT_CUE_CHANGED,{cues:this._activeTextCues})),this._eventManager.listen(this._player,ie.TIME_UPDATE,(function(){return t._handleCaptionOnTimeUpdate(e)})))}}])&&Ar(t.prototype,n),r&&Ar(t,r),a}(T);Er(wr,"_logger",F("ExternalCaptionsHandler"));var Rr={PRE:"preroll",MID:"midroll",POST:"postroll",OVERLAY:"overlay"},Cr={VAST:"vast",VMAP:"vmap"};function Or(e){return(Or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ir(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pr(e,t,n){return t&&Ir(e.prototype,t),n&&Ir(e,n),e}function Nr(e,t){return(Nr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Mr(e);if(t){var i=Mr(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return xr(this,n)}}function xr(e,t){return!t||"object"!==Or(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Mr(e){return(Mr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ur=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Nr(e,t)}(n,e);var t=Lr(n);function n(){return Dr(this,n),t.call(this)}return Pr(n,[{key:"destroy",value:function(){this._observer&&this._observer.disconnect(),this._observer=null,this._el=null}},{key:"init",value:function(e){this._observer||(this._el=e,window.ResizeObserver?this._createNativeObserver():this._createIframeObserver(),this._el instanceof HTMLElement&&this._observer&&this._observer.observe(this._el))}},{key:"_createNativeObserver",value:function(){var e=this;this._observer=new window.ResizeObserver((function(t){t.forEach((function(){e._triggerResize()}))}))}},{key:"_createIframeObserver",value:function(){this._observer=new Fr(this._triggerResize.bind(this))}},{key:"_triggerResize",value:function(){this.dispatchEvent(new m(ae.RESIZE))}}]),n}(T),Fr=function(){function e(t){Dr(this,e),function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"_observersStore",{}),this._onChangeCallback=t}return Pr(e,[{key:"observe",value:function(e){var t=this,n=this._createIframe(),r=e.getAttribute("id");this._observersStore[r]=n,e.appendChild(n),n.contentWindow.onresize=function(){return t._onChangeCallback()}}},{key:"disconnect",value:function(){for(var e in this._observersStore){var t=document.getElementById(e),n=this._observersStore[e];n.onresize=null,t&&(t.removeChild(n),delete this._observersStore[t.getAttribute("id")])}}},{key:"_createIframe",value:function(){var e=document.createElement("iframe");return e.className="playkit-size-iframe",e}}]),e}();function jr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Br=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._player=t,this._isInBrowserFullscreen=!1,this._eventManager=new I,this.registerFullScreenEvents()}var t,n,r;return t=e,(n=[{key:"_isNativeFullscreen",value:function(){var e="function"==typeof this._player.getVideoElement?this._player.getVideoElement():null;return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||"iOS"===this._player.env.os.name&&e&&e.webkitDisplayingFullscreen)}},{key:"isFullscreen",value:function(){return this._isNativeFullscreen()||this._isInBrowserFullscreen}},{key:"enterFullscreen",value:function(e){if(!this.isFullscreen()){var t=e&&$.getElementById(e),n=this._player.config.playback;if(t||(t=this._player.getView()),"iOS"===this._player.env.os.name)if(n.inBrowserFullscreen&&n.playsinline)this._enterInBrowserFullscreen(t);else{var r=this._player.getVideoElement();r&&"function"==typeof r.webkitEnterFullScreen&&r.webkitEnterFullScreen()}else this._requestFullscreen(t)}}},{key:"exitFullscreen",value:function(){if(this.isFullscreen())if("iOS"===this._player.env.os.name)if(this._isInBrowserFullscreen)this._exitInBrowserFullscreen();else{var e=this._player.getVideoElement();e&&"function"==typeof e.webkitExitFullscreen&&e.webkitExitFullscreen()}else this._requestExitFullscreen()}},{key:"_requestFullscreen",value:function(e){this._player.isInPictureInPicture()&&this._player.exitPictureInPicture(),"function"==typeof e.requestFullscreen?e.requestFullscreen():"function"==typeof e.mozRequestFullScreen?e.mozRequestFullScreen():"function"==typeof e.webkitRequestFullScreen?e.webkitRequestFullScreen():"function"==typeof e.msRequestFullscreen&&e.msRequestFullscreen()}},{key:"_requestExitFullscreen",value:function(){"function"==typeof document.exitFullscreen?document.exitFullscreen():"function"==typeof document.webkitExitFullscreen?document.webkitExitFullscreen():"function"==typeof document.mozCancelFullScreen?document.mozCancelFullScreen():"function"==typeof document.msExitFullscreen&&document.msExitFullscreen()}},{key:"_enterInBrowserFullscreen",value:function(e){$.addClassName(e,"playkit-in-browser-fullscreen-mode"),this._isInBrowserFullscreen=!0,this._fullscreenEnterHandler(),this._player.dispatchEvent(new m(this._player.Event.RESIZE))}},{key:"_exitInBrowserFullscreen",value:function(){var e=$.getElementBySelector(".playkit-in-browser-fullscreen-mode");e&&$.removeClassName(e,"playkit-in-browser-fullscreen-mode"),this._isInBrowserFullscreen=!1,this._fullscreenExitHandler(),this._player.dispatchEvent(new m(this._player.Event.RESIZE))}},{key:"registerFullScreenEvents",value:function(){var e=this;this._eventManager.listen(document,"webkitfullscreenchange",(function(){return e._fullscreenChangeHandler()})),this._eventManager.listen(document,"mozfullscreenchange",(function(){return e._fullscreenChangeHandler()})),this._eventManager.listen(document,"fullscreenchange",(function(){return e._fullscreenChangeHandler()})),this._eventManager.listen(document,"MSFullscreenChange",(function(){return e._fullscreenChangeHandler()})),this._handleIosFullscreen()}},{key:"_handleIosFullscreen",value:function(){var e=this;if("iOS"===this._player.env.os.name){var t=function(){var t=e._player.getVideoElement();t&&(e._eventManager.listen(t,"webkitbeginfullscreen",(function(){return e._fullscreenEnterHandler()})),e._eventManager.listen(t,"webkitendfullscreen",(function(){return e._fullscreenExitHandler()})))};this._player.getVideoElement()?t():this._eventManager.listenOnce(this._player,this._player.Event.SOURCE_SELECTED,(function(){return t()}))}}},{key:"_fullscreenChangeHandler",value:function(){this.isFullscreen()?this._fullscreenEnterHandler():this._fullscreenExitHandler()}},{key:"_fullscreenEnterHandler",value:function(){this.isFullscreen()&&this._player.dispatchEvent(new m(this._player.Event.ENTER_FULLSCREEN))}},{key:"_fullscreenExitHandler",value:function(){this.isFullscreen()||this._player.dispatchEvent(new m(this._player.Event.EXIT_FULLSCREEN))}},{key:"destroy",value:function(){this._eventManager.destroy()}}])&&jr(t.prototype,n),r&&jr(t,r),e}();function Vr(e){return(Vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hr(e,t,n){return t&&Gr(e.prototype,t),n&&Gr(e,n),e}function Yr(e,t){return(Yr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qr(e);if(t){var i=qr(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Kr(this,n)}}function Kr(e,t){return!t||"object"!==Vr(t)&&"function"!=typeof t?zr(e):t}function zr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xr(e,t,n){return(Xr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=qr(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function qr(e){return(qr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Qr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yr(e,t)}(n,e);var t=Wr(n);function n(e){var r,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(i=t.call(this))._eventManager=new I,i._pluginDecorators=n._decoratorProviders.map((function(t){return t.getEngineDecorator(e,Xr((r=zr(i),qr(n.prototype)),"dispatchEvent",r).bind(zr(i)))})),Object.values(oe).forEach((function(t){return i._eventManager.listen(e,t,(function(e){return i.dispatchEvent(e)}))})),Kr(i,new Proxy(e,{get:function(e,t){if("destroy"===t&&i._destroy(),"_listeners"===t)return i._listeners;var n=i._pluginDecorators.find((function(e){return t in e&&e.active}));return n?n[t]:e[t]},set:function(e,t,n){var r=i._pluginDecorators.find((function(e){return t in e&&e.active}));return r?r[t]=n:e[t]=n,!0}}))}return Hr(n,null,[{key:"register",value:function(e){e&&(n._decoratorProviders.includes(e)||n._decoratorProviders.push(e))}},{key:"getDecorator",value:function(e){return n._decoratorProviders.length?new this(e):null}}]),Hr(n,[{key:"dispatchEvent",value:function(e){var t=this._pluginDecorators.find((function(e){return e.active}));return t?t.dispatchEvent&&t.dispatchEvent(e):Xr(qr(n.prototype),"dispatchEvent",this).call(this,e)}},{key:"_destroy",value:function(){this._pluginDecorators=[],this._eventManager.destroy()}},{key:"active",get:function(){return!0}}]),n}(T);!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Qr,"_decoratorProviders",[]);var Zr=Qr.register,$r="audio",Jr="captions",ei="qualities";function ti(e){return(ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ni(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ri(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ri(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function ri(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ii(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ai(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oi(e,t,n){return t&&ai(e.prototype,t),n&&ai(e,n),e}function si(e,t){return(si=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ui(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=fi(e);if(t){var i=fi(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ci(this,n)}}function ci(e,t){return!t||"object"!==ti(t)&&"function"!=typeof t?li(e):t}function li(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fi(e){return(fi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function di(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var hi="off",Ai=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&si(e,t)}(n,e);var t=ui(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ii(this,n),di(li(e=t.call(this)),"_activeTextCues",[]),di(li(e),"_textDisplaySettings",{}),di(li(e),"_playbackAttributesState",{muted:void 0,volume:void 0,rate:void 0,audioLanguage:"",textLanguage:""}),di(li(e),"_hasUserInteracted",!1),di(li(e),"_isOnLiveEdge",!1),di(li(e),"_shouldLoadAfterAttach",!1),e._setConfigLogLevel(r),e._playerId=Z.uniqueId(5),e._prepareVideoElement(),n.runCapabilities(),e._env=_,e._tracks=[],e._firstPlay=!0,e._repositionCuesTimeout=!1,e._loadingMedia=!1,e._loading=!1,e._playbackStart=!1,e._playbackEnded=!1,e._firstPlaying=!1,e._reset=!0,e._destroyed=!1,e._fallbackToMutedAutoPlay=!1,e._config=n._defaultConfig,e._eventManager=new I,e._posterManager=new ne,e._stateManager=new Ae(li(e)),e._resizeWatcher=new Ur,e._playbackMiddleware=new Ht,e._textStyle=new Ye,e._createReadyPromise(),e._createPlayerContainer(),e._appendDomElements(),e._externalCaptionsHandler=new wr(li(e)),e._fullscreenController=new Br(li(e)),e.configure(r),e}return oi(n,null,[{key:"runCapabilities",value:function(){n._logger.debug("Running player capabilities"),lr.getEngines().forEach((function(e){return e.runCapabilities()}))}},{key:"getCapabilities",value:function(e){n._logger.debug("Get player capabilities",e);var t=[];return lr.getEngines().forEach((function(e){return t.push(e.getCapabilities())})),Promise.all(t).then((function(t){var n={};return t.forEach((function(e){return Object.assign(n,e)})),e?n[e]:n}))}},{key:"setCapabilities",value:function(e,t){n._logger.debug("Set player capabilities",e,t);var r=lr.getEngines().find((function(t){return t.id===e}));r&&r.setCapabilities(t)}}]),oi(n,[{key:"configure",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setConfigLogLevel(e),this._hasSources(e.sources)?(this.reset(),this._resizeWatcher.init($.getElementById(this._playerId)),n._logger.debug("Change source started"),this.dispatchEvent(new m(ae.CHANGE_SOURCE_STARTED)),Q.mergeDeep(this._config,e),this._reset=!1,this._selectEngineByPriority()?(this.dispatchEvent(new m(ae.SOURCE_SELECTED,{selectedSource:this._config.sources[this._streamType]})),this._attachMedia(),this._handlePlaybackOptions(),this._posterManager.setSrc(this._config.sources.poster),this._handlePreload(),this._handleAutoPlay(),n._logger.debug("Change source ended"),this.dispatchEvent(new m(ae.CHANGE_SOURCE_ENDED))):(n._logger.warn("No playable engines was found to play the given sources"),this.dispatchEvent(new m(ie.ERROR,new G(G.Severity.CRITICAL,G.Category.PLAYER,G.Code.NO_ENGINE_FOUND_TO_PLAY_THE_SOURCE,"No Engine Found To Play The Source"))))):Q.mergeDeep(this._config,e)}},{key:"ready",value:function(){return this._readyPromise?this._readyPromise:Promise.resolve()}},{key:"load",value:function(){var e=this;this.src?n._logger.debug("The source has already been loaded. load request ignored"):this._playbackMiddleware.load((function(){e._engine?e._load():e._eventManager.listenOnce(e,ae.SOURCE_SELECTED,(function(){return e._load()}))}))}},{key:"play",value:function(){var e=this;this._playbackStart||(this._playbackStart=!0,this.dispatchEvent(new m(ae.PLAYBACK_START)),this.src||this._prepareVideoElement(),this.load()),this._engine?this._playbackMiddleware.play((function(){return e._play()})):this._loadingMedia?this._playbackMiddleware.play((function(){return e._playAfterAsyncMiddleware()})):this.dispatchEvent(new m(ie.ERROR,new G(G.Severity.CRITICAL,G.Category.PLAYER,G.Code.NO_SOURCE_PROVIDED,"No Source Provided")))}},{key:"pause",value:function(){this._engine&&this._playbackMiddleware.pause(this._pause.bind(this))}},{key:"getView",value:function(){return this._el}},{key:"getVideoElement",value:function(){if(this._engine)return this._engine.getVideoElement()}},{key:"reset",value:function(){this._reset||(this.pause(),this._externalCaptionsHandler.reset(),this._posterManager.reset(),this._stateManager.reset(),this._config.sources={},this._activeTextCues=[],this._updateTextDisplay([]),this._tracks=[],this._resetStateFlags(),this._engineType="",this._streamType="",this._pendingSelectedVideoTrack=null,this._engine&&this._engine.reset(),this.showBlackCover(),this._reset=!0,this.dispatchEvent(new m(ae.PLAYER_RESET)),this._eventManager.removeAll(),this._resizeWatcher.init($.getElementById(this._playerId)),this._createReadyPromise(),this._isOnLiveEdge=!1,this._shouldLoadAfterAttach=!1)}},{key:"destroy",value:function(){this._destroyed||(this._externalCaptionsHandler.destroy(),this._posterManager.destroy(),this._stateManager.destroy(),this._fullscreenController.destroy(),this._clearRepositionTimeout(),this._activeTextCues=[],this._textDisplaySettings={},this._config={},this._tracks=[],this._engineType="",this._streamType="",this._readyPromise=null,this._pendingSelectedVideoTrack=null,this._resetStateFlags(),this._playbackAttributesState={},this._engine&&this._engine.destroy(),this._resizeWatcher.destroy(),this._el&&$.removeChild(this._el.parentNode,this._el),this._destroyed=!0,this.dispatchEvent(new m(ae.PLAYER_DESTROY)),this._eventManager.destroy())}},{key:"hideBlackCover",value:function(){this._blackCoverEl&&(this._blackCoverEl.style.visibility="hidden")}},{key:"showBlackCover",value:function(){this._blackCoverEl&&(this._blackCoverEl.style.visibility="visible")}},{key:"attachMediaSource",value:function(){var e=this;this._engine&&(this._shouldLoadAfterAttach=!0,this._engine.attachMediaSource(),this._eventManager.listenOnce(this,ie.CAN_PLAY,(function(){"number"==typeof e._playbackAttributesState.rate&&(e.playbackRate=e._playbackAttributesState.rate)})))}},{key:"detachMediaSource",value:function(){this._engine&&(this.pause(),this.hideTextTrack(),this._shouldLoadAfterAttach=!1,this._createReadyPromise(),this._engine.detachMediaSource())}},{key:"isLive",value:function(){return!(this._config.sources.type===Pt.VOD||!(this._config.sources.type===Pt.LIVE||this._engine&&this._engine.isLive()))}},{key:"isOnLiveEdge",value:function(){return this._isOnLiveEdge}},{key:"isDvr",value:function(){return this.isLive()&&this._config.sources.dvr}},{key:"seekToLiveEdge",value:function(){this._engine&&this.isLive()&&(this._engine.seekToLiveEdge(),this._isOnLiveEdge=!0)}},{key:"getStartTimeOfDvrWindow",value:function(){return this._engine?this._engine.getStartTimeOfDvrWindow():0}},{key:"getTracks",value:function(e){switch(e){case Ot.VIDEO:return Q.copyDeep(this._getVideoTracks());case Ot.AUDIO:return Q.copyDeep(this._getAudioTracks());case Ot.TEXT:return Q.copyDeep(this._getTextTracks());default:return Q.copyDeep(this._tracks)}}},{key:"getActiveTracks",value:function(){return Q.copyDeep({video:this._getVideoTracks().find((function(e){return e.active})),audio:this._getAudioTracks().find((function(e){return e.active})),text:this._getTextTracks().find((function(e){return e.active}))})}},{key:"selectTrack",value:function(e){this._engine&&(e instanceof Se?this._playbackEnded?this._pendingSelectedVideoTrack=e:this._engine.selectVideoTrack(e):e instanceof Pe?this._engine.selectAudioTrack(e):e instanceof Be&&(this._resetTextDisplay(),e.language===hi?(this.hideTextTrack(),this._externalCaptionsHandler.hideTextTrack(),this._playbackAttributesState.textLanguage=hi):e.external&&!this._config.playback.useNativeTextTrack?(this._engine.hideTextTrack(),this._externalCaptionsHandler.selectTextTrack(e)):(this._externalCaptionsHandler.hideTextTrack(),this._engine.selectTextTrack(e))))}},{key:"hideTextTrack",value:function(){if(this._engine){this._engine.hideTextTrack(),this._resetTextDisplay();var e=this._getTextTracks();e.map((function(e){return e.active=!1}));var t=e.find((function(e){return e.language===hi}));t&&(t.active=!0,this.dispatchEvent(new m(ae.TEXT_TRACK_CHANGED,{selectedTextTrack:t})))}}},{key:"enableAdaptiveBitrate",value:function(){this._engine&&this._engine.enableAdaptiveBitrate()}},{key:"isAdaptiveBitrateEnabled",value:function(){return!!this._engine&&this._engine.isAdaptiveBitrateEnabled()}},{key:"setTextDisplaySettings",value:function(e){this._textDisplaySettings=e,this._updateCueDisplaySettings();for(var t=0;t<this._activeTextCues.length;t++)this._activeTextCues[t].hasBeenReset=!0;this._updateTextDisplay(this._activeTextCues)}},{key:"isFullscreen",value:function(){return this._fullscreenController.isFullscreen()}},{key:"notifyEnterFullscreen",value:function(){this.isFullscreen()&&this.dispatchEvent(new m(ae.ENTER_FULLSCREEN))}},{key:"notifyExitFullscreen",value:function(){this.isFullscreen()||this.dispatchEvent(new m(ae.EXIT_FULLSCREEN))}},{key:"enterFullscreen",value:function(e){this._fullscreenController.enterFullscreen(e)}},{key:"exitFullscreen",value:function(){this._fullscreenController.exitFullscreen()}},{key:"enterPictureInPicture",value:function(){this.isFullscreen()&&this.exitFullscreen(),this._engine.isInPictureInPicture||this._engine.enterPictureInPicture()}},{key:"exitPictureInPicture",value:function(){this._engine.isInPictureInPicture&&this._engine.exitPictureInPicture()}},{key:"isInPictureInPicture",value:function(){return this._engine.isInPictureInPicture}},{key:"isPictureInPictureSupported",value:function(){return!!this._config.playback.pictureInPicture&&this._engine.isPictureInPictureSupported()}},{key:"isVr",value:function(){return!!this._config.sources.vr}},{key:"getLogLevel",value:function(e){return M(e)}},{key:"setLogLevel",value:function(e,t){U(e,t)}},{key:"_resetTextDisplay",value:function(){this._activeTextCues=[],this._updateTextDisplay([])}},{key:"_prepareVideoElement",value:function(){var e=this;lr.getEngines().forEach((function(t){t.prepareVideoElement(e._playerId)}))}},{key:"_setConfigLogLevel",value:function(e){var t;e.log&&e.log.level&&N[e.log.level]&&U(N[e.log.level]),e.log&&"function"==typeof e.log.handler&&(t=e.log.handler,P.setHandler((function(e,n){return t(e,n)})))}},{key:"_hasSources",value:function(e){return!!e&&!!Object.values(Dt).find((function(t){return e[t]&&e[t].length>0}))}},{key:"_createPlayerContainer",value:function(){var e=this._el=$.createElement("div");$.addClassName(e,"playkit-container"),$.setAttribute(e,"id",this._playerId),$.setAttribute(e,"tabindex","-1")}},{key:"_appendEngineEl",value:function(){if(this._el){var e=this._engine.getVideoElement(),t="".concat("playkit-engine");$.addClassName(e,t);var n="".concat("playkit-engine","-").concat(this._engine.id);$.addClassName(e,n),$.prependTo(e,this._el)}}},{key:"_appendDomElements",value:function(){this._textDisplayEl=$.createElement("div"),$.setAttribute(this._textDisplayEl,"aria-live","polite"),$.addClassName(this._textDisplayEl,"playkit-subtitles"),$.appendChild(this._el,this._textDisplayEl),this._blackCoverEl=$.createElement("div"),$.addClassName(this._blackCoverEl,"playkit-black-cover"),$.appendChild(this._el,this._blackCoverEl);var e=this._posterManager.getElement();$.addClassName(e,"playkit-poster"),$.appendChild(this._el,e)}},{key:"_createReadyPromise",value:function(){var e=this;this._readyPromise=new Promise((function(t,n){e._eventManager.listenOnce(e,ae.TRACKS_CHANGED,(function(){e.dispatchEvent(new m(ae.MEDIA_LOADED)),t()})),e._eventManager.listen(e,ie.ERROR,(function(e){e.payload.severity===G.Severity.CRITICAL&&n()}))})).catch((function(){}))}},{key:"_selectEngineByPriority",value:function(){var e,t=this,r=this._config.playback.streamPriority,i=this._config.playback.preferNative,a=this._config.sources,o=ni(r);try{var s=function(){var r=e.value,o="string"==typeof r.engine?r.engine.toLowerCase():"",s="string"==typeof r.format?r.format.toLowerCase():"",u=lr.getEngines().find((function(e){return e.id===o}));if(u){var c=a[s];if(c&&c.length>0){var l=c[0];if(u.canPlaySource(l,i[s],t._config.drm))return n._logger.debug("Source selected: ",c),t._loadEngine(u,l),t._engineType=o,t._streamType=s,{v:!0}}}};for(o.s();!(e=o.n()).done;){var u=s();if("object"===ti(u))return u.v}}catch(e){o.e(e)}finally{o.f()}return!1}},{key:"_loadEngine",value:function(e,t){this._engine?this._engine.id===e.id?this._engine.restore.call(this._engine._engine||this._engine,t,this._config):(this._engine.destroy(),this._createEngine(e,t),this._appendEngineEl()):(this._createEngine(e,t),this._appendEngineEl())}},{key:"_createEngine",value:function(e,t){var n=e.createEngine(t,this._config,this._playerId);this._engine=Qr.getDecorator(n)||n}},{key:"_attachMedia",value:function(){var e=this;if(this._engine){Object.keys(ie).forEach((function(t){e._eventManager.listen(e._engine,ie[t],(function(t){return e.dispatchEvent(t)}))})),this._eventManager.listen(this._engine,ie.SEEKING,(function(){e.isLive()&&(e._isOnLiveEdge=!(!e.duration||!e.currentTime)&&(e.currentTime>=e.duration-1&&!e.paused))})),this._eventManager.listen(this._engine,ie.SEEKED,(function(){var t=e._env.browser.name;"Edge"!==t&&"IE"!==t||e._removeTextCuePatch()})),this._eventManager.listen(this._engine,ae.VIDEO_TRACK_CHANGED,(function(t){return e._markActiveTrack(t.payload.selectedVideoTrack),e.dispatchEvent(t)})),this._eventManager.listen(this._engine,ae.AUDIO_TRACK_CHANGED,(function(t){e.ready().then((function(){return e._playbackAttributesState.audioLanguage=t.payload.selectedAudioTrack.language})),e._markActiveTrack(t.payload.selectedAudioTrack),e.dispatchEvent(t)})),this._eventManager.listen(this._engine,ae.TEXT_TRACK_CHANGED,(function(t){return e._onTextTrackChanged(t)})),this._eventManager.listen(this._engine,ae.TRACKS_CHANGED,(function(t){return e._onTracksChanged(t)})),this._eventManager.listen(this._engine,ae.TEXT_CUE_CHANGED,(function(t){return e._onCueChange(t)})),this._eventManager.listen(this._engine,ae.ABR_MODE_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,ae.TIMED_METADATA,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,ae.PLAY_FAILED,(function(t){e.pause(),e._onPlayFailed(t),e.dispatchEvent(t)})),this._eventManager.listen(this._engine,ae.FPS_DROP,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,ae.FRAG_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,ae.DRM_LICENSE_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,ae.MANIFEST_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this,ie.PLAY,this._onPlay.bind(this)),this._eventManager.listen(this,ie.PAUSE,this._onPause.bind(this)),this._eventManager.listen(this,ie.PLAYING,this._onPlaying.bind(this)),this._eventManager.listen(this,ie.ENDED,this._onEnded.bind(this)),this._eventManager.listen(this,ae.PLAYBACK_ENDED,this._onPlaybackEnded.bind(this)),this._eventManager.listen(this,ae.MUTE_CHANGE,(function(){e._playbackAttributesState.muted=e.muted})),this._eventManager.listen(this,ie.VOLUME_CHANGE,(function(){e._playbackAttributesState.volume=e.volume})),this._eventManager.listen(this,ie.RATE_CHANGE,(function(){e._playbackAttributesState.rate=e.playbackRate})),this._eventManager.listen(this,ae.ENTER_FULLSCREEN,(function(){return e._resetTextCuesAndReposition()})),this._eventManager.listen(this,ae.EXIT_FULLSCREEN,(function(){return e._resetTextCuesAndReposition()})),this._eventManager.listen(this._resizeWatcher,ae.RESIZE,(function(t){e._resetTextCuesAndReposition(),e.dispatchEvent(t)})),this._eventManager.listen(this._engine,ae.MEDIA_RECOVERED,(function(){return e._handleRecovered()})),this._eventManager.listen(this._externalCaptionsHandler,ae.TEXT_CUE_CHANGED,(function(t){return e._onCueChange(t)})),this._eventManager.listen(this._externalCaptionsHandler,ae.TEXT_TRACK_CHANGED,(function(t){return e._onTextTrackChanged(t)})),this._eventManager.listen(this._externalCaptionsHandler,ie.ERROR,(function(t){return e.dispatchEvent(t)}));var t=$.getElementBySelector("#".concat(this.config.targetId));t&&this._eventManager.listen(t,"click",(function(){e._hasUserInteracted=!0,e.dispatchEvent(new m(ae.USER_GESTURE))}),{capture:!0})}}},{key:"_handleRecovered",value:function(){this._stateManager.currentState.type===fe.PLAYING&&this.play()}},{key:"_onTextTrackChanged",value:function(e){var t=this;this.ready().then((function(){return t._playbackAttributesState.textLanguage=e.payload.selectedTextTrack.language})),this._markActiveTrack(e.payload.selectedTextTrack),this._config.playback.useNativeTextTrack&&this._externalCaptionsHandler.selectTextTrack(e.payload.selectedTextTrack),this.dispatchEvent(e)}},{key:"_resetTextCuesAndReposition",value:function(){var e=this;this._engine.resetAllCues(),this._updateTextDisplay([]);for(var t=0;t<this._activeTextCues.length;t++)this._activeTextCues[t].hasBeenReset=!0;this._clearRepositionTimeout(),this._repositionCuesTimeout=setTimeout((function(){e._updateTextDisplay(e._activeTextCues),e._repositionCuesTimeout=!1}),1e3)}},{key:"_clearRepositionTimeout",value:function(){this._repositionCuesTimeout&&clearTimeout(this._repositionCuesTimeout)}},{key:"_removeTextCuePatch",value:function(){var e=this,t=this._activeTextCues.filter((function(t){var n=t._endTime,r=t._startTime,i=e.currentTime;if(i<n&&i>r)return t}));this._updateTextDisplay(t)}},{key:"_handlePlaybackOptions",value:function(){if(this._config.playback=this._config.playback||{},"boolean"==typeof this._playbackAttributesState.muted?this.muted=this._playbackAttributesState.muted:"boolean"==typeof this._config.playback.muted&&(this.muted=this._config.playback.muted),"number"==typeof this._playbackAttributesState.volume?this.volume=this._playbackAttributesState.volume:"number"==typeof this._config.playback.volume&&(this.volume=this._config.playback.volume),"boolean"==typeof this._config.playback.playsinline&&(this.playsinline=this._config.playback.playsinline),"string"==typeof this._config.playback.crossOrigin&&(this.crossOrigin=this._config.playback.crossOrigin),Array.isArray(this._config.playback.playbackRates)){var e=this._config.playback.playbackRates.filter((function(e,t,n){return e>0&&e<=16&&n.indexOf(e)===t})).sort((function(e,t){return e-t}));e&&(this._playbackRates=e)}}},{key:"_handlePreload",value:function(){"auto"!==this._config.playback.preload||this._config.playback.autoplay||this.load()}},{key:"_handleAutoPlay",value:function(){var e=this;if(!0===this._config.playback.autoplay){var t=this._config.playback.allowMutedAutoPlay;n.getCapabilities(this.engineType).then((function(n){n.autoplay?r():n.mutedAutoPlay?e.muted&&!e._fallbackToMutedAutoPlay?i():t?a():o():o()}))}else this._posterManager.show();var r=function(){n._logger.debug("Start autoplay"),e._fallbackToMutedAutoPlay&&(e._fallbackToMutedAutoPlay=!1,e.muted=!1),e.play()},i=function(){n._logger.debug("Start muted autoplay"),e.play()},a=function(){n._logger.debug("Fallback to muted autoplay"),e._fallbackToMutedAutoPlay=!0,e.muted=!0,e.dispatchEvent(new m(ae.FALLBACK_TO_MUTED_AUTOPLAY)),e.play()},o=function(){n._logger.warn("Autoplay failed, pause player"),e._posterManager.show(),e.load(),e.ready().then((function(){return e.pause()})),e.dispatchEvent(new m(ae.AUTOPLAY_FAILED))}}},{key:"_playAfterAsyncMiddleware",value:function(){var e=this;this._engine?this._play():this._eventManager.listenOnce(this,ae.SOURCE_SELECTED,(function(){return e._play()}))}},{key:"_load",value:function(){var e=this,t=function(){e._loading=!1,e._reset=!1};if(this._engine&&!this.src&&!this._loading){this._loading=!0;var n=this._config.playback.startTime;this._engine.load(n).then((function(r){e.isLive()&&(-1===n||n>=e.duration)&&(e._isOnLiveEdge=!0),e._updateTracks(r.tracks),e.dispatchEvent(new m(ae.TRACKS_CHANGED,{tracks:e._tracks})),t()})).catch((function(n){e.dispatchEvent(new m(ie.ERROR,n)),t()}))}}},{key:"_play",value:function(){var e=this;this._shouldLoadAfterAttach&&(this._load(),this._shouldLoadAfterAttach=!1),this.ready().then((function(){e.isLive()&&(!e.isDvr()||"number"==typeof e.currentTime&&e.currentTime<0)&&e.seekToLiveEdge(),e._engine.play()})).catch((function(t){e.dispatchEvent(new m(ie.ERROR,t))}))}},{key:"_pause",value:function(){this._engine.pause()}},{key:"_onPause",value:function(){this._isOnLiveEdge=!1}},{key:"_onPlay",value:function(){this._firstPlay&&(this._firstPlay=!1,this.dispatchEvent(new m(ae.FIRST_PLAY)),this._posterManager.hide(),this.hideBlackCover(),"number"==typeof this._playbackAttributesState.rate&&(this.playbackRate=this._playbackAttributesState.rate))}},{key:"_onPlaying",value:function(){this._firstPlaying||(this._firstPlaying=!0,this.dispatchEvent(new m(ae.FIRST_PLAYING))),this._engine&&this._pendingSelectedVideoTrack&&(this._engine.selectVideoTrack(this._pendingSelectedVideoTrack),this._pendingSelectedVideoTrack=null)}},{key:"_onPlayFailed",value:function(e){this._firstPlay&&this._config.playback.autoplay&&(this._posterManager.show(),this.dispatchEvent(new m(ae.AUTOPLAY_FAILED,e.payload)))}},{key:"_onEnded",value:function(){this.paused||this._pause()}},{key:"_onPlaybackEnded",value:function(){this.config.playback.loop?(this.currentTime=0,this.play()):this._playbackEnded=!0}},{key:"_resetStateFlags",value:function(){this._loading=!1,this._firstPlay=!0,this._loadingMedia=!1,this._playbackStart=!1,this._playbackEnded=!1,this._firstPlaying=!1}},{key:"_onTracksChanged",value:function(e){this._updateTracks(e.payload.tracks),this.dispatchEvent(e)}},{key:"_updateTracks",value:function(e){n._logger.debug("Tracks changed",e),this._tracks=e.concat(this._externalCaptionsHandler.getExternalTracks(e)),this._addTextTrackOffOption(),this._maybeSetTracksLabels(),this._maybeAdjustTextTracksIndexes(),this._setDefaultTracks()}},{key:"_maybeAdjustTextTracksIndexes",value:function(){var e=this;if(this._config.playback.useNativeTextTrack){this._getTextTracks().forEach((function(t){return t.index=(n=t,(r=e.getVideoElement())?Array.from(r.textTracks).findIndex((function(e){return!!e&&e.language===n.language})):-1);var n,r}))}}},{key:"_getTracksByType",value:function(e){return this._tracks.reduce((function(t,n){return n instanceof e&&t.push(n),t}),[])}},{key:"_getTextTracks",value:function(){return this._getTracksByType(Be)}},{key:"_getVideoTracks",value:function(){return this._getTracksByType(Se)}},{key:"_getAudioTracks",value:function(){return this._getTracksByType(Pe)}},{key:"_markActiveTrack",value:function(e){var t;if(e instanceof Se?t=this._getVideoTracks():e instanceof Pe?t=this._getAudioTracks():e instanceof Be&&(t=this._getTextTracks()),t)for(var n=0;n<t.length;n++)t[n].active=e.index===t[n].index}},{key:"_onCueChange",value:function(e){n._logger.debug("Text cue changed",e.payload.cues),this._activeTextCues=e.payload.cues,this._updateCueDisplaySettings(),this._updateTextDisplay(this._activeTextCues)}},{key:"_updateCueDisplaySettings",value:function(){for(var e=this._activeTextCues,t=this._textDisplaySettings,n=0;n<e.length;n++){var r=e[n];for(var i in t)r[i]=t[i]}}},{key:"_updateTextDisplay",value:function(e){this._config.playback.useNativeTextTrack||function(e,t,n,r){if(!e||!t||!n)return null;for(;n.firstChild;)n.removeChild(n.firstChild);var i=e.document.createElement("div");if(i.style.position="absolute",i.style.left="0",i.style.right="0",i.style.top="0",i.style.bottom="0",i.style.margin="1.5%",n.appendChild(i),function(e){for(var t=0;t<e.length;t++)if(e[t].hasBeenReset||!e[t].displayState)return!0;return!1}(t)){var a=[],o=yt.getSimpleBoxPosition(i),s=o.height<o.width?o.height:o.width,u={font:1*(Math.round(.058*s*100)/100)*r.implicitFontScale+"px "+r.fontFamily,color:Ye.toRGBA(r.fontColor,r.fontOpacity),backgroundColor:Ye.toRGBA(r.backgroundColor,r.backgroundOpacity),textShadow:r.getTextShadow()};!function(){for(var n,r,s=0;s<t.length;s++)r=t[s],n=new pt(e,r,u),i.appendChild(n.div),gt(0,n,o,a),r.displayState=n.div,a.push(yt.getSimpleBoxPosition(n))}()}else for(var c=0;c<t.length;c++)i.appendChild(t[c].displayState)}(window,e,this._textDisplayEl,this._textStyle)}},{key:"_addTextTrackOffOption",value:function(){var e=this._getTextTracks();e&&e.length&&this._tracks.push(new Be({active:!1,index:e.length,kind:"subtitles",label:"Off",language:hi}))}},{key:"_setDefaultTracks",value:function(){var e=this.getActiveTracks(),t=this.config.playback,n=this._getTextTracks().find((function(e){return Be.langComparer(hi,e.language)})),r=this._playbackAttributesState.textLanguage||this._getLanguage(t.textLanguage,e.text),i=this._playbackAttributesState.audioLanguage||t.audioLanguage;this._setDefaultTrack(this._getTextTracks(),r,n),this._setDefaultTrack(this._getAudioTracks(),i,e.audio)}},{key:"_getLanguage",value:function(e,t){var n=e;if("auto"===n){var r=this._getTextTracks(),i=r.find((function(e){return ye.langComparer(ue.language,e.language)}));i?n=i.language:t&&t.language!==hi?n=t.language:r&&r.length>0&&(n=r[0].language)}return n}},{key:"_setDefaultTrack",value:function(e,t,n){var r=e.find((function(e){return ye.langComparer(t,e.language)}));r?(this.selectTrack(r),this._markActiveTrack(r)):n&&!n.active&&this.selectTrack(n)}},{key:"_maybeSetTracksLabels",value:function(){var e=this._config.customLabels;if(e)for(var t in e){if(!Object.prototype.hasOwnProperty.call(e,t))return;switch(t){case ei:this._setTracksCustomLabels(this._getVideoTracks(),e[t]);break;case $r:this._setTracksCustomLabels(this._getAudioTracks(),e[t]);break;case Jr:this._setTracksCustomLabels(this._getTextTracks(),e[t])}}}},{key:"_setTracksCustomLabels",value:function(e,t){e.forEach((function(e){var n=t(Q.copyDeep(e));n&&(e.label=n)}))}},{key:"buffered",get:function(){return this._engine?this._engine.buffered:null}},{key:"stats",get:function(){var e={targetBuffer:NaN,availableBuffer:NaN};return this._engine&&(e.targetBuffer=this._engine.targetBuffer,e.availableBuffer=this._engine.availableBuffer),e}},{key:"currentTime",set:function(e){if(this._engine&&X.isNumber(e)){var t=e;e<0&&(t=0);var n=this.isLive()?this._engine.duration:this._engine.duration-.1;t>n&&(t=n),this._engine.currentTime=t}},get:function(){return this._engine?this._engine.currentTime:null}},{key:"duration",get:function(){return this._engine?this._engine.duration:null}},{key:"volume",set:function(e){if(this._engine&&(X.isFloat(e)||0===e||1===e)){var t=e;t<0&&(t=0),t>1&&(t=1),this._engine.volume=t}},get:function(){return this._engine?this._engine.volume:null}},{key:"paused",get:function(){return this._engine?this._engine.paused:null}},{key:"seeking",get:function(){return this._engine?this._engine.seeking:null}},{key:"playsinline",set:function(e){this._engine&&(this._engine.playsinline=e)},get:function(){return this._engine?this._engine.playsinline:null}},{key:"muted",set:function(e){this._engine&&(this._engine.muted=e,this.dispatchEvent(new m(ae.MUTE_CHANGE,{mute:e})),!1===e&&(this._fallbackToMutedAutoPlay=e))},get:function(){return this._engine?this._engine.muted:null}},{key:"src",get:function(){return this._engine?this._engine.src:null}},{key:"dimensions",get:function(){return{width:this._el.clientWidth,height:this._el.clientHeight}}},{key:"poster",get:function(){return this._posterManager.src}},{key:"playbackRate",set:function(e){this._engine&&(this._engine.playbackRate=e)},get:function(){return this._engine?this._engine.playbackRate:null}},{key:"playbackRates",get:function(){return this._playbackRates?this._playbackRates:this._engine?this._engine.playbackRates:[]}},{key:"defaultPlaybackRate",get:function(){return this._engine?this._engine.defaultPlaybackRate:1}},{key:"engineType",get:function(){return this._engineType}},{key:"streamType",get:function(){return this._streamType}},{key:"env",get:function(){return this._env}},{key:"config",get:function(){return Q.mergeDeep({},this._config)}},{key:"hasUserInteracted",get:function(){return this._hasUserInteracted}},{key:"loadingMedia",set:function(e){this._loadingMedia=e}},{key:"crossOrigin",set:function(e){this._engine&&(this._engine.crossOrigin=e)},get:function(){return this._engine?this._engine.crossOrigin:null}},{key:"ended",get:function(){return this._engine?this._engine.ended:null}},{key:"playbackMiddleware",get:function(){return this._playbackMiddleware}},{key:"posterManager",get:function(){return this._posterManager}},{key:"textStyle",set:function(e){if(!(e instanceof Ye))throw new Error("Style must be instance of TextStyle");var t=$.getElementBySelector(".".concat(this._playerId,".").concat("playkit-subtitles-style"));t||(t=$.createElement("style"),$.addClassName(t,this._playerId),$.addClassName(t,"playkit-subtitles-style"),$.appendChild(document.head,t));for(var r=t.sheet;r.cssRules.length;)r.deleteRule(0);try{this._textStyle=e,this._config.playback.useNativeTextTrack?r.insertRule("#".concat(this._playerId," video.").concat("playkit-engine","::cue { ").concat(e.toCSS()," }"),0):this._engine&&(this._engine.resetAllCues(),this._externalCaptionsHandler.resetAllCues(),this._updateTextDisplay(this._activeTextCues)),this.dispatchEvent(new m(ae.TEXT_STYLE_CHANGED))}catch(e){n._logger.error(e.message)}},get:function(){return this._textStyle.clone()}},{key:"Event",get:function(){return oe}},{key:"TextStyle",get:function(){return Ye}},{key:"State",get:function(){return fe}},{key:"Track",get:function(){return Ot}},{key:"LogLevelType",get:function(){return L}},{key:"LogLevel",get:function(){return N}},{key:"AbrMode",get:function(){return Nt}},{key:"MediaType",get:function(){return Pt}},{key:"StreamType",get:function(){return Dt}},{key:"EngineType",get:function(){return It}},{key:"CorsType",get:function(){return Lt}},{key:"AdBreakType",get:function(){return Rr}},{key:"AdTagType",get:function(){return Cr}},{key:"Error",get:function(){return G}}],[{key:"_defaultConfig",get:function(){return Q.copyDeep(Yt)}}]),n}(T);di(Ai,"_logger",F("Player"));var _i={HLS:["application/x-mpegurl","application/vnd.apple.mpegurl"],DASH:["application/dash+xml"],PROGRESSIVE:["video/mp4"],SMOOTH_STREAMING:["application/vnd.ms-sstr+xml"]},pi="0.62.0",yi="@playkit-js/playkit-js";function gi(e){return new Ai(e||{})}var vi=Ai.getCapabilities,Ei=Ai.setCapabilities;t.default=gi}])}));
//# sourceMappingURL=playkit.js.map